<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Taller de Métodos y Técnicas de Investigación I - Sesión 2: Estadística Descriptiva (II) y Prueba de Hipótesis (I)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Taller de Métodos y Técnicas de Investigación I</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Inicio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../syllabus.html"> 
<span class="menu-text">Programa</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../evaluacion.html"> 
<span class="menu-text">Evaluaciones</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../recursos.html"> 
<span class="menu-text">Recursos</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-clases" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Clases</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-clases">    
        <li>
    <a class="dropdown-item" href="../lectures/01-intro.html">
 <span class="dropdown-text">Sesión 1: Intro a R y Estadística Descriptiva I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/02-statistics.html">
 <span class="dropdown-text">Sesión 2: Estadística Descriptiva II e Hipótesis I</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/03-inferential-statistics.html">
 <span class="dropdown-text">Sesión 3: Prueba de Hipótesis II y ANOVA</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/04-corr-regression.html">
 <span class="dropdown-text">Sesión 4: Correlación y Regresión Simple</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../lectures/05-regression.html">
 <span class="dropdown-text">Sesión 5: Regresión Lineal Múltiple</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/fransofia/metodos-mgsocio-uah"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objetivos-de-la-sesión" id="toc-objetivos-de-la-sesión" class="nav-link active" data-scroll-target="#objetivos-de-la-sesión">Objetivos de la sesión</a></li>
  <li><a href="#estadística-descriptiva" id="toc-estadística-descriptiva" class="nav-link" data-scroll-target="#estadística-descriptiva">1. Estadística descriptiva</a>
  <ul class="collapse">
  <li><a href="#datos" id="toc-datos" class="nav-link" data-scroll-target="#datos">Datos</a></li>
  <li><a href="#tipos-de-variables" id="toc-tipos-de-variables" class="nav-link" data-scroll-target="#tipos-de-variables">Tipos de variables</a></li>
  <li><a href="#estadísticas-descriptivas" id="toc-estadísticas-descriptivas" class="nav-link" data-scroll-target="#estadísticas-descriptivas">Estadísticas descriptivas</a></li>
  <li><a href="#medidas-de-localización-o-tendencia-central" id="toc-medidas-de-localización-o-tendencia-central" class="nav-link" data-scroll-target="#medidas-de-localización-o-tendencia-central">1.1. Medidas de localización o tendencia central</a>
  <ul class="collapse">
  <li><a href="#robustez-de-las-medidas-de-localización" id="toc-robustez-de-las-medidas-de-localización" class="nav-link" data-scroll-target="#robustez-de-las-medidas-de-localización">1.1.1. Robustez de las medidas de localización</a></li>
  <li><a href="#medias-podadas" id="toc-medias-podadas" class="nav-link" data-scroll-target="#medias-podadas">Medias podadas</a></li>
  <li><a href="#medias-windorizadas-opcional" id="toc-medias-windorizadas-opcional" class="nav-link" data-scroll-target="#medias-windorizadas-opcional">Medias Windorizadas (opcional)</a></li>
  </ul></li>
  <li><a href="#medidas-de-dispersión" id="toc-medidas-de-dispersión" class="nav-link" data-scroll-target="#medidas-de-dispersión">1.2. Medidas de dispersión</a>
  <ul class="collapse">
  <li><a href="#la-varianza" id="toc-la-varianza" class="nav-link" data-scroll-target="#la-varianza">La varianza</a></li>
  <li><a href="#la-desviación-estándar" id="toc-la-desviación-estándar" class="nav-link" data-scroll-target="#la-desviación-estándar">La desviación estándar</a></li>
  <li><a href="#robustez-en-las-medidas-de-dispersión" id="toc-robustez-en-las-medidas-de-dispersión" class="nav-link" data-scroll-target="#robustez-en-las-medidas-de-dispersión">1.2.1. Robustez en las medidas de dispersión</a></li>
  <li><a href="#el-rango" id="toc-el-rango" class="nav-link" data-scroll-target="#el-rango">El rango</a></li>
  <li><a href="#el-rango-intercuartil" id="toc-el-rango-intercuartil" class="nav-link" data-scroll-target="#el-rango-intercuartil">El rango intercuartil</a></li>
  </ul></li>
  <li><a href="#medidas-de-posición" id="toc-medidas-de-posición" class="nav-link" data-scroll-target="#medidas-de-posición">1.3. Medidas de posición</a>
  <ul class="collapse">
  <li><a href="#los-percentiles" id="toc-los-percentiles" class="nav-link" data-scroll-target="#los-percentiles">Los percentiles</a></li>
  </ul></li>
  <li><a href="#transformaciones-lineales-de-los-datos-descriptivos" id="toc-transformaciones-lineales-de-los-datos-descriptivos" class="nav-link" data-scroll-target="#transformaciones-lineales-de-los-datos-descriptivos">1.4. Transformaciones lineales de los datos descriptivos</a></li>
  </ul></li>
  <li><a href="#estadística-descriptiva-y-visualización-de-los-datos" id="toc-estadística-descriptiva-y-visualización-de-los-datos" class="nav-link" data-scroll-target="#estadística-descriptiva-y-visualización-de-los-datos">2. Estadística descriptiva y visualización de los datos</a>
  <ul class="collapse">
  <li><a href="#tipos-de-gráficos" id="toc-tipos-de-gráficos" class="nav-link" data-scroll-target="#tipos-de-gráficos">Tipos de gráficos</a></li>
  <li><a href="#gráficos-univariados" id="toc-gráficos-univariados" class="nav-link" data-scroll-target="#gráficos-univariados">Gráficos univariados</a>
  <ul class="collapse">
  <li><a href="#gráficos-de-barras" id="toc-gráficos-de-barras" class="nav-link" data-scroll-target="#gráficos-de-barras">Gráficos de barras</a></li>
  <li><a href="#histogramas-y-kernels" id="toc-histogramas-y-kernels" class="nav-link" data-scroll-target="#histogramas-y-kernels">Histogramas (y kernels)</a></li>
  <li><a href="#gráfico-de-cajas-boxplots" id="toc-gráfico-de-cajas-boxplots" class="nav-link" data-scroll-target="#gráfico-de-cajas-boxplots">Gráfico de cajas (boxplots)</a></li>
  </ul></li>
  <li><a href="#gráficos-bivariados" id="toc-gráficos-bivariados" class="nav-link" data-scroll-target="#gráficos-bivariados">Gráficos bivariados</a>
  <ul class="collapse">
  <li><a href="#gráficos-de-barras-de-dos-variables" id="toc-gráficos-de-barras-de-dos-variables" class="nav-link" data-scroll-target="#gráficos-de-barras-de-dos-variables">Gráficos de barras de dos variables</a></li>
  <li><a href="#boxplots-bivariados" id="toc-boxplots-bivariados" class="nav-link" data-scroll-target="#boxplots-bivariados">Boxplots bivariados</a></li>
  <li><a href="#gráficos-de-dispresión-de-puntos-scatter-plots" id="toc-gráficos-de-dispresión-de-puntos-scatter-plots" class="nav-link" data-scroll-target="#gráficos-de-dispresión-de-puntos-scatter-plots">Gráficos de dispresión de puntos (<em>scatter plots</em>)</a></li>
  </ul></li>
  <li><a href="#estadística-inferencial" id="toc-estadística-inferencial" class="nav-link" data-scroll-target="#estadística-inferencial">3. Estadística inferencial</a>
  <ul class="collapse">
  <li><a href="#variables-aleatorias-funciones-y-distribución-de-probabilidad" id="toc-variables-aleatorias-funciones-y-distribución-de-probabilidad" class="nav-link" data-scroll-target="#variables-aleatorias-funciones-y-distribución-de-probabilidad">Variables aleatorias: funciones y distribución de probabilidad</a></li>
  <li><a href="#distribución-normal-estándar" id="toc-distribución-normal-estándar" class="nav-link" data-scroll-target="#distribución-normal-estándar">Distribución normal estándar</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Sesión 2: Estadística Descriptiva (II) y Prueba de Hipótesis (I)</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Taller de Métodos y Técnicas de Investigación I</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>En esta sesión entraremos de lleno en estadística descriptiva, retomando desde contenidos de la sesión pasada, pero con un enfoque más riguroso. Sumado a esto, nos enfocaremos más en esto desde una perspectiva más estadística y usando R aplicadamente, sin deternos tanto en R mismo. Aunque también aprovecharé de mostrarle como crear funciones de usuario para hacer estadísticas descriptivas con una sola función.</p>
<section id="objetivos-de-la-sesión" class="level2">
<h2 class="anchored" data-anchor-id="objetivos-de-la-sesión">Objetivos de la sesión</h2>
<ul>
<li>Comprender la estadística descriptiva</li>
<li>Conocer medidas de la estadística descriptiva</li>
<li>Crear visualizaciones avanzadas.</li>
<li>Introducción a test de hipótesis y estadística inferencial</li>
</ul>
<p>Pero antes de comenzar, carguemos los paquetes que utilizaremos, donde además les muestro mi forma favorita de cargar y traer paquetes en un solo paso (con <code>pacman</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Forma 1 (Forma clásica)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>) <span class="co"># colección de paquetes, dplyr entre ellos</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>) <span class="co"># manipular datos</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"sjmisc"</span>) <span class="co"># explorar datos</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Forma 2 (Mejor para reproductibilidad)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(<span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="co"># colección de paquetes, dplyr entre ellos</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"dplyr"</span>, <span class="co"># manipular datos</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"sjmisc"</span>), <span class="co"># explorar datos</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(p) </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(p, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(p)))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Llamar librería </span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Forma 3 (Mi favorita. Es `install.packages()` -si no está bajado- más `library`)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, <span class="co"># colección de paquetes, dplyr entre ellos, pero también haven</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>               dplyr, <span class="co"># manipular datos</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>               psych, <span class="co"># para estadísticas descriptivas</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>               sjmisc, <span class="co"># explorar datos</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>               ggplot2, <span class="co"># para visualizar gráficos</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>               scales) <span class="co"># para ajustar gráficos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estadística-descriptiva" class="level1">
<h1>1. Estadística descriptiva</h1>
<section id="datos" class="level2">
<h2 class="anchored" data-anchor-id="datos">Datos</h2>
<p>Para comprender que son las estadísticas descriptivas, y para que las usaremos como futurxs sociólogxs, partamos viendo <em>qué son los datos</em>. Los <strong>datos</strong> son valores (o mediciones) de variables que han sido recolectados y organizados para su análisis. La palabra datos se define como información factual (como mediciones o estadísticas) utilizada como base para el razonamiento, para la discusión o para cálculos <a href="https://www.merriam-webster.com/dictionary/data">(Merrian-Webster)</a>. Existen tres tipos de <em>estrucutas de datos</em>:</p>
<ol type="1">
<li><p><strong>Datos de corte transversal</strong>: son mediciones de un conjunto de variables para un gurpo de unidades (personas, hogares, empresas, países, etc.) en un mismo momento del tiempo. Un ejemplo de esto puede ser los puntajes PSU de un año dado. Una base de datos de datos de corte transversal, e.g., es la CASEN, la ENUT, la ENE, etc.</p></li>
<li><p><strong>Datos de series de tiempo</strong>: sucesión de registros de una o varias variables de una única unidad, que son medidos en determinados momento del tiempo en un orden cronológico claro. Es importante resaltar que registra una <strong>única</strong> entidad/unidad a lo largo del tiempo. Un ejemplo podría ser el IMACEC o el PIB de tal a tal periodo.</p></li>
<li><p><strong>Datos de panel o longitudinales</strong>: sucesión de registros de un conjunto de variables para un grupo de unidades medidas en varios momentos del tiempo. Los datos de panel/longitudinales combinan las dimensiones de corte transversal y series de tiempo de los datos, pues es una sucesión de registros de un <em>conjunto de variables</em> para un <em>grupo de unidades</em>, medidas en varios momentos del tiempo con un orden cronológico claro. Un ejemplo de esto podría ser la tasa de crecimiento anual del PIB real para un grupo de países de tal a cual periodo.</p></li>
</ol>
<p>A su vez, existen dos tipos de recolección de datos:</p>
<ol type="1">
<li><p><strong>Estudios observacionales</strong>: los datos se recopilan por medio de la observación de los valores de las variables de interés sin intervención o influencia en ellos; o</p></li>
<li><p><strong>Experimentos</strong>: tras una exposición de ciertas unidades a una intervención, se observan los valores de las variables de interés presentes en los resultados.</p></li>
</ol>
</section>
<section id="tipos-de-variables" class="level2">
<h2 class="anchored" data-anchor-id="tipos-de-variables">Tipos de variables</h2>
<p>Una variable es una característica o atributo que puede tomar valores diferentes para distintas unidades. Las variables tienen dos categorías principales que las distinguen:</p>
<ol type="1">
<li><strong>Variables categóricas</strong>: puede tomar un número limitado de valores definido sobre la base de alguna característica cualitativa. A su vez, dentro de las variables categóricas se encuentran</li>
</ol>
<ul>
<li><p><em>Variable categórica nominal</em>: es una variable categórica/cualitativa sin ningún orden o jerarquía clara. Por ejemplo, una variable que registre nombres de un curso, comunas, países, etc. Dentro de las variables categóricas nominales, se encuentran las variables <em>dummy</em>, las que poseen solo dos valores a los que se les puede asignar un número, generalmente <span class="math inline">\(0\)</span> o <span class="math inline">\(1\)</span>, donde <span class="math inline">\(1\)</span> indica presencia del atributo y <span class="math inline">\(0\)</span> ausencia.</p></li>
<li><p><em>Varible categórica ordinal</em>: es una variable categórica/cualitativa que tiene un orden o jerarquí establecida entre sus categorías. Por ejemplo, el nivel educacional o las variables en “Escala Likert”</p></li>
</ul>
<p>En R, para crear una variable cualitativa, deben escribirse entre comillas sus categorías, como ya vimos la sesión pasada. Por ejemplo,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables categóricas</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>var_nominal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Karl Marx"</span>, <span class="st">"Rosa Luxemburgo"</span>, <span class="st">"Wooldrigde"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_nominal) <span class="co"># Comprobar naturaleza de la variable</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "character"</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>var_ordinal_educ<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Secundaria Incompleta"</span>, <span class="st">"Secundaria Completa"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Educación Superior Incompleta"</span>, <span class="st">"Educación Superior Completa"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>var_ordinal_likert <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Muy malo"</span>, <span class="st">"Malo"</span>, <span class="st">"Maomeno"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Bueno"</span>, <span class="st">"Muy bueno"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_ordinal_educ) <span class="co"># Comprobar naturaleza de la variable</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "character"</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_ordinal_likert) <span class="co"># Comprobar naturaleza de la variable</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "character"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Suele ser útil, en R, asignarles números a las variables cualitativas para un análisis estadísticos posteriores. Por ejemplo, podríamos tomar <code>var_ordinal_likert</code> y, <em>además</em> de que tenga sus categorías asociadas, también tengan un número. Por ejemplo, que <code>"Muy malo"</code> sea <code>1</code> y <code>"Muy bueno"</code> sea <code>5</code>. Esto podemos hacerlo de dos maneras que mostramos de inmediato. Por cierto, la segunda la hacemos con <code>haven</code> que es un paquete dentro de <code>tidyverse</code>, y que usualmente usaremos ese paquete para cargar bases de datos, pero que también sirve para recodificar:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Versión con un factor ordenado (tienes la categoría y su código interno)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>var_ordinal_likert <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  var_ordinal_likert,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels  =</span> <span class="fu">c</span>(<span class="st">"Muy malo"</span>, <span class="st">"Malo"</span>, <span class="st">"Maomeno"</span>, <span class="st">"Bueno"</span>, <span class="st">"Muy bueno"</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Para ver el código numérico (1=Muy malo … 5=Muy bueno):</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(var_ordinal_likert)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 3 4 5</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Si prefieres un vector numérico “double” con etiquetas (dos niveles),</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#    puedes usar haven::labelled</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>var_ordinal_likert <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">labelled</span>(</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.integer</span>(<span class="fu">factor</span>(</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    var_ordinal_likert,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels  =</span> <span class="fu">c</span>(<span class="st">"Muy malo"</span>, <span class="st">"Malo"</span>, <span class="st">"Maomeno"</span>, <span class="st">"Bueno"</span>, <span class="st">"Muy bueno"</span>),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  )),</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Muy malo"</span>  <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Malo"</span>      <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Maomeno"</span>   <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bueno"</span>     <span class="ot">=</span> <span class="dv">4</span>,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Muy bueno"</span> <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprobamos:</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>var_ordinal_likert</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a><span class="do">## &lt;labelled&lt;integer&gt;[5]&gt;</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 3 4 5</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a><span class="do">## Labels:</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  value     label</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="do">##      1  Muy malo</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="do">##      2      Malo</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="do">##      3   Maomeno</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a><span class="do">##      4     Bueno</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a><span class="do">##      5 Muy bueno</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li><strong>Variables cuantitativas</strong>: son variables medidas en una escala númerica, como la edad, temperatura, estatura, etc. Y, por lo tanto, que el número mismo indica ordinalidad y jerarquía entre los valores (<span class="math inline">\(x&lt;x+1\)</span>). También hay dos tipos de variables cuantitativas</li>
</ol>
<ul>
<li><p><em>Variable cuantitativa discreta</em>: es aquella que <em>solo</em> puede tomar números específicos como valores, sin poder tomar un valor intermedio entre dos valores específicos. Es decir, que se expresan en números enteros. Matemáticamente, simplemente son variables en que sus valores <span class="math inline">\(x \in \mathbb{N}\)</span>. Un ejemplo, puede ser el número de ventas (no se puede vender -100), la edad de las personas encuestadas (no se puede tener -2), etc.</p></li>
<li><p><em>Variable cuantiativa continua</em>: puede tomar como valores un número infinito de posibilidades dentro de un rango de números, por lo que se expresa en números reales: <span class="math inline">\(x\in \mathbb{R}\)</span>. Un ejemplo de esto puede ser una cuenta corriente, el peso de las personas, la temperatura, etc.</p></li>
</ul>
<p>En R, las variables cuantitativas tienen por categorías números, sin “…”. Además, si se quiere dejar como variable cuantitativa discreta (<code>integer</code>), se le puede añadir una <code>L</code> después del número. Esto es porque en R cualquier literal numérico sin sufijo se interpreta por defecto como tipo <code>numeric</code> (variable cuantitativa). Al añadir la <code>L</code> se le indica a R que es un <code>integer</code> (número entero). No obstante, generalmente para el análisis estadístico no afectará mucho.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables cuantitativas discretas</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>var_discreta_hijos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>L, <span class="dv">1</span>L, <span class="dv">2</span>L, <span class="dv">3</span>L, <span class="dv">4</span>L)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>var_discreta_autos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>L, <span class="dv">0</span>L, <span class="dv">2</span>L, <span class="dv">1</span>L, <span class="dv">3</span>L)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_discreta_hijos)   </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "integer"</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_discreta_autos)   </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "integer"</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables cuantitativas continuas</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>var_continua_altura <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.65</span>, <span class="fl">1.72</span>, <span class="fl">1.58</span>, <span class="fl">1.80</span>, <span class="fl">1.75</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>var_continua_peso   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">65.4</span>, <span class="fl">70.2</span>, <span class="fl">58.9</span>, <span class="fl">80.0</span>, <span class="fl">72.5</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_continua_altura)  <span class="co"># numeric</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "numeric"</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_continua_peso)    <span class="co"># numeric</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "numeric"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="estadísticas-descriptivas" class="level2">
<h2 class="anchored" data-anchor-id="estadísticas-descriptivas">Estadísticas descriptivas</h2>
<p>Las estadísticas descriptivas son valores fácilmente interpretables y que entregan un “resumen” de las características más importantes de un conjunto de datos, además de que utilizan para su cálculo operaciones aritméticas simples. Las estadísticas descriptivas son el primer paso en el análisis exploratorio de datos. Antes del análisis estadístico más riguroso de los datos, es esencial examinar las estadísticas descriptivas de todas las variables para:</p>
<ul>
<li><p>Detectar errores de medición o valores atípicos (<em>outliers</em>) en los datos.</p></li>
<li><p>Detectar patrones y tendencias en los datos.</p></li>
<li><p>Evaluar la plausibilidad de los supuestos de trabajo.</p></li>
<li><p>Establecer hipótesis de trabajo.</p></li>
</ul>
<p>A su vez, las estadísticas descriptivas se pueden clasificar en tres grupos:</p>
<ol type="1">
<li><p><strong>Medidas de localización o tendencia central</strong>: Se calculan para describir un valor central alrededor del cual se ubican (distribuyen) los datos. En otras palabras, estas medidas determinan el valor donde se ubican mayoritariamente las observaciones</p></li>
<li><p><strong>Medidas de dispersión o variabilidad</strong>: Proporcionan una descripción de la “dispersión de los datos” o qué tan lejos están las observaciones de la tendencia central.</p></li>
<li><p><strong>Medidas de posición</strong>: Resumen la posición relativa de valores específicos en los datos.</p></li>
</ol>
<p>Antes de seguir profundizando esto, utilizaremos bases de datos reales y conocidas para ir ejemplificando el contenido con datos observacionales. Partamos con la Encuesta de Caracterización Socioeconómica Nacional (CASEN) más actual, la CASEN 2022. Esta se puede obtener en el <a href="https://observatorio.ministeriodesarrollosocial.gob.cl/encuesta-casen-2022">siguiente link</a>, que cuenta con 202.231 casos (encuestados) y 918 variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Obtener ruta </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>() <span class="co"># Para obtener nuestro directorio (en este casode nuestro RProject)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "C:/Users/Fran/OneDrive/Escritorio/UAH/MAGISTER ECONOMIA UCH/Ayudantías/Taller métodos/metodos-mgsocio-uah/lectures"</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar formato sav (SPSS)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>casen2022<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data-sesiones/CASEN 2022.sav"</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(casen2022)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 202231    918</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar formato dta (STATA)</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># casen2022&lt;-haven::read_dta(".../CASEN 2022.dta")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Continuemos. Antes de pasar a estos tres grupos de estadísticas descriptivas, conviene tener en claro el concepto de estadísticos de orden. Los <strong>estadísticos de orden</strong> es la ordenación de un conjunto de datos u obsrvaciones, dond <span class="math inline">\(y_k\)</span> es el <span class="math inline">\(k-\)</span>ésimo menor valor del conjunto de observaciones. Por ejemplo, si tenemos estos cuatro datos: <span class="math display">\[
x_1 =9; x_2=3, x_3 = 12; x_3 =1 ; x_5=2
\]</span> Los estadísticos de orden, <span class="math inline">\(y_i\)</span>, corresponderían a <span class="math display">\[
y_1=1; y_2=2; y_3=3; y_4=9; y_5=12
\]</span> Es decir, la ordenación de <span class="math inline">\(x_i\)</span> de menor a mayor. Dicho esto, pasemos, en primer lugar, a las medidas de localización o tendencia central.</p>
</section>
<section id="medidas-de-localización-o-tendencia-central" class="level2">
<h2 class="anchored" data-anchor-id="medidas-de-localización-o-tendencia-central">1.1. Medidas de localización o tendencia central</h2>
<section id="media-o-promedio" class="level4">
<h4 class="anchored" data-anchor-id="media-o-promedio">Media o promedio</h4>
<p>La <em>media</em> de <span class="math inline">\(n\)</span> observaciones de una variable, (x_1, , x_n), que denotaremos por ({x}), está definida por la suma de los valores de todas las observaciones, dividida por el número de observaciones: <span class="math display">\[
\bar{x} = \frac{x_1 + x_2 + \dots + x_n}{n} = \frac{1}{n} \sum_{i=1}^{n} x_i.
\]</span> Por ejemplo, supongamos que los datos son: <span class="math display">\[
x_1 = 0.7; \quad x_2 = 1.2; \quad x_3 = 0.9; \quad x_4 = 0.6; \quad x_5 = 1.4; \quad x_6 = 1.8; \quad x_7 = 2.5.
\]</span> La media en este caso viene dada por: <span class="math display">\[
\bar{x} = \frac{0.7 + 1.2 + 0.9 + 0.6 + 1.4 + 1.8 + 2.5}{7} = 1.3.
\]</span> En R, la media se obtiene simplemente con el comando <code>mean()</code>. Veamos como obtener la media de alguna variable de interés en la CASEN 2022.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener media mediante mean()</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(casen2022<span class="sc">$</span>ytrabajocor) <span class="co"># Ingreso del trabajo corregido</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] NA</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Ups! </span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(casen2022<span class="sc">$</span>ytrabajocor,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># ahora si :)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 667690.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como se ve, el salario promedio de los encuestados de la CASEN 2022 es de 667.690CLP. El comando <code>na.rm = TRUE</code> es para sacar las observaciones <code>NA</code> de la variable, las cuales registran los casos</p>
</section>
<section id="mediana" class="level4">
<h4 class="anchored" data-anchor-id="mediana">Mediana</h4>
<p>La <strong>mediana</strong> es el valor medio de un conjunto de observaciones cuando se les ordena de menor a mayor. Si el número de observaciones es par, entonces la <em>mediana</em> es la suma de los dos valores medios, dividida por 2. Si ordenamos las observaciones del ejemplo anterior de menor a mayor obtenemos los <strong>estadísticos de orden</strong> del conjunto de observaciones: <span class="math display">\[
y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, \quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8, \quad y_7 = 2.5.
\]</span> Notar que los <em>estadísticos de orden</em> cumplen con <span class="math display">\[
y_1 = \min(x_1, x_2, \dots, x_7), \quad y_7 = \max(x_1, x_2, \dots, x_7), \quad y_1 \leq y_2 \leq \dots \leq y_7.
\]</span> Entonces, para calcular la mediana se tiene que ordenar primero la muestra de datos de menor a mayor, tal que se cumpla con los estadísticos de orden. Así, la <em>mediana</em> en este ejemplo, que denotamos por <span class="math inline">\(\tilde{x}\)</span>, viene dada por: <span class="math display">\[
\tilde{x} = y_4 = 1.2.
\]</span> Ahora bien, en este caso, tenemos un <span class="math inline">\(n\)</span> impar. Luego, es más fácil establecer la mediana. Supongamos ahora que tenemos un número par de cantidad de datos, un <span class="math inline">\(n=6\)</span>, por ejemplo. <span class="math display">\[
x_1 = 0.7, \quad x_2 = 1.2, \quad x_3 = 0.9, \quad x_4 = 0.6, \quad x_5 = 1.4, \quad x_6 = 1.8.
\]</span> Es decir, los mismos datos que antes, salvo que hemos excluido el valor más grande. Entonces los estadísticos de orden son: <span class="math display">\[
y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, \quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8.
\]</span> Y la mediana es: <span class="math display">\[
\tilde{x} = \frac{y_3 + y_4}{2} = \frac{0.9 + 1.2}{2} = 1.05.
\]</span> Por lo tanto, la mediana en este caso es el promedio simple entre los dos números ``al medio’’ del conjunto de datos. Si tenemos que <span class="math inline">\(n=6\)</span>, entonces la mediana es el promedio entre <span class="math inline">\(x_3\)</span> y <span class="math inline">\(x_4\)</span>, arrojando un valor nuevo. En suma, la mediana es un valor que puede o no puede estar en el conjunto de datos. Si el conjunto de dato es par, entonces será el promedio simple entre los 2 datos del medio y si es impar simplemente será el valor del medio.</p>
<p>En R esto se obtiene con <code>median()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener mediana a través de median()</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(casen2022<span class="sc">$</span>ytrabajocor,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># Ingreso del trabajo corregido</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 480000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como vemos, la mediana de los ingresos del trabajo (salario), es 480.000 CLP. Lo cual habla bastante de la dispersión de los ingresos, pues el promedio es de 667.690 CLP. Siguiendo la lógica de los estadísticos de orden, lo que tenemos es que el <span class="math inline">\(50\%\)</span> de los encuestados gana 480.000 CLP <em>o menos</em>. Y, sin embargo, el promedio es de 667.690 CLP, i.e., de 187.690 CLP más. Esto se debe a que hay ingresos muy altos, que elevan el promedio. Y la media es una medida <em>sensible</em> a los valores extremos. En breve, profundizaremos sobre esto, pero tiene que ver con robustez de las medidas de localización, lo cual será clave más adelante para para realizas <strong>estimaciones</strong> con estas medidas.</p>
</section>
<section id="moda" class="level4">
<h4 class="anchored" data-anchor-id="moda">Moda</h4>
<p>La <em>moda</em> es el valor más frecuente de un conjunto de observaciones. Un conjunto de valores puede tener más de una moda. Por ejemplo, supongamos que los datos son: <span class="math display">\[
x_1 = 0.7; \quad x_2 = 1.2; \quad x_3 = 1.2; \quad x_4 = 0.6; \quad x_5 = 1.4; \quad x_6 = 1.8; \quad x_7 = 2.5.
\]</span> Entonces la moda, que denotaremos por <span class="math inline">\(\tilde{\tilde{x}}\)</span><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, viene dada por: <span class="math display">\[
\tilde{\tilde{x}}= 1.2.
\]</span> Para un conjunto de valores puede haber más de una moda.</p>
<p>En R, no hay un “paquete base” para extraer la moda. Pero si se puede hacer una función, o bien, usar paquetes. Veamos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Moda en el caso de datos unimodales discretos</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">1</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Función para calcular la moda</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">as.numeric</span>(<span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(x)))))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(x)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>) <span class="co"># Para desactivar notación cientifica</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(casen2022<span class="sc">$</span>ytrabajocor)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 400000</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Moda con mfv() de modeest</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(modeest)</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>modeest<span class="sc">::</span><span class="fu">mfv</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na_rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 400000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Como se puede observar, la moda de los ingresos del trabajo es de 400.000 CLP. Es decir, que el valor que más se repite entre los salarios de los encuestados es de 400 lucas.</p>
</section>
<section id="robustez-de-las-medidas-de-localización" class="level3">
<h3 class="anchored" data-anchor-id="robustez-de-las-medidas-de-localización">1.1.1. Robustez de las medidas de localización</h3>
<p>Ahora bien, <strong>¿cuán robustas son las medidas de localización?</strong> Un tema a considerar es cuál es el impacto de observaciones aberrantes en las medidas de localización, es decir, qué impacto tiene la presencia de una fracción pequeña de observaciones con errores muy grandes en su registro o que son atípicas por otro motivo en el valor de las medidas de localización.</p>
<p>Hablaremos indistintamente de observaciones aberrantes, observaciones extrañas y <em>outliers</em>. Si el número de observaciones es pequeño, se puede investigar uno por uno los valores aberrantes y corregir, reemplazar o eliminar las observaciones en cuestión. Sin embargo, cuando el número de observaciones es más grande, uno quisiera medidas de localización que sean insensibles a la presencia de una fracción moderada de observaciones extrañas y que, al mismo tiempo, sean un buen resumen numérico de la tendencia central de los datos. Analicemos, pues, cuán robusta son estas medidas.</p>
<section id="robustez-de-la-media" class="level4">
<h4 class="anchored" data-anchor-id="robustez-de-la-media">Robustez de la media</h4>
<p>Supongamos que los datos son <span class="math display">\[
x_1 = 0.7;\ x_2 = 1.2;\ x_3 = 0.9;\ x_4 = 0.6;\ x_5 = 1.4;\ x_6 = 1.8;\ x_7 = 2.5.
\]</span> Como vimos la media viene dada por <span class="math inline">\(\bar{x} = 1.3\)</span>. Intuitivamente la media <strong>no</strong> es robusta, pues un solo outlier puede tener un efecto devastador sobre su valor. En efecto, si una de las observaciones, digamos la primera, es reportada con un error de medición <span class="math inline">\(e\)</span>, de modo que <span class="math display">\[
x_1 = 0.7 + e
\]</span> entonces la media, como función del error <span class="math inline">\(e\)</span>, será: <span class="math display">\[
\bar{x}(e) = 1.3 + \frac{e}{7}
\]</span> y tenemos que <span class="math display">\[
\lim_{e \to \infty} \bar{x}(e) = \infty, \quad \lim_{e \to -\infty} \bar{x}(e) = -\infty.
\]</span> En el caso más general tenemos <span class="math inline">\(\bar{x}(e) = \bar{x}(0) + \frac{e}{n}\)</span>, de modo que esta expresión tiende a <span class="math inline">\(\pm\infty\)</span> cuando <span class="math inline">\(e\)</span> tiende a <span class="math inline">\(\pm\infty\)</span>.</p>
<p>En suma, la media es una medida de localización central <strong>muy</strong> sensible a valores atípicos/<em>outliers</em>. En este sentido, a pesar de que indica información, hay que tener cuidado y en general suele ser complementada con otras medidas, tal como vimos con la mediana.</p>
</section>
<section id="robustez-de-la-mediana" class="level4">
<h4 class="anchored" data-anchor-id="robustez-de-la-mediana">Robustez de la mediana</h4>
<p>Como vimos, los <em>estadísticos de orden</em> de las observaciones anteriores están dadas por: <span class="math display">\[
y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, \quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8, \quad y_7 = 2.5.
\]</span> Vimos también que la mediana, que denotamos por <span class="math inline">\(\tilde{x}\)</span>, viene dada por: <span class="math display">\[
\tilde{x} = y_4 = 1.2.
\]</span> Ahora, suponiendo nuevamente que la primera observación se midió con error <span class="math inline">\(e\)</span>, de modo que <span class="math inline">\(x_1 = 0.7 + e\)</span>, y denotando por <span class="math inline">\(\tilde{x}(e)\)</span> la mediana cuando <span class="math inline">\(x_1\)</span> se reemplaza por <span class="math inline">\(x_1 + e\)</span>, tenemos <span class="math display">\[
\tilde{x}(e) =
\begin{cases}
    1.2 &amp; \text{si } e \leq 0.5, \\
    0.7 + e &amp; \text{si } 0.5 &lt; e \leq 0.7, \\
    1.4 &amp; \text{si } e &gt; 0.7.
\end{cases}
\]</span> En el caso general con <span class="math inline">\(n = 2m+1\)</span> observaciones, donde elegimos tamaño impar solo para simplificar las expresiones, tendremos que <span class="math inline">\(\tilde{x}(e) \in [y_m, y_{m+2}]\)</span>. Por tanto, la influencia de un valor aberrante en la mediana está acotada. Es decir, la <strong>mediana es una medida robusta</strong>.</p>
</section>
<section id="robustez-de-la-moda" class="level4">
<h4 class="anchored" data-anchor-id="robustez-de-la-moda">Robustez de la moda</h4>
<p>Supongamos que los datos están dados por: <span class="math display">\[
x_1 = 0.7, \quad x_2 = 1.2, \quad x_3 = 1.2, \quad x_4 = 0.6, \quad x_5 = 1.4, \quad x_6 = 1.8, \quad x_7 = 99.9.
\]</span> Entonces la moda viene dada por <span class="math inline">\(\tilde{\tilde{x}} = 1.2\)</span>.</p>
<p>Suponiendo nuevamente que la primera observación se midió con error <span class="math inline">\(e\)</span>, de modo que <span class="math inline">\(x_1 = 0.7 + e\)</span>, y denotando por <span class="math inline">\(\tilde{\tilde{x}}(e)\)</span> la moda cuando <span class="math inline">\(x_1\)</span> se reemplaza por <span class="math inline">\(x_1 + e\)</span>, tenemos que: <span class="math display">\[
\lim_{e \to \infty} \tilde{\tilde{x}}(e) = 1.2, \quad \lim_{e \to -\infty} \tilde{\tilde{x}}(e) = 1.2.
\]</span> En cambio, si la observación con error es la segunda observación, de modo que se midió <span class="math inline">\(x_2 = 1.2 + e\)</span>, para <span class="math inline">\(e = 0.6\)</span>, la moda será <span class="math inline">\(1.8\)</span>. El cambio en la moda puede ser mucho mayor, existen valores de <span class="math inline">\(e\)</span> para los cuales la moda es <span class="math inline">\(99.9\)</span>. En contraste, no existen valores de <span class="math inline">\(e\)</span> para los cuales la mediana cambie tanto.En suma, la moda es <strong>muy</strong> sensible a la presencia de <em>outliers</em>, no obstante va depende en qué localización de los datos se encuentre. Entonces, no siempre es muy sensible, pero a veces sí.</p>
</section>
<section id="sintesis" class="level4">
<h4 class="anchored" data-anchor-id="sintesis">Sintesis</h4>
<p>Como se desprende de las expresiones derivadas en los apartados anteriores, el impacto de valores extremos o atípicos es acotado tanto para la mediana como para la moda, mientras que para la media crece sin límite cuando <span class="math inline">\(|e|\)</span> tiende a infinito.Al mismo tiempo, la mediana pareciera ser más robusta que la moda, pues la influencia de errores de medición es menor. La moda pareciera estar entremedio, el impacto de outliers es acotado pero puede ser mucho más grande que su impacto en la mediana. Entonces, <strong>¿media, mediana o moda?</strong></p>
<p>En general, la moda se usa poco para resumir en una cifra la localización de los datos. Probablemente, porque es “demasiado localizada”. Por ejemplo, puede que la moda esté en 0, porque un 10% de las observaciones son iguales a cero, pero la mayoría de los datos sean mayores que 100. En casos como este la moda captura muy mal la localización de los datos, pues uno quisiera algún número mayor que 100, no cero. La media es la medida de localización más utilizada en la práctica, seguida de la mediana. Esto nos lleva a considerar las siguientes ventajas y desventajas</p>
<ul>
<li><p><strong>Mediana</strong>: más robusta.</p></li>
<li><p><strong>Media</strong>: usa toda la información. Al menos intuitivamente, la robustez de la mediana tiene como contraparte que usa poco la información disponible.</p></li>
</ul>
<p>Entonces, la media entrega más información, pero es menos robusta, en cambio la mediana sufre la ventaja/desventaja opuesta. La digresión anterior motiva considerar medidas de localización más robustas que la media y que usan más información que la mediana. Con ese objetivo consideramos a continuación <strong>las medias podadas</strong>.</p>
</section>
</section>
<section id="medias-podadas" class="level3">
<h3 class="anchored" data-anchor-id="medias-podadas">Medias podadas</h3>
<p>Supongamos que los datos están dado por: <span class="math display">\[
x_1 = 0.7, \; x_2 = 1.2, \; x_3 = 0.9, \; x_4 = 0.6, \; x_5 = 1.4, \; x_6 = 1.8, \; x_7 = 2.5,
\]</span> Como vimos, sus estadísticos de orden correspondientes son: <span class="math display">\[
y_1 = 0.6, \; y_2 = 0.7, \; y_3 = 0.9, \; y_4 = 1.2, \; y_5 = 1.4, \; y_6 = 1.8, \; y_7 = 2.5.
\]</span></p>
<p>Definimos la siguiente medida de localización: <span class="math display">\[
\bar{x}^p = \frac{1}{5}(y_2 + y_3 + \dots + y_6).
\]</span> Es decir, primero <strong>podamos</strong> los datos de la muestra ordenada de menor a mayor, removiendo un valor de cada extremo y luego calculamos el promedio de las observaciones podadas. El estadístico descriptivo que resulta se conoce como <em>media podada</em>, de nivel <span class="math inline">\(k=1\)</span> porque removimos una observación de cada extremo. Lo denominamos por <span class="math inline">\(\bar{x}^p\)</span>. Para las observaciones en cuestión tenemos que la media podada de nivel 1 es 1,2.</p>
<p>En síntesis, se eliminan los valores extremos, el más pequeño y el más grande en este caso. Y después calculamos el promedio. Con ello, se le agrega mayor robustez y estaremos usando más información que usando la mediana. Veamos el caso general, no solo para <span class="math inline">\(k=1\)</span></p>
<section id="medias-podadas-caso-general" class="level4">
<h4 class="anchored" data-anchor-id="medias-podadas-caso-general">Medias podadas: Caso General</h4>
<div class="definition">
<p>Sean <span class="math inline">\(x_1, \dots, x_n\)</span> las observaciones y <span class="math inline">\(y_1, \dots, y_n\)</span> los estadísticos de orden correspondientes. Entonces, para <span class="math inline">\(k &lt; n/2\)</span> definimos la media podada de nivel <span class="math inline">\(k\)</span> mediante: <span class="math display">\[
    \bar{x}^p = \frac{1}{n - 2k} \sum_{i = k+1}^{n-k} y_i.
\]</span></p>
</div>
<p>En palabras: dadas observaciones <span class="math inline">\(x_1, \dots, x_n\)</span>, la media podada de nivel <span class="math inline">\(k\)</span> será el promedio de los valores que se obtiene luego de remover <span class="math inline">\(k\)</span> observaciones de cada uno de sus extremos (las <span class="math inline">\(k\)</span> más grandes y las <span class="math inline">\(k\)</span> más pequeñas). Las medias podadas de nivel <span class="math inline">\(k = 1\)</span> —se remueve el mínimo y máximo— se utilizan para pasar de las evaluaciones individuales de los jurados en varios deportes, entre ellos nado sincronizado y gimnasia, a la evaluación agregada.</p>
<p>En R, esto se puede hacer de dos formas, con una función o con <code>mean()</code> y especificaciones:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Función manual para media podada de nivel k</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>media_podada <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k) {</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="dv">2</span><span class="sc">*</span>k <span class="sc">&gt;=</span> n) <span class="fu">stop</span>(<span class="st">"k debe ser menor que n/2"</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(y[(k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">-</span> k)])</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la media podada para k = 1</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">media_podada</span>(x, <span class="dv">1</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.2</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Usando la función base mean() con el argumento trim</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#    trim espera la fracción a recortar por cada extremo: k/n</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">trim =</span> k <span class="sc">/</span> n)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.2</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Media podada de los ingresos del trabajo</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(casen2022<span class="sc">$</span>ytrabajocor, </span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">trim =</span> k<span class="sc">/</span>n,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 521452.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="medias-windorizadas-opcional" class="level3">
<h3 class="anchored" data-anchor-id="medias-windorizadas-opcional">Medias Windorizadas (opcional)</h3>
<p>Esto es una medición opcional en el sentido de que no se usa mucho. Pero puede ser útil. Supongamos que los datos están dado por: <span class="math display">\[
x_1 = 0.7; \, x_2 = 1.2; \, x_3 = 0.9; \, x_4 = 0.6; \, x_5 = 1.4; \, x_6 = 1.8; \, x_7 = 2.5.
\]</span> Como vimos, sus estadísticos de orden correspondientes son: <span class="math display">\[
y_1 = 0.6, \, y_2 = 0.7, \, y_3 = 0.9, \, y_4 = 1.2, \, y_5 = 1.4, \, y_6 = 1.8, \, y_7 = 2.5.
\]</span> Definimos la siguiente medida de localización: <span class="math display">\[
\bar{x}^p = \frac{1}{7} [y_2 + y_2 + y_3 + y_4 + y_5 + y_6 + y_6].
\]</span></p>
<p>Es decir, ordenadas las observaciones de menor a mayor, sustituimos un valor de cada extremo por el valor inmediatamente anterior o posterior y luego calculamos el promedio de todos los valores. El estadístico descriptivo que resulta se conoce como <strong>media winsorizada</strong>, de nivel <span class="math inline">\(k = 1\)</span> porque sustituimos una observación de cada extremo. Lo denotamos por <span class="math inline">\(\bar{x}^w\)</span>. Para las observaciones en cuestión tenemos que la media winsorizada de nivel 1 es 1,21 (aproximadamente).</p>
<div class="definition">
<p><strong>Medias Winsorizadas: Caso General</strong></p>
<p>Sean <span class="math inline">\(x_1, \dots, x_n\)</span> las observaciones y <span class="math inline">\(y_1, \dots, y_n\)</span> los estadísticos de orden correspondientes. Entonces, para <span class="math inline">\(k &lt; n/2\)</span> definimos la media winsorizada de nivel <span class="math inline">\(k\)</span> mediante: <span class="math display">\[
  \bar{x}^w = \frac{k y_{k+1} + \sum_{i=k+1}^{n-k} y_i + k y_{n-k}}{n}.
\]</span></p>
</div>
<p>En palabras: dadas observaciones <span class="math inline">\(x_1, \dots, x_n\)</span>, la media winsorizada de nivel <span class="math inline">\(k\)</span> será el promedio de los valores que se obtiene luego de sustituir <span class="math inline">\(k\)</span> observaciones de cada uno de sus extremos (las <span class="math inline">\(k\)</span> más grandes y las <span class="math inline">\(k\)</span> más pequeñas) por el valor inmediatamente anterior o posterior. En R, se puede hacer con funciones nuevamente, o con el paquete <code>DescTools</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Función winsorizada + argumento na.rm</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>media_winsorizada <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k, <span class="at">na.rm =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na.rm) x <span class="ot">&lt;-</span> x[<span class="sc">!</span><span class="fu">is.na</span>(x)]</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="dv">2</span><span class="sc">*</span>k <span class="sc">&gt;=</span> n) <span class="fu">stop</span>(<span class="st">"k debe ser menor que n/2"</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sustituir k extremos</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span><span class="sc">:</span>k]           <span class="ot">&lt;-</span> y[k <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  y[(n <span class="sc">-</span> k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n] <span class="ot">&lt;-</span> y[n <span class="sc">-</span> k]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(y)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la media winsorizada para k = 1</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">media_winsorizada</span>(x, <span class="dv">1</span>)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.214286</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">media_winsorizada</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="dv">1</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 667567.7</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Usando la función Winsorize() del paquete DescTools</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(DescTools)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a><span class="co">#  Vector limpio de NAs</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(casen2022<span class="sc">$</span>ytrabajocor)</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Definimos k y calculamos n</span></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Calculamos los cuantiles que usarán de umbrales</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>umbrales <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(k<span class="sc">/</span>n, <span class="dv">1</span> <span class="sc">-</span> k<span class="sc">/</span>n), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Winsorizamos usando 'val = umbrales'</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>x_wins <span class="ot">&lt;-</span> <span class="fu">Winsorize</span>(x, <span class="at">val =</span> umbrales)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="co"># 6) Y finalmente sacamos la media</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x_wins)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 667567.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="síntesis" class="level4">
<h4 class="anchored" data-anchor-id="síntesis">Síntesis</h4>
<p>¿Qué hacemos en la práctica?</p>
<ul>
<li><p>Si se desea resumir la localización de los datos, parta por calcular la media, mediana y moda, así como también las medias podadas para algunos valores de <span class="math inline">\(k\)</span> (por ejemplo, <span class="math inline">\(k/n \simeq 0,05\)</span> y <span class="math inline">\(k/n \simeq 0,1\)</span>)</p></li>
<li><p>Si obtiene valores similares, reportar la media y mediana</p></li>
<li><p>Si hay diferencias importantes, mire los datos con cuidado, entienda de dónde vienen las diferencias y luego decida qué hacer.</p></li>
</ul>
</section>
</section>
</section>
<section id="medidas-de-dispersión" class="level2">
<h2 class="anchored" data-anchor-id="medidas-de-dispersión">1.2. Medidas de dispersión</h2>
<section id="la-varianza" class="level3">
<h3 class="anchored" data-anchor-id="la-varianza">La varianza</h3>
<p>Las medidas de dispersión lo que buscan es determinar cuán dispersos están los datos con respectos a una medida de tendencia central. Una de ellas es la varianza. La <strong>varianza</strong> es una medida que resume la <strong>dispersión de las observaciones <em>con respecto</em> a su media</strong>.</p>
<div class="definition">
<p>Dadas <span class="math inline">\(n\)</span> observaciones, <span class="math inline">\(x_1, \ldots, x_n\)</span>, la varianza de este conjunto de datos, que denotaremos por <span class="math inline">\(\hat{\sigma}^2\)</span>, está dada por: <span class="math display">\[
\begin{aligned}
\hat{\sigma}^2 &amp;= \frac{(x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 + \dots + (x_n - \bar{x})^2}{n}\\
&amp;= \frac{1}{n} \sum_{i=1}^{n} (x_i - \bar{x})^2 \\
&amp;= \frac{1}{n} \sum_{i=1}^{n} x_i^2 - \bar{x}^2.
\end{aligned}
\]</span></p>
</div>
<p>Por ejemplo, si tuvieramos que <span class="math display">\[
x_1 = 0.7; \quad x_2 = 1.2; \quad x_3 = 0.9; \quad x_4 = 0.6; \quad x_5 = 1.4; \quad x_6 = 1.8; \quad x_7 = 2.5,
\]</span> entonces, la varianza de estos datos sería <span class="math display">\[
\begin{aligned}
  \hat{\sigma}^2 = \frac{(0.7 - 1.3)^2 + (1.2 - 1.3)^2 + (0.9 - 1.3)^2}{7} \\
  + \frac{(0.6 - 1.3)^2 + (1.4 - 1.3)^2 + (1.8 - 1.3)^2 + (2.5 - 1.3)^2}{7} = 0.39.
\end{aligned}
\]</span></p>
<p>Ojo,cuando hay muchos datos, la fórmula más simple es el promedio de las observaciones al cuadrado, menos la media al cuadrado. O sea, la última igualdad que pusimos anteriormente, es decir,<br>
<span class="math display">\[
  \hat{\sigma}^2 =\frac{1}{n} \sum_{i=1}^{n} x_i^2 - \bar{x}^2.
\]</span> Esta, sin embargo, es una demostración de la primera sumatoria, aunque bastante trivial.</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span>Si <span class="math display">\[
\frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2 = \frac{1}{n} \sum_{i=1}^n x_i^2 - \bar{x}^2
\]</span> En efecto, <span class="math display">\[
\begin{aligned}
\frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2 &amp;= \frac{1}{n} \sum_{i=1}^n \left( x_i^2 - 2x_i \bar{x} + \bar{x}^2 \right)\\
&amp;= \frac{1}{n} \sum_{i=1}^n x_i^2 - 2 \bar{x} \frac{1}{n} \sum_{i=1}^n x_i + \frac{1}{n} \sum_{i=1}^n \bar{x}^2\\
&amp;= \frac{1}{n} \sum_{i=1}^n x_i^2 - 2 \bar{x}^2 + \bar{x}^2\\
&amp;= \frac{1}{n} \sum_{i=1}^n x_i^2 - \bar{x}^2.
\end{aligned}
\]</span></p>
</div>
<p>En R es mucho más fácil que estos cálculos tediosos. Esto se hace con el comando de R Base <code>var()</code>. No obstante, hay que tener en cuenta que <code>var()</code> es por defecto la varianaza muestra. Asumiendo que tenemos datos poblaciales podemos hacer dos cosas<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Veamos cómo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza poblacional</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>var_poblacional <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza simplificada</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>var_pobl_simplificada <span class="ot">&lt;-</span> <span class="fu">mean</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">mean</span>(x)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza muestral</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>var_muestral <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza muestral de casen2022$ytrabajocor</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>var_casen_muestral <span class="ot">&lt;-</span> <span class="fu">var</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>var_poblacional</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3885714</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>var_pobl_simplificada</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.3885714</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>var_muestral</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.4533333</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>var_casen_muestral</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 665844368478</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="la-desviación-estándar" class="level3">
<h3 class="anchored" data-anchor-id="la-desviación-estándar">La desviación estándar</h3>
<p>Una vez se tiene la varianza, la desviación estándar es muy fácil de calcular, pues es simplemente la raíz cuadrada de la varianza. La <em>desviación estándar</em> también es una medida de dispersión de los elementos del conjunto de observaciones con respecto a su media.</p>
<p>Dadas <span class="math inline">\(n\)</span> observaciones, $x_1, , x_n $, la desviación estándar de este conjunto de datos, que denotaremos por <span class="math inline">\(\hat{\sigma}\)</span>, está dada por la raíz cuadrada de la varianza: <span class="math display">\[
\hat{\sigma} = \sqrt{\hat{\sigma}^2} = \sqrt{\frac{(x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 + \ldots + (x_n - \bar{x})^2}{n}} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (x_i - \bar{x})^2}.
\]</span> Por ejemplo, si <span class="math display">\[
x_1 = 0.7; \, x_2 = 1.2; \, x_3 = 0.9; \, x_4 = 0.6; \, x_5 = 1.4; \, x_6 = 1.8; \, x_7 = 2.5,
\]</span> entonces, la desviación estándar de estos datos es: <span class="math inline">\(\hat{\sigma} = 0.62\)</span>. A diferencia de lo que ocurre con la varianza, la desviación estándar está medida en las mismas unidades que el conjunto de observaciones bajo análisis. Como veremos más adelante, esto hace que su interpretación sea más fácil y explica por qué se usa más que la varianza como medida de dispersión. Por lo tanto, la ventaja principal es esa. La desviación estándar está medida en las mismas unidades que las observaciones que estamos trabajando, y no así la varianza. En R es muy simple de hacer, con <code>sd()</code>. Al igual que con <code>var()</code>, <code>sd()</code> calcula por defecto al desviación estándar muestral.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Desviación estándar poblacional</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>sd_poblacional <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Desviación estándar simplificada</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>sd_simplificada <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">mean</span>(x)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Desviación estándar muestral</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>sd_muestral <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Desviación estándar muestral de casen2022$ytrabajocor</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>sd_casen_muestral <span class="ot">&lt;-</span> <span class="fu">sd</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>sd_poblacional</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.623355</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>sd_simplificada</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.623355</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>sd_muestral</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.6733003</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>sd_casen_muestral</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 815992.9</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Considerando la desviación estándar es una medida de dispersión que describe la descripción de los datos en las mismas unidades que el conjunto de observaciones nos sirve para comparar ahora <code>var_casen_muestral</code> con <code>sd_casen_muestral</code>. En el primer caso, <code>var_casen_muestral = 665844368478</code>, significa simplemente que la varianza de los datos es de ese valor, esa es su varianza. En cambio, <code>sd_casen_muestral = 815992.9</code> implica que la variación de los datos es de 815.992 CLP, pues la variable <code>ytrabajocor</code> mide pesos chilenos. En el caso de la varianza, nos dice cuán dispersos están los datos respecto a la media. En el caso de la desviación estándar, es también una medida de dispersión de los elementos del conjunto de observaciones con respecto a su media, pero que está en las unidades de la variable en cuestión, es decir, que hay una dispersión de los datos de 815.992 CLP respecto de la media (667.690 CLP, como habíamos visto). Por cierto, los valores elevados de dispersión son típicos en los ingresos, pues dada la desigualdad en estos, suelen tener una alta dispersión los datos de ingresos.</p>
</section>
<section id="robustez-en-las-medidas-de-dispersión" class="level3">
<h3 class="anchored" data-anchor-id="robustez-en-las-medidas-de-dispersión">1.2.1. Robustez en las medidas de dispersión</h3>
<p>Ahora bien, <strong>¿cuál es más robusta?</strong> La <em>desviación estándar muestral</em> y la <em>varianza muestral</em> no son medidas robustas de la dispersión de los datos. Aunque el álgebra es un poco más complejo, el problema es similar al que vimos con la media muestral.</p>
<p>Por ejemplo, denotando por <span class="math inline">\(\hat{\sigma}^2(e)\)</span> la varianza muestral cuando <span class="math inline">\(x_1\)</span> se mide con error <span class="math inline">\(e\)</span>, se tiene que, usando el resultado de que la varianza muestral es igual a la media muestral de los cuadrados menos el cuadrado de la media muestral:</p>
<div class="proof">
<p><span class="proof-title"><em>Proof</em>. </span><span class="math display">\[
\begin{aligned}
\hat{\sigma}^2(e) &amp;= \frac{1}{n} \left[ (x_1 + e)^2 + \sum_{i=2}^{n} x_i^2 \right] - \left( \frac{1}{n} \left[ (x_1 + e) + x_2 + \ldots + x_n \right] \right)^2 \\
&amp;= \frac{1}{n} \sum_{i=1}^{n} x_i^2 + \frac{x_1 e}{n} + \frac{e^2}{n} - \left( \bar{x} + \frac{e}{n} \right)^2 \\
&amp;= \frac{1}{n} \sum_{i=1}^{n} x_i^2 + \frac{x_1 e}{n} + \frac{e^2}{n} - \bar{x}^2 - 2 \bar{x} \frac{e}{n} - \frac{e^2}{n^2} \\
&amp;= \hat{\sigma}^2(0) + \frac{2}{n}(x_1 - \bar{x})e + \frac{n-1}{n^2}e^2.
\end{aligned}
\]</span> De donde se concluye que <span class="math display">\[
\lim_{e \to \pm \infty} \hat{\sigma}^2(e) = +\infty,
\]</span> y, por lo tanto, también que <span class="math display">\[
\lim_{e \to \pm \infty} \hat{\sigma}(e) = +\infty.
\]</span></p>
</div>
<p>En simple, las dos medidas de dispersión, la varianza y la desviación estándar, tienden a infinito positivo cuando el término de error tiende - o + infinito. Por lo tanto, ambas son medidas que no son robustas y, por lo tanto, sensibles a la presencia de valores extremos, de <em>outliers</em>.</p>
</section>
<section id="el-rango" class="level3">
<h3 class="anchored" data-anchor-id="el-rango">El rango</h3>
<p>El <em>rango</em> es la diferencia entre los valores <strong>más grande</strong> y <strong>más pequeño</strong> de un conjunto de observaciones de una variable. Al tomar el valor máximo y mínimo de los datos, permite obtener una idea de la <em>dispersión</em> de los datos. Así, cuanto mayor es el rango, aún más dispersos están los datos. Por ejemplo, si <span class="math display">\[
x_1 = 0.7; \quad x_2 = 1.2; \quad x_3 = 0.9; \quad x_4 = 0.6; \quad x_5 = 1.4; \quad x_6 = 1.8; \quad x_7 = 2.5,
\]</span> entonces, como ya vimos: <span class="math display">\[
y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, \quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8, \quad y_7 = 2.5.
\]</span> Entonces el rango está dado por: <span class="math display">\[
y_7 - y_1 = 2.5 - 0.6 = 1.9.
\]</span></p>
<p>Como ya se puede intuir a estas alturas, el rango tampoco es una medida de dispersión robusta, pues basta un <em>outlier</em> en los valores mínimos o máximos para que el rango se distorsiones. Así, aunque el rango de un conjunto de datos es simple de calcular, su valor no es muy útil porque depende fuertemente de valores extremos y, por tanto, no es robusto a la presencia de <em>outliers</em>. Formalmente, si tomamos el ejemplo anterior, tendríamos que <span class="math display">\[
\begin{aligned}
y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, &amp;\quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8, \quad y_7 = 2.5.\\
y_7 - y_1 = &amp;2.5 - 0.6 = 1.9.
\end{aligned}
\]</span> Ahora bien, suponiendo nuevamente que la primera observación se midió con error <span class="math inline">\(e\)</span>, de modo que <span class="math inline">\(x_1 = 0.7 + e\)</span>, y denotando por <span class="math inline">\(y_7(e)\)</span> y <span class="math inline">\(y_1(e)\)</span> al valor máximo y mínimo cuando <span class="math inline">\(x_1\)</span> se reemplaza por <span class="math inline">\(x_1 + e\)</span>, respectivamente, tenemos que: <span class="math display">\[
\lim_{e \to -\infty}(y_7(e) - y_1(e)) = \infty, \quad \lim_{e \to +\infty}(y_7(e) - y_1(e)) = \infty.
\]</span> Por lo que valores aberrantes o <em>outliers</em> tienen efectos brutales en el rango. En R es muy fácil de hacer, se puede “manualmente” o con <code>range()</code> y <code>diff()</code>. Lo mostramos y luego pasamos a la primera medida de dispersión robusta: el rango intercuartil.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Para obtener el rango (max–min) usa diff(range(x, na.rm=TRUE))</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango con max–min</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango con diff(range())</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co"># range(x, na.rm=TRUE) devuelve c(min, max), no la diferencia</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># En tu variable de casen2022</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>r_casen_1 <span class="ot">&lt;-</span> <span class="fu">max</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>             <span class="fu">min</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>r_casen_2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">range</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>r1</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.9</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>r2</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.9</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>r_casen_1</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 50966585</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>r_casen_2</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 50966585</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="el-rango-intercuartil" class="level3">
<h3 class="anchored" data-anchor-id="el-rango-intercuartil">El rango intercuartil</h3>
<p>El <strong>primer cuartil</strong> de un conjunto de observaciones de una variable, que denotaremos por <span class="math inline">\(q_1\)</span>, es el valor para el cual el 25% de las observaciones son más pequeñas y el 75% son más grandes. En otras palabras, el primer cuartil es la mediana del 50% más pequeño de los datos.</p>
<p>El <strong>segundo cuartil</strong>, <span class="math inline">\(q_2\)</span>, es el mismo valor que aquel de la mediana (50% son más pequeños, 50% son más grandes).</p>
<p>El <strong>tercer cuartil</strong>, <span class="math inline">\(q_3\)</span>, es el valor para el cual el 25% de las observaciones son más grandes y el 75% son más pequeñas. En otras palabras, el tercer cuartil es la mediana del 50% más grande de los datos.</p>
<p>El <strong>rango intercuartil</strong>, que denotaremos , está dado por: <span class="math inline">\(q_3 - q_1\)</span>.</p>
<p>Notar que el RIC es el <strong>rango</strong> del conjunto de observaciones con los cuartos más pequeño y más grande eliminados (<em>podados</em>), similar en espíritu a las observaciones que se consideran para calcular la media podada.Entonces, formalicemos su robustez.</p>
<p>Por ejemplo, supongamos que las observaciones (ordenadas de menor a mayor) son: <span class="math display">\[
43, 48, 50, 50, 52, 53, 56, 58, 59, 60, 62, 65, 66, 68, 70, 71, 74, 76, 78, 80,
\]</span> entonces los cuartiles de este conjunto de observaciones son: <span class="math display">\[
q_1 = 52.5, \quad q_2 = 61, \quad q_3 = 70.5
\]</span> y el RIC viene dado por <span class="math inline">\(q_3 - q_1 = 18\)</span></p>
<p>Ahora bien, suponiendo que el valor 43 se midió con un error <span class="math inline">\(e\)</span>, de modo que su valor es <span class="math inline">\(43 + e\)</span>, y denotando por <span class="math inline">\(RIC(e)\)</span> el valor del rango intercuartil cuando el valor 43 se reemplaza por <span class="math inline">\(43 + e\)</span>, tenemos que: <span class="math display">\[
RIC(e) \in [16,18]
\]</span> De modo que <strong>el RIC es una medida de dispersión de los datos robusta a la presencia de <em>outliers</em></strong>. Para calcular cuartiles en R se usa <code>quantile()</code>. Lo importante es especificar adecuadamente el cuantil de interés (50%, 75%, etc.) A su vez, entre los paquete de R base, específicamente en <code>stats</code>, se tiene <code>IQR()</code> nos permite calcular rangos intercuartiles.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">43</span>, <span class="dv">48</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">56</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">62</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">74</span>, <span class="dv">76</span>, <span class="dv">78</span>, <span class="dv">80</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular cuartiles</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>q1   <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>q2   <span class="ot">&lt;-</span> <span class="fu">median</span>(x)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>q3   <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango intercuartil</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>ric  <span class="ot">&lt;-</span> q3 <span class="sc">-</span> q1</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Para casen2022$ytrabajocor</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>x_casen    <span class="ot">&lt;-</span> casen2022<span class="sc">$</span>ytrabajocor</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>q1_casen   <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x_casen, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>q2_casen   <span class="ot">&lt;-</span> <span class="fu">median</span>(x_casen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>q3_casen   <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x_casen, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>ric_casen  <span class="ot">&lt;-</span> q3_casen <span class="sc">-</span> q1_casen</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternativa con función base</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>ric_casen2 <span class="ot">&lt;-</span> <span class="fu">IQR</span>(x_casen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>q1; q2; q3; ric</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="do">##   25% </span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 52.75</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 61</span></span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   75% </span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 70.25</span></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  75% </span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 17.5</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>q1_casen; q2_casen; q3_casen; ric_casen; ric_casen2</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a><span class="do">##    25% </span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 337500</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 480000</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a><span class="do">##    75% </span></span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 763333</span></span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a><span class="do">##    75% </span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a><span class="do">## 425833</span></span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 425833</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="medidas-de-posición" class="level2">
<h2 class="anchored" data-anchor-id="medidas-de-posición">1.3. Medidas de posición</h2>
<section id="los-percentiles" class="level3">
<h3 class="anchored" data-anchor-id="los-percentiles">Los percentiles</h3>
<p>El percentil de un conjunto de observaciones es una medida de posición que indica, una vez ordenados los datos de menor a mayor, el valor por debajo del cual se encuentra un porcentaje dado de observaciones. En general, el percentil <span class="math inline">\(k\)</span>-ésimo, que denotaremos por <span class="math inline">\(p_k\)</span>, es un valor para el cual un <span class="math inline">\(k\%\)</span> por ciento de las observaciones son menores que ella.</p>
<p>La definición anterior es un tanto vaga: ¿menor o igual?, ¿qué pasa si no hay valores que cumplan?, ¿qué pasa si hay varios? Se pueden adoptar varios criterios, todos los cuales arrojan resultados parecidos cuando se aplican con conjuntos grandes de observaciones.</p>
<p>Notar que, en general, <span class="math inline">\(p_{25} = q_1\)</span>, <span class="math inline">\(p_{50}\)</span> es la mediana y <span class="math inline">\(p_{75} = q_3\)</span>. Por ejemplo, si las observaciones (ordenadas de menor a mayor) son: <span class="math display">\[
43, 48, 50, 50, 52, 53, 56, 58, 59, 60, 62, 65, 66, 68, 70, 71, 74, 76, 78, 80,
\]</span> y exigimos que los percentiles sean observaciones y la definición es con “menor o igual”, tenemos: <span class="math display">\[
p_{10} = 48, \quad p_{25} = 52, \quad p_{50} = 60, \quad p_{75} = 68, \quad p_{100} = 76.
\]</span> En R no hay una distinción entre cuantiles y percentiles a nivel de comando. Ahora bien, para obtener los percentiles en la posición que nos interesan podemos hacer lo siguiente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">43</span>, <span class="dv">48</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">56</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">62</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">74</span>, <span class="dv">76</span>, <span class="dv">78</span>, <span class="dv">80</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos percentiles deseados</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos percentiles como observaciones (type = 1)</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>percentiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="at">probs =</span> p, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>p10   <span class="ot">&lt;-</span> percentiles[<span class="dv">1</span>]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>p25   <span class="ot">&lt;-</span> percentiles[<span class="dv">2</span>]</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>p50   <span class="ot">&lt;-</span> percentiles[<span class="dv">3</span>]</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>p75   <span class="ot">&lt;-</span> percentiles[<span class="dv">4</span>]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>p100  <span class="ot">&lt;-</span> percentiles[<span class="dv">5</span>]</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Para casen2022$ytrabajocor</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>x_casen <span class="ot">&lt;-</span> casen2022<span class="sc">$</span>ytrabajocor</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>percentiles_casen <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x_casen, <span class="at">probs =</span> p, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>p10_casen  <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">1</span>]</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>p25_casen  <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">2</span>]</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>p50_casen  <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">3</span>]</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>p75_casen  <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">4</span>]</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>p100_casen <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">5</span>]</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>percentiles</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  10%  25%  50%  75% 100% </span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   48   52   60   70   80</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>percentiles_casen</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="do">##      10%      25%      50%      75%     100% </span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="do">##   150000   337500   480000   763333 50966668</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="transformaciones-lineales-de-los-datos-descriptivos" class="level2">
<h2 class="anchored" data-anchor-id="transformaciones-lineales-de-los-datos-descriptivos">1.4. Transformaciones lineales de los datos descriptivos</h2>
<p>Una transformación lineal de un conjunto de datos es aquella en la que cada observación se multiplica por una constante y se le suma otra constante. Concretamente, dadas <span class="math inline">\(n\)</span> observaciones, <span class="math inline">\(x_1, x_2, \dots, x_n\)</span>, una transformación lineal de ellas está dada por <span class="math display">\[
ax_1 + b, ax_2 + b, \dots, ax_n + b,
\]</span> con <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> constantes cualesquiera.</p>
<p>De tal modo, las transformaciones lineales permiten transformar los datos de las estadísticas descriptivas transformadas linealmente con las estadísticas descriptivas originales. Un ejemplo de esto, podría ser la transformación de los datos de precios a los mismos precios en UF de algún día dado. Con ello, podríamos ver, e.g., el ingreso en pesos y queremos verlo en UF. De tal modo, podríamos comprar el ingreso original en pesos con el ingreso en UF sin distorsionar la proporción mediante esta multiplicación con constantes (ponderar en la misma cantidad básicamente). En nuestro ejemplo, de CLP <span class="math inline">\(\to\)</span> UF tendríamos que la constante <span class="math inline">\(a\)</span> sería el valor de la UF y la constante <span class="math inline">\(b\)</span> simplemente sería 0.</p>
<p>Lo que se sigue de esto, es determinar la relación entre las medidas que hemos visto hasta hora, en sus estadísticas descriptivas originales, y compararlas con sus respectivas transformaciones lineales.</p>
<ul>
<li><p>Si denotamos por <span class="math inline">\(\bar{x}\)</span> a la <em>media</em> de los valores de las observaciones originales y por <span class="math inline">\(\bar{x}_t\)</span> a la media de los datos después de aplicarles la transformación lineal, tenemos que <span class="math display">\[
\bar{x}_t = \frac{ax_1 + b + ax_2 + b + \dots + ax_n + b}{n} = a\bar{x} + b.
\]</span></p></li>
<li><p>Si denotamos por <span class="math inline">\(\hat{\sigma}^2\)</span> a la <em>varianza</em> de los valores de las observaciones originales y por <span class="math inline">\(\hat{\sigma}^2_t\)</span> a la varianza de los datos después de aplicarles la transformación lineal, tenemos que <span class="math display">\[
\hat{\sigma}^2_t = \frac{(ax_1 + b - \bar{x}_t)^2 + (ax_2 + b - \bar{x}_t)^2 + \dots + (ax_n + b - \bar{x}_t)^2}{n} = a^2 \hat{\sigma}^2.
\]</span></p></li>
<li><p>De modo que para el caso de la <em>desviación estándar</em>, tenemos que: <span class="math display">\[
\hat{\sigma}_t = |a| \hat{\sigma}.
\]</span></p></li>
<li><p>Si denotamos por <span class="math inline">\(\tilde{\tilde{x}}\)</span> a la <em>moda</em> de los valores originales y por <span class="math inline">\(\tilde{\tilde{x}}_t\)</span> a la moda de los datos transformados, tenemos que: <span class="math display">\[
\tilde{\tilde{x}}_t = a \tilde{\tilde{x}} + b.
\]</span></p></li>
<li><p>Si denotamos por <span class="math inline">\(y_1, y_2, \dots, y_n\)</span> a los <em>estadísticos de orden</em> de los valores originales de los datos, tenemos que los estadísticos de orden de los datos transformados linealmente están dados por <span class="math inline">\(a y_1 + b, a y_2 + b, \dots, a y_n + b\)</span> si <span class="math inline">\(a \geq 0\)</span>, o por <span class="math inline">\(a y_n + b, a y_{n-1} + b, \dots, a y_1 + b\)</span> si <span class="math inline">\(a &lt; 0\)</span>.</p></li>
<li><p>Si denotamos por <span class="math inline">\(\bar{x}\)</span> a la <em>mediana</em> de las observaciones originales y por <span class="math inline">\(\tilde{x}_t\)</span> a la mediana de los datos después de aplicarles la transformación lineal, tenemos que: <span class="math display">\[
\tilde{x}_t = a \tilde{x} + b.
\]</span></p></li>
<li><p>El rango de los datos transformados está dado por <span class="math inline">\(\left| a \right| (y_n - y_1)\)</span>.</p></li>
<li><p>El rango intercuartil de los datos después de aplicarles la transformación lineal está dado por <span class="math inline">\(\left| a \right| (q_3 - q_1)\)</span>, donde <span class="math inline">\(q_3\)</span> y <span class="math inline">\(q_1\)</span> son los cuartiles 3 y 1 de los datos originales, respectivamente.</p></li>
</ul>
</section>
</section>
<section id="estadística-descriptiva-y-visualización-de-los-datos" class="level1">
<h1>2. Estadística descriptiva y visualización de los datos</h1>
<p>La <strong>visualización de datos</strong> es otro paso importante en el <em>análisis exploratorio de datos</em> y, por tanto, para la <em>estadística descriptiva</em>. La <strong>visualización de datos</strong> es el proceso de resumir gráficamente la información, por lo que suelen ser fundamentales para las estadísticas descriptiva. Su utilidad radica en que nos ayuda a interpretar los datos disponibles y a detectar patrones, tendencias y anomalías en ellos. Además, la visualización de datos es una herramienta que nos permite comunicar claramente ideas complejas de una forma atractiva. Concretamente, el <strong>gráfico</strong> presenta lo que los números no pueden comunicar por sí mismos, y lo transmite de una manera visible y más fácil de asimilar y de recordar. Un <strong>(buen) gráfico</strong> vale más que mil palabras. Y el propósito principal de graficar los datos es <strong>comunicar</strong> información de los datos.</p>
<p>En R, existe el comando <code>plot()</code> en los paquetes bases. Pero se suele graficar con el paquete <code>ggplot2</code>. También hay paquetes basados en <code>ggplot2</code> pero que incorporan otro tipos de gramáticas, como <code>tidyplots</code> que se especializa en gráficos para artículos científicos. Por no ser un apunte sobre cómo usar paquetes, usaré <code>ggplot2</code>. También usaré <code>scales</code> que complementará <code>ggplot2</code> ajustando escalas. No obstante, ambos paquetes tienen múltiples páginas webs, tutoriales, etc., sobre cómo usarlos. También cargamos la CASEN 2022 nuevamente</p>
<section id="tipos-de-gráficos" class="level2">
<h2 class="anchored" data-anchor-id="tipos-de-gráficos">Tipos de gráficos</h2>
<p>La elección de la **visualización de datos* depende de varios elementos, pero principalmente de</p>
<ul>
<li><p>Qué tipo de variable se quiere investigar/presentar.</p></li>
<li><p>Lo que esperamos mostrar.</p></li>
</ul>
<p>Hay gráficos que son más adecuados para presentar ciertos tipos de datos, al igual que hay gráficos que no sirven para visualizar algunas variables según su naturaleza. Al mismo tiempo, dependerá de dónde y a quién se quiera presentar los gráficos. Dado que nuestra intención es <em>comunicar</em> información de los datos de manera gráfica, es importante tener en consideración si los gráficos se expondran en un artículo científico, una presentación en un congreso, en una afiche divulgativo, para una clase, etc. No obstante, aquí dejo una pauta general de qué gráficos usar según los tipos de variables y cuántas variables queramos comunicar.</p>
<ol type="1">
<li>Los <strong>gráficos univariados</strong>: muestran la distribución básica de una variable. Para ello utilizamos</li>
</ol>
<ol type="a">
<li>Gráficos de barras,</li>
<li>Histogramas y</li>
<li>Gráficos de caja (boxplots)</li>
</ol>
<ol start="2" type="1">
<li>Los <strong>gráficos bivariados</strong>: muestran cómo dos variables están <em>relacionadas</em> entre sí. Cuál usar depende del tipo de variables bajo análisis:</li>
</ol>
<ol type="a">
<li>Dos variables categóricas: gráficos de barras.</li>
<li>Una categórica y una cuantitativa: gráficos de cajas.</li>
<li>Dos variables cuantitativas: gráficos de dispersión de puntos.</li>
</ol>
<p>Veamos cómo graficar estos tipos de gráficos en R usando <code>ggplot2</code> y datos reales de la CASEN 2022.</p>
</section>
<section id="gráficos-univariados" class="level2">
<h2 class="anchored" data-anchor-id="gráficos-univariados">Gráficos univariados</h2>
<section id="gráficos-de-barras" class="level3">
<h3 class="anchored" data-anchor-id="gráficos-de-barras">Gráficos de barras</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vemos datos de nuestra variable de interés</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sjmisc<span class="sc">::</span><span class="fu">frq</span>(casen2022<span class="sc">$</span>sexo) <span class="co"># ups! no funciona en RMarkdown</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Sexo (x) &lt;numeric&gt; </span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # total N=202231 valid N=202231 mean=1.53 sd=0.50</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Value |     Label |      N | Raw % | Valid % | Cum. %</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------------------</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     1 | 1. Hombre |  95656 | 47.30 |   47.30 |  47.30</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="do">##     2 |  2. Mujer | 106575 | 52.70 |   52.70 | 100.00</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  &lt;NA&gt; |      &lt;NA&gt; |      0 |  0.00 |    &lt;NA&gt; |   &lt;NA&gt;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de barras de la variable sexo</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(casen2022, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(sexo, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)))) <span class="sc">+</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribución de la variable Sexo"</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-barplots-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Si queremos agregarle más colores<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, cambiar el tamaño de las letras, ponerle caption, etc., solo hay que usar comandos de <code>ggplot2</code> que sirvan para ello y seguir su gramática “en capas” adecuadamente</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de barras de la variable sexo más bonito</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(casen2022, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(sexo, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)), </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fill =</span> <span class="fu">factor</span>(sexo))) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#8F8F8F"</span>, <span class="st">"#8B0000"</span>)) <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribución de Sexo en CASEN 2022"</span>, </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Elaboración propia a partir de Encuesta CASEN 2022"</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-barplots2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Más allá de “enchular” el gráfico, lo importante es que el gráfico es más fácil de comprender rápidamente que una tabla de frecuencias, como vimos con <code>frq()</code>. Y cuando se agrega más categorías, facilita aún más. Por ejemplo, veamos Clasificación Internacional Normalizada de Educación (CINE-F). Para ello usaremos <code>cinef13_area</code> de la CASEN 2022, pero excluiremos las categorías sin datos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Exploramos nuestra variable de interés</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">frq</span>(casen2022<span class="sc">$</span>cinef13_area)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Clasificación Internacional Normalizada de Educación (CINE-F). Campo amplio (x) &lt;numeric&gt; </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # total N=202231 valid N=49628 mean=4.13 sd=6.48</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Value |                                                Label |      N | Raw %</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="do">## -----------------------------------------------------------------------------</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     1 |                                    Salud y Bienestar |   9383 |  4.64</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="do">##     2 |                 Ingeniería, Industria y Construcción |  10833 |  5.36</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="do">##     3 |                                            Educación |   7819 |  3.87</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="do">##     4 |                                            Servicios |   2806 |  1.39</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="do">##     5 |                 Administración de Empresas y Derecho |  10933 |  5.41</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="do">##     6 |          Ciencias Sociales, Periodismo e Información |   1917 |  0.95</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a><span class="do">##     7 |        Ciencias naturales, matemáticas y estadística |    654 |  0.32</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="do">##     8 |       Agricultura, Silvicultura, Pesca y Veterinaria |   1080 |  0.53</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="do">##     9 | Tecnología de la Información y la Comunicación (TIC) |   1843 |  0.91</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    10 |                                  Artes y Humanidades |   2107 |  1.04</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="do">##    11 |                        Doctorado en Ciencias Básicas |      0 |  0.00</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="do">##    88 |                                             Sin dato |    253 |  0.13</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  &lt;NA&gt; |                                                 &lt;NA&gt; | 152603 | 75.46</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Value | Valid % | Cum. %</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="do">## ------------------------</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="do">##     1 |   18.91 |  18.91</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="do">##     2 |   21.83 |  40.74</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="do">##     3 |   15.76 |  56.49</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a><span class="do">##     4 |    5.65 |  62.14</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="do">##     5 |   22.03 |  84.17</span></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="do">##     6 |    3.86 |  88.04</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a><span class="do">##     7 |    1.32 |  89.35</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a><span class="do">##     8 |    2.18 |  91.53</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a><span class="do">##     9 |    3.71 |  95.24</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a><span class="do">##    10 |    4.25 |  99.49</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="do">##    11 |    0.00 |  99.49</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a><span class="do">##    88 |    0.51 | 100.00</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a><span class="do">##  &lt;NA&gt; |    &lt;NA&gt; |   &lt;NA&gt;</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Como vemos Doctorado en Ciencias Básicas no tiene casos</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a><span class="co"># y Sin dato no nos interesa. Tampoco NA</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Usamos dplyr</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>area_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Salud y Bienestar"</span>,</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ingeniería, Industria y Construcción"</span>,</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Educación"</span>,</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Servicios"</span>,</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Administración de Empresas y Derecho"</span>,</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ciencias Sociales, Periodismo e Información"</span>,</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ciencias naturales, matemáticas y estadística"</span>,</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Agricultura, Silvicultura, Pesca y Veterinaria"</span>,</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tecnología de la Información y la Comunicación (TIC)"</span>,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Artes y Humanidades"</span></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a>df_area <span class="ot">&lt;-</span> casen2022 <span class="sc">|&gt;</span> </span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>cinef13_area <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">88</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cinef13_area) <span class="sc">|&gt;</span> </span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">factor</span>(cinef13_area, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">labels =</span> area_labels))</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_area, <span class="fu">aes</span>(<span class="at">x =</span> area, <span class="at">y =</span> n, <span class="at">fill =</span> area)) <span class="sc">+</span></span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Área CINE-F"</span>,</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribución de Áreas CINE-F (códigos 1–10)"</span></span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x    =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-barplots3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Esto es mucho más amable que una tabla en la que comparamos números, porque permite una comparación visual entre categorías. Entonces, la ganancia del gráfico de barra se da en la medida que haya más categorías a analizar.</p>
</section>
<section id="histogramas-y-kernels" class="level3">
<h3 class="anchored" data-anchor-id="histogramas-y-kernels">Histogramas (y kernels)</h3>
<p>Este tipo de visualizaciones es recomendable para resumir gráficamente la información de una <strong>variable cuantitativa</strong>. Un histograma muestra la distribución empírica de las observaciones de un variable cuantitativa. Muchas veces, por ejemplo, se usa para observar si una variable sigue o no una distribución normal.</p>
<p>En un histograma, la altura de cada barra representa cuántas observaciones en el conjunto de datos caen dentro de un cierto rango (intervalo) de la variable cuantitativa bajo análisis. Un elemento fundamental al momento de hacer un histograma es la definición del número de rangos (intervalos) de la variable cuantitativa que se considerarán para agrupar los datos. Si no se elige el número correcto (ancho adecuado) para dichos intervalos, se corre el riesgo de que el histograma no refleje las características esenciales del conjunto de datos, llevándonos a malinterpretar cómo se distribuyen las observaciones.</p>
<p>Veamos la distribución de los ingresos del trabajo en un histograma:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(casen2022, <span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"#4E79A7"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span> <span class="co"># para sacar notación científica</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Histograma de ytrabajocor"</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-histogram-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como se ve, la desigualdad de los ingresos nuevamente ataca. Al haber pocas personas con ingresos muy altos, y muchas personas con ingresos bajos, ni se alcanzan a ver las personas de ingresos altos. Ciertamente, esta forma de elefante dentro de una serpiente hacia un lado del gráfico es habitual verla en gráficos de distribución en los ingresos. Podemos para ver cómo varía esto, por ejemplo, usar percentiles, deciles, quintiles, etc., para filtar casos y observar la distribución empírica de los ingresos, e.g., para el 90% de los ingresos (excluyendo al 10% más alto):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor), dau <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"#4E79A7"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Histograma de ytrabajocor (deciles 1–9)"</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-histogram2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>¿Y si queremos, por ejemplo, para el 80%? Solo basta modificar <code>dau &lt; x</code> en el código, pues <code>dau</code> es la variable del Decil autónomo nacional dentro de la CASEN 2022.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor), dau <span class="sc">&lt;</span> <span class="dv">9</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"#4E79A7"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Histograma de ytrabajocor (deciles 1–8)"</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-histogram3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Algo que también se puede hacer, similar a los histogramas, es observar esto con <em>kernels</em>, que son como histogramas pero con densidad y continuos (no en barras). Esto se hace con <code>geom_density()</code>. Además, esto nos facilita (para visualizar la distribución empírica) ver nuestra variable de interés agrupada según otra variable que nos interese. Por ejemplo, podríamso ver el ingreso del trabajo según sexo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor), dau <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>,<span class="at">adjust =</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Distribución de ingreso de trabajo corregido por sexo"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Densidad"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill  =</span> <span class="st">"Sexo"</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text       =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-kernels-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Otra cosa que puede resultarnos util es ver donde está mediana en el gráfico. Aprovechamos de mostrar como se verían los gráficos ya no superpuestos, sino al lado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> casen2022 <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor), dau <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)))</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraemos medianas</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>medianas <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo) <span class="sc">|&gt;</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mediana =</span> <span class="fu">median</span>(ytrabajocor))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficamos </span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor, <span class="at">fill =</span> sexo, <span class="at">color =</span> sexo)) <span class="sc">+</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">adjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> medianas, <span class="fu">aes</span>(<span class="at">xintercept =</span> mediana, <span class="at">color =</span> sexo),</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sexo) <span class="sc">+</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span> <span class="ot">=</span> <span class="st">"#C51517"</span>, <span class="st">"Mujer"</span> <span class="ot">=</span> <span class="st">"#BAB3EB"</span>)) <span class="sc">+</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span> <span class="ot">=</span> <span class="st">"#9C0824"</span>, <span class="st">"Mujer"</span> <span class="ot">=</span> <span class="st">"#312271"</span>)) <span class="sc">+</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribución de ingreso de trabajo corregido por sexo"</span>,</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">""</span>,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill  =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Sexo"</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text       =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-kernels2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="gráfico-de-cajas-boxplots" class="level3">
<h3 class="anchored" data-anchor-id="gráfico-de-cajas-boxplots">Gráfico de cajas (boxplots)</h3>
<p>Cuando son gráficos univariados este tipo de visualizaciones tipo <em>boxplot</em> es recomendable para resumir gráficamente la información de una <strong>variable cuantitativa</strong> (continua o discreta). Un grafico de caja o <em>boxplot</em> muestra las <strong>características de la distribución</strong> de las observaciones de una variable cuantitativa: “mínimo”, primer cuartil (<span class="math inline">\(q_1\)</span>), mediana, tercer cuartil (<span class="math inline">\(q_3\)</span>), “máximo”. También etiqueta posibles valores atípicos como puntos separados en el gráfico. En un gráfico de caja, pues, se tiene que:</p>
<ul>
<li><p>El “mínimo” corresponde a <span class="math inline">\(q_1 - 1,5RIC\)</span> (no es el valor más pequeño entre las observaciones).</p></li>
<li><p>El “máximo” corresponde a <span class="math inline">\(q_3 + 1,5RIC\)</span> (no es el valor más grande entre las observaciones).</p></li>
</ul>
<p>En esta herramienta gráfica, las observaciones etiquetadas como posibles valores atípicos (<em>outliers</em>) son aquellas que se ubican fuera del intervalo dado por: <span class="math display">\[
[q_1 - 1,5RIC, q_3 + 1,5RIC]
\]</span></p>
<p>Veamos como hacer esto con <code>ggplot2</code>. Usaremos otra variable cuantitativa, y ya no ingresos del trabajo porque, dada su dispersión se verá así:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Para ingresos del trabajo</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(casen2022, <span class="fu">aes</span>(<span class="at">y =</span> ytrabajocor)) <span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#4E79A7"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Boxplot de ingreso de trabajo corregido"</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-boxplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Probemos con otra variable que sea interesante, por ejemplo con la varriable <code>tot_per_h</code> que registra el “Total de personas en el hogar” de los hogares encuestados por la CASEN</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Para Total de personas en el hogar</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(tot_per_h)) <span class="sc">|&gt;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_per_h)) <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#CAE1FF"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Total de personas en el hogar"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Boxplot de total de personas en el hogar"</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-boxplot2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La intepretación del boxplot, entonces, debe incluir lo siguiente:</p>
<ul>
<li><p>La mediana está en 3 miembros, lo que indica que la mitad de los hogares tiene 3 o menos personas y la otra mitad 3 o más.</p></li>
<li><p>El primer cuartil (<span class="math inline">\(Q1\)</span>) se sitúa en 2 personas y el tercer cuartil (<span class="math inline">\(Q3\)</span>) en 4 personas. Esto nos dice que el 50% central de los hogares (entre <span class="math inline">\(Q1\)</span> y <span class="math inline">\(Q3\)</span>) agrupa tamaños de 2 a 4 miembros.</p></li>
<li><p>El rango intercuartílico (<span class="math inline">\(RIC = Q3 – Q1\)</span>) es 2 personas, reflejando una variabilidad moderada en el tamaño típico de los hogares.</p></li>
<li><p>Los “bigotes” se extienden desde 1 hasta 7 miembros aproximadamente, marcando los límites dentro de <span class="math inline">\(1,5·RIC\)</span>.</p></li>
<li><p>Más allá de 7 personas aparecen puntos aislados (<em>outliers</em>), correspondientes a hogares muy numerosos (8 a 13 personas), que representan casos excepcionales en la distribución.</p></li>
</ul>
<p>En conjunto, el gráfico revela que la mayoría de los hogares chilenos encuestados están compuestos por entre 2 y 4 personas, con un hogar típico de 3 miembros, y que los tamaños extremos (hogares muy grandes) son poco frecuentes.</p>
</section>
</section>
<section id="gráficos-bivariados" class="level2">
<h2 class="anchored" data-anchor-id="gráficos-bivariados">Gráficos bivariados</h2>
<section id="gráficos-de-barras-de-dos-variables" class="level3">
<h3 class="anchored" data-anchor-id="gráficos-de-barras-de-dos-variables">Gráficos de barras de dos variables</h3>
<p>Esta visualización es recomendable para resumir gráficamente la información sobre la relación entre <strong>dos variables categóricas</strong>. Específicamente, este gráfico destaca cómo una variable categórica puede diferir entre las categorías de otra variable categórica. Por ejemplo, podríamos mostrar cómo la matrícula en la educación superior difiere por género.</p>
<p>Para ello, tomaré la variable <code>e6a_asiste</code> que responde a la pregunta ¿Cuál es el nivel educacional al que asiste?, dado que supone que asiste, al momento de ser encuestado/a, a un establecimiento educacional o no. En este caso, solo tomaremos la categoría <code>13</code> que es “13. Profesional (Carreras 4 o más años)”. Aunque no es una variable sobre la matricula como tal, es un buen <em>proxy</em><a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos un df ad hoc</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>df_asiste_prof <span class="ot">&lt;-</span> casen2022 <span class="sc">|&gt;</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(e6a_asiste <span class="sc">==</span> <span class="dv">13</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sexo) <span class="sc">|&gt;</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ploteamos</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_asiste_prof, <span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> n, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Número de estudiantes en carreras profesionales (4+ años)"</span>,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Asistencia a la universidad (Profesional) por sexo"</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-barplot-bivariado-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplots-bivariados" class="level3">
<h3 class="anchored" data-anchor-id="boxplots-bivariados">Boxplots bivariados</h3>
<p>Este tipo de visualización es recomendable para resumir gráficamente la información de la relación entre una <em>variable categórica</em> y una <em>variable cuantitativa</em>. Concretamente, se visualizan los gráficos de cajas para una variable cuantitativa, separados para cada valor posible de una variable categórica. Por lo tanto, permite ver cómo la variable cuantitativa se distribuye dentro de cada valor de una variable categórica.</p>
<p>Para ello, podríamos ver el ingreso del trabajo (variable continua) por sexo (categórica). Pero, como ya vimos, los boxplots con variables con <em>tanta dispersión</em>, se ven feos y <em>comunican</em> mal. Ahora bien, algo que es recomendable para comprimir la escala y reducir la asimetría entre los valores para variables con mucha dispersión es aplicarle un logaritmo a la variable de interés. De hecho, esto es algo que se hace bastante con el ingreso. No me interesa profundizar en esto ahora, porque es algo que trateremos cuando lleguemos a regresiones. No obstante, si es de interés, en este punto, el capítulo 2 de <span class="citation" data-cites="masteringmetrics">@masteringmetrics</span> ofrece una explicación didáctica y profunda. Además, en el apéndice de dicho capítulo, específicamente en el apartado “<em>Building Models with Logs</em>” o “Modelos logarítmicos” –en la traducción del libro–, se profundiza específicamente en la utilidad de aplicar logaritmos a variables como el ingreso.</p>
<p>Veamos cómo queda el gráfico, que además <code>ggplot2</code> tiene funciones para realizar transformaciones logarítmicas de las varaibles sin hacer recodificación previa. Primero lo hago con codificación previa (“manual”) y luego en ggplot mismo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor)) <span class="sc">|&gt;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">sexo        =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_ingreso =</span> <span class="fu">log</span>(ytrabajocor) <span class="co"># transformación manual</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> log_ingreso, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">name   =</span> <span class="st">"Log(Ingreso de trabajo corregido)"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> comma</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Boxplot de ingreso de trabajo corregido (log) por sexo"</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-boxplot-bivariado-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Transformación logaritmica dentro de ggplot2</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor)) <span class="sc">|&gt;</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> ytrabajocor, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Ingreso de trabajo corregido (escala log)"</span>,</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Boxplot de ingreso de trabajo corregido por sexo (escala log)"</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-boxplot-bivariado-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como se puede observar, la comparación de ambos <em>boxplots</em> deja claro que, al final, la forma de la distribución (posición de cuartiles, mediana y “bigotes”) es exactamente la misma: la transformación logarítmica sólo reescala los datos de manera monotónica, sin alterar su orden ni la detección de <em>outliers</em>. De modo general, sobre los gráficos podemos decir:</p>
<ul>
<li><p>La mediana del ingreso de los hombres está algo por encima de la de las mujeres, lo cual se ve en ambos casos.</p></li>
<li><p>El rango intercuartílico (caja) es ligeramente más amplio en los hombres, indicando mayor dispersión en el 50 % central.</p></li>
<li><p>Aparecen outliers en ambos sexos, sobre todo hacia los ingresos muy bajos y muy altos, que quedan marcados como puntos fuera de los “bigotes”.</p></li>
</ul>
<p>Respecto a las diferencias gráficas según transformación logarítmica “manual” o <em>en</em> el código de <code>ggplot2</code>:</p>
<ol type="1">
<li><strong>Boxplot con transformación manual</strong> (<code>log_ingreso</code>):</li>
</ol>
<ul>
<li>En el eje Y leemos directamente la escala de log(ingreso). Por ejemplo, una mediana alrededor de 12,4 en hombres equivale a un ingreso de $e^{12,4} ,4 ^5 $, es decir, 240.000 pesos</li>
<li>Es útil si nuestro interés está en trabajar explícitamente con valores logarítmicos (p.&nbsp;ej. para comparar diferencias porcentuales, como veremos después).</li>
</ul>
<ol start="2" type="1">
<li><strong>Boxplot con ggplot2</strong> (<code>scale_y_log10()</code>):</li>
</ol>
<ul>
<li>Aquí el eje Y muestra los valores de ingreso en pesos, pero “espaciados” según su logaritmo. La mediana se lee directamente en unidades monetarias (p.&nbsp;ej. 200.00 vs 180.000), lo que facilita la interpretación sin cálculo inverso.</li>
<li>Conserva el lenguaje natural de las unidades en el gráfico (no aparecen logaritmos ni ejes en valores crudos de log), pero controla la asimetría y comprime los outliers en una visual más manejable.</li>
</ul>
<p>En resumen, ambas aproximaciones equivalen en términos estadísticos. La elección depende de si quieres presentar valores ya en escala log (transformación manual) o prefieres mantener el eje en la unidad original (pesos) pero con la ventaja visual de una escala logarítmica que ofrece el paquete (<code>scale_y_log10()</code>).</p>
</section>
<section id="gráficos-de-dispresión-de-puntos-scatter-plots" class="level3">
<h3 class="anchored" data-anchor-id="gráficos-de-dispresión-de-puntos-scatter-plots">Gráficos de dispresión de puntos (<em>scatter plots</em>)</h3>
<p>Este tipo de gráficos es recomendable para resumir gráficamente la información de <strong>la <em>asociación</em> de dos variables cuantitativas</strong>. Un gráfico de dispersión muestra cada observación como un punto en un sistema de coordenadas para dos variables cuantitativas. Por ejemplo, podríamos graficar la relación entre el ingreso del trabajo y los años de escolaridad.</p>
<p>Ahora bien, un problema común que surge en los gráficos de dispersión es cuando los datos de muchas observaciones se intentan presentar en sólo una figura. En nuestro ejemplo, contamos con la información de más de 200.000 encuestados. En estos casos, es recomendable procesar antes los datos. Se pueden hacer varias cosas. Podrían crearse rangos de ingresos, por ejemplo, o tomar quintiles, deciles, etc., de ingresos. O bien, también podríamos aplicar una transformación logarítmica en los datos como hicimos anteriormente.</p>
<p>Podemos hacer ambas, pero la verdad es que dependerá mucho de la variable cuál es mejor. Por ejemplo, si estuvieramos viendo puntajes PSU de Matemáticas y a su asociación al Ranking, sería útil hacer grupos. Pero para ingresos no funciona mucho esto. En las clases Estadística I de Engel y Díaz de la FEN se pasa el primer ejemplo. Se presentan primero sin agrupar y luego agrupando:</p>
<p><img src="images-sesiones/grafico de dispersión sin procesar.png" alt="Datos sin agrupar" style="display: block; margin: auto;"></p>
<p><img src="images-sesiones/grafico de dispersion de puntos procesado.png" alt="Datos ya agrupados" style="display: block; margin: auto;"></p>
<p>Ahora bien, veamos cómo quedaría con ingreso esto. Primero tomaremos los déciles, registrados por la casen en <code>dau</code> (Decil autónomo nacional) que se calculan tomando todos los ingresos del hogar (o sea, ya no ingresos del trabajo de los encuestados encuestado) y se dividen, siguiendo la lógica explicada en las <em>medidas de posición</em>, en 10 grupos. En este caso, el grupo 1 es el grupo de ingresos más bajos (el 10% más pobre) y el 10 es el de ingresos más altos (el 10% más rico). Luego, para ver si es un problema de que sean pocos grupos, lo haremos para percentiles (100 grupos). Para la otra variable, en ambos casos, usaremos <code>esc</code> que mide los años de escolaridad (solo personas de 15 años en adelante) como variable cuantitativa discreta.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Scatter: escolaridad vs decil de ingreso del hogar</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(esc), dau <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> esc, <span class="at">y =</span> dau)) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"#4E79A7"</span>) <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Años de escolaridad"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Decil autónomo nacional"</span>,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Dispersión: Escolaridad vs Decil de ingreso del hogar"</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/scatter-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Agrupar ingreso autónomo del hogar en 100 percentiles y graficar</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(esc), <span class="sc">!</span><span class="fu">is.na</span>(yautcorh)) <span class="sc">|&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentil =</span> <span class="fu">ntile</span>(yautcorh, <span class="dv">100</span>)) <span class="sc">|&gt;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> esc, <span class="at">y =</span> percentil)) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"#4E79A7"</span>) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Años de escolaridad"</span>,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Percentil de ingreso autónomo del hogar"</span>,</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Dispersión: Escolaridad vs Percentiles de ingreso"</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/scatter-plot-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora bien, en ninguno de los casos se ve bien. Esto es por dos motivos: 1) ambas variables son discretas con muy pocos valores únicos (<code>esc</code> y <code>dau</code>). Pero, incluso si aumentamos a 100 grupos, y ya no usamos <code>dau</code>, tampoco funciona. En realidad, esto nuevamente se debe a la naturaleza de la variable ingreso, que es continua y tiene un rango muy alto. 2) Esto último produce lo que se conoce como <em>overplotting</em>, que en nuestro caso, con más de 200.000 observaciones, incluso un pequeño desplazamiento de jitter deja millones de puntos amontonados, de modo que no se distingue ninguna tendencia ni densidad real.</p>
<p>Entonces, para lo que queremos graficar, en este caso, ingresos y su asociación son el nivel de escolaridad, no nos sirve tomar dos variables discretas, aunque sean cuantitativas ambas. Probemos, entonces, si el viejo logaritmo nos ayuda en este caso.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(esc), <span class="sc">!</span><span class="fu">is.na</span>(yautcorh)) <span class="sc">|&gt;</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> esc, <span class="at">y =</span> yautcorh)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#ADD8E6"</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Años de escolaridad"</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Ingreso autónomo corregido (escala log)"</span>,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Dispersión: Escolaridad vs Ingreso (log)"</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/scatter-plot2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como se ve, ahora si el gráfico nos comunica algo más comprensible. Además, se puede ver cómo va reduciendo la dispersión en cuanto avanzan los años de escolaridad. Es importante resaltar la cantidad de <em>outliers</em> que hay que notienen ingresos autónomos, aún avancen los años de escolaridad. Esto también puede tener que ver con que estamos usando ingresos autónomos del hogar y no de los individuos. Pero, a saber. No voy a profundizar en esto ahora.</p>
<p>Lo que si me parece más interesante ahora es adelantar algo bacán que se puede hacer con <code>ggplot2</code> y los <em>scatterplots</em>. Esta tendencia que vemos en los datos, también podemos inmediatamente modelarla. El paquete permite, al graficar la dispersión de los datos, trazar una linea de tendencia con bandas de error estándar mediante un modelo lineal. Como ya advertimos antes, ahora es aún más útil aplicar <code>log()</code>, porque dado que los ingresos no se comportan con una distribución normal, transformamos el eje x (<code>yautcorh</code>) de una escala linear a una escala logarítmica. Esto nos permitirá un mejor ajuste de la línea de regresión estimada. Luego, cuando lleguemos a regresiones, veremos la utilidad de esto, como ya he ido adelantando. También podemos ajustar los valores de ingres a una notación mas adecuada, en este caso, pesos chilenos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Scatter plot con línea de regresión</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  casen2022 <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(esc), <span class="sc">!</span><span class="fu">is.na</span>(yautcorh)),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> esc, <span class="at">y =</span> yautcorh)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"#36648B"</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"gam"</span>,</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">se     =</span> <span class="cn">TRUE</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="st">"#8B0000"</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill   =</span> <span class="st">"#696969"</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">size   =</span> <span class="dv">1</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>(<span class="at">prefix =</span> <span class="st">"$"</span>, <span class="at">suffix =</span> <span class="st">" CLP"</span>)) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Años de escolaridad"</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Ingreso autónomo corregido del hogar"</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nivel de ingreso autónomo corregido según años de escolaridad"</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/scatter-plot-regresion-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Entonces, y ahora sí, el gráfico muestra, en escala logarítmica, cómo varía el ingreso autónomo corregido del hogar según los años de escolaridad (para personas de 15 años en adelante). De este <em>scatter plot</em> se puede interpretar que hay</p>
<ol type="1">
<li><p><strong>Tendencia creciente</strong>. La línea de tendencia sube de izquierda a derecha, lo que indica que a más años de escolaridad corresponde, en promedio, un ingreso mayor;</p></li>
<li><p>No obstante, existen <strong>rendimientos decrecientes</strong>. La pendiente es más pronunciada en los primeros años de escolaridad y se aplana conforme avanzamos hacia niveles superiores, sugiriendo que cada año adicional de educación añade menos aumento porcentual al ingreso que el año anterior.</p></li>
<li><p><strong>Alta dispersión</strong>. A cualquier nivel de escolaridad hay una enorme variabilidad de ingresos (nubes de puntos muy extendidas). Esto refleja que, aunque el promedio sube con la educación, los ingresos individuales probablemente dependen también de otros factores (sector, experiencia, género, etc., a saber).</p></li>
<li><p>Respecto a la <strong>confianza de la curva</strong>, se puede observar que la banda gris alrededor de la línea es más estrecha en los niveles de escolaridad donde hay más observaciones (por ejemplo entre 8 y 12 años) y más ancha en los extremos (muy poca gente con 0 ó &gt;20 años), lo que nos habla de mayor incertidumbre al estimar la relación fuera del rango central.</p></li>
</ol>
<p>En suma, el gráfico confirma una asociación positiva entre educación e ingreso, con incrementos relativos mayores al inicio de la escolaridad y un efecto suavemente decreciente en los niveles más altos.</p>
<p>Finalmente, respecto a los gráficos de tipo <em>scatter plot</em>, hay que tener ojo qué tipo de variables vamos a visualizar. No basta con asociar dos variables cuantitativas, sino que también hay que fijarse en si son discretas, continuas, en la cantidad de observaciones, etc.; en definitiva, en la naturaleza de las variables asociadas. A menudo, tendremos que realizar transformaciones a nuestras variables para que el gráfico <strong>comunique mejor</strong> el carácter de la asociación de las variables de interés.</p>
</section>
</section>
<section id="estadística-inferencial" class="level2">
<h2 class="anchored" data-anchor-id="estadística-inferencial">3. Estadística inferencial</h2>
<p>Retomemos algunas cosas y veamos algunas cosas con las que deberíamos haber comenzado todo, pero que por cuestiones del curso no alcanzan. Partamos por qué es una <em>variable aleatoria</em>.</p>
<section id="variables-aleatorias-funciones-y-distribución-de-probabilidad" class="level3">
<h3 class="anchored" data-anchor-id="variables-aleatorias-funciones-y-distribución-de-probabilidad">Variables aleatorias: funciones y distribución de probabilidad</h3>
<p>La probabilidad es una medida que nos entrega un grado de <em>certidumbre</em> de que ocurra un evento <em>incierto</em>. La teoría de la probabilidad es la base de toda estadístíca y, por tanto, de la econometría. Y la base de la probabilidad es la teoría de conjuntos y la matemática. Teníamos que la probabilidad intenta <em>asignar</em> a cada evento de un experimento un valor <span class="math inline">\((\in \mathbb{R})\)</span> para capturar la frecuencia del evento si el experiemento fuese repetido muchas veces. De ello, deducimos los axiomas de la probabilidad y otras propiedades que eran consecuencias de ellos. Finalmente, examinamos los tipos de probabilidades (conjunta, margianl y condicional), poniendo un énfasis especial en la probabilidad condicional y la independencia estadística entre eventos. Con todo eso, veamos qué es una variable aleatoria.</p>
<p>Una variable aleatoria es “una función de valor real para la cual el dominio es un espacio muestral” (<a href="https://www.cimat.mx/ciencia_para_jovenes/bachillerato/libros/%5BWackerly,Mendenhall,Scheaffer%5DEstadistica_Matematica_con_Aplicaciones.pdf">Wackerly, et al., 2010, p.&nbsp;76</a>). Una variable aleatoria (v.a.), así, toma valores que son determinados por un proceso aleatorio, que muchas veces puede ser un proceso natural estocástico.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>. De tal modo, una v.a. no es más que una representación numérica de los resultados potenciales de un experimento. Formalmente,</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sea <span class="math inline">\(\mbox{S}\)</span> el espacio muestral de un experimento. Una función de valor real definida en <span class="math inline">\(\mbox{S}\)</span> se denomina <em>variable aleatoria</em> (DeGroot y Schervish, 2014, p.&nbsp;93)</p>
</div>
</div>
<p>De tal modo, dado que una variable aleatoria es un resumen numérico de algún resultado de interés. Y que, formalmente, es una función que asocia un número real a cada elemento de <span class="math inline">\(\mbox{S}\)</span>, podemos representarla matemáticamente como <span class="math display">\[
\begin{aligned}
    X&amp;:\mbox{S} \longrightarrow \mathbb{R}\\
    &amp;u \longrightarrow X(u).
\end{aligned}
\]</span> Por ejemplo, imaginemos que lanzamos una moneda 2 veces, tal que su espacio muestral es <span class="math inline">\(S = \{cc, cs, sc, ss\}\)</span>. Definimos, pues, la variable aleatoria <span class="math inline">\(X\)</span> que es el número de caras en los dos lanzamientos. <span class="math display">\[
\begin{aligned}
    X(cc) &amp;= 2 \\
    X(cs) &amp;= 1 \\
    X(sc) &amp;= 1 \\
    X(ss) &amp;= 0
\end{aligned}
\]</span> En el fondo, para cada caso que saliera cara, <span class="math inline">\(c\)</span>, la función arrojaba cuántos <span class="math inline">\(c\)</span> hay en el espacio muestral en función de cómo la evaluáramos. Por ende, <span class="math inline">\(X\)</span> puede tomar los valores 0, 1 y 2, solamente. En efecto, la principal virtud de las variables aleatorias es que nos permiten describir eventos de forma sencilla. Tomando el caso anterior,</p>
<ul>
<li><p><span class="math inline">\(\{X = 0\} \iff\)</span> Todos los elementos en <span class="math inline">\(S\)</span> que no tienen caras = <span class="math inline">\(\{ss\}\)</span>. Por lo tanto, <span class="math display">\[
  \Pr(X = 0) = \Pr(\{ss\}) = \frac{1}{4}.
\]</span></p></li>
<li><p><span class="math inline">\(\{X = 1\} \iff\)</span> Todos los elementos en <span class="math inline">\(S\)</span> que tienen una cara = <span class="math inline">\(\{cs, sc\}\)</span>. Por lo tanto, <span class="math display">\[
\Pr(X = 1) = \Pr(\{cs, sc\}) = \frac{1}{4} + \frac{1}{4} = \frac{1}{2}.
\]</span></p></li>
<li><p><span class="math inline">\(\{X = 2\} \iff\)</span> Todos los elementos en <span class="math inline">\(S\)</span> que tienen dos caras = <span class="math inline">\(\{cc\}\)</span>. Por lo tanto, <span class="math display">\[
\Pr(X = 2) = \Pr(\{cc\}) = \frac{1}{4}.
\]</span></p></li>
</ul>
<p>Ahora bien, a partir de un espacio muestral podemos crear diversas variables aleatorias. En el ejemplo anterior creamos el número de caras, pero también podemos denotar por <span class="math inline">\(Y\)</span> la v.a. que cuenta el número de sellos. <span class="math display">\[
\begin{aligned}
Y(cc) &amp;= 0 \\
Y(cs) &amp;= 1 \\
Y(sc) &amp;= 1 \\
Y(ss) &amp;= 2
\end{aligned}
\]</span> A partir de un espacio muestral podemos crear diversas variables aleatorias. En el ejemplo anterior creamos el número de caras, pero también podemos denotar por <span class="math inline">\(Y\)</span> la v.a. que cuenta el número de sellos. Finalmente, notemos que por definición <span class="math display">\[
X + Y = 2.
\]</span> #### Tipos de variables aleatorias y distribuciones de probabilidad asociada</p>
<p>Quizás como ya podrían intuir, hay dos grandes grupos de variables aleatorias: las discretas y las continuas. En este curso, no profundizaremos en esto, pero si mencionaremos brevemente algunas cuestiones importantes antes de llegar al estadística inferencial.</p>
<section id="variables-aleatorias-discretas" class="level4">
<h4 class="anchored" data-anchor-id="variables-aleatorias-discretas">Variables aleatorias discretas</h4>
<p>Una variable aleatoria discreta es aquella que toma un número finito o numerable de valores. Por ejemplo, el el resultado de lanzar un dado. Formalmente, diremos que</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Una v.a. <span class="math inline">\(X\)</span> es si existe un conjunto finito <span class="math inline">\(A = \{a_1, a_2, ..., a_n\}\)</span> tal que <span class="math display">\[
\Pr(X \text{ toma valores en } A) = 1.
\]</span></p>
</div>
</div>
<p>Tenemos, entonces, que la variable aleatoria captura la información contenida en todo el espacio muestral del experimento en una cantidad numérica. Ahora bien, el valor del experimento, por definición, no se conoce, dada su naturaleza aleatoria. Lo que conocemos, en cambio, es <span class="math inline">\(\mathbb{S}\)</span>. Es decir, que conocemos todos los resultados potenciales del experimento aleatorio. Del lanzamiento de un dado, no sabemos qué va salir exactamente, pero sí sabemos que solo puede salir entre 1 y 6. No puede salir 7, ni Spiderman, ni Conchalí. Porque esos son valores que no pertenecen a <span class="math inline">\(\mathbb{S}\)</span>. Entonces, tenemos que volver ahora al concepto de función de probabilidad, incorporando este nuevo conocimiento.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consideremos una v.a. discreta <span class="math inline">\(X\)</span> definida sobre un espacio muestral <span class="math inline">\(\mathbb{S}\)</span>. Entonces la <strong>función de probabilidad</strong> (f.p.) de <span class="math inline">\(X\)</span> se define como: <span class="math display">\[
f(x) = \Pr(X = x).
\]</span></p>
</div>
</div>
<p>La expresión <span class="math inline">\(f(x) = \Pr(X = x)\)</span> nos dice que la fdp de <span class="math inline">\(X\)</span> evaluada en un valor particular de <span class="math inline">\(x\)</span> se corresponde con la probabilidad de que la v.a. <span class="math inline">\(X\)</span> tome algún valor de <span class="math inline">\(x\)</span>. Es decir, que <span class="math inline">\(X\)</span> corresponde a la v.a., mientras que <span class="math inline">\(x\)</span> corresponde algún valor particular de <span class="math inline">\(X\)</span>. Además, se tiene que <span class="math inline">\(f(x)&gt;0\)</span>, i.e., es estrictamente positivo para <span class="math inline">\(x\)</span> en el soporte de <span class="math inline">\(X\)</span> y <span class="math inline">\(f(x)=0\)</span>, i.e., vale 0 cualquier otro caso, o sea, en caso contrario.</p>
<p>Por ejemplo, si se lanza una moneda honesta 2 veces. Entonces</p>
<ul>
<li><p>Variable aleatoria <span class="math inline">\(X\)</span>: número de caras en los 2 lanzamientos.</p></li>
<li><p>Variable aleatoria <span class="math inline">\(Y\)</span>: número de sellos en los 2 lanzamientos.</p></li>
</ul>
<p>¿Cuál es la f.p. de <span class="math inline">\(X\)</span>? Ya deberíamos saber que <span class="math display">\[
f(0) = \frac{1}{4}, \quad f(1) = \frac{1}{2}, \quad f(2) = \frac{1}{4}, \quad f(x) = 0 \quad \text{para cualquier otro valor de } x.
\]</span> pero ahora además le agregamos que <span class="math inline">\(f(x)=0\)</span> es cualquier otro valor. ¿Y cuál es la f.p. de <span class="math inline">\(Y\)</span>? Por simetría, ya veíamos que era exactamente la misma probabilidad que la f.p. de <span class="math inline">\(X\)</span>. Ahora bien, a pesar de que <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> tienen la misma <strong>función de probabilidad</strong>, <em>no</em> son la misma v.a. Por ejemplo, cuando salen 2 caras, tenemos que <span class="math inline">\(X(cc)=2\)</span> e <span class="math inline">\(Y(cc)=0\)</span>. Veamos ejemplos de variables aleatorias discretas y sus distribuciones de probabilidad.</p>
<section id="distribución-uniforme-discreta" class="level5">
<h5 class="anchored" data-anchor-id="distribución-uniforme-discreta">Distribución uniforme discreta</h5>
<p>Una distribución uniforme discreta (UD) corresponde a una función de probabilidad donde todos los eventos tienen la misma probabilidad, como el lanzamiento de un dado. Si se tiene que <span class="math inline">\(m\)</span> y <span class="math inline">\(n\)</span> son números enteros tales que <span class="math inline">\(m \leq n\)</span>, que <span class="math inline">\(X\)</span> es una v.a. discreta, <span class="math inline">\(X\)</span> tendrá una distribución uniforme discreta entre los eventos <span class="math inline">\(m\)</span> y <span class="math inline">\(n\)</span>, o <span class="math inline">\(X\sim UD(m,n)\)</span> si se cumple que <span class="math display">\[
f(x) =
\begin{cases}
\frac{1}{n-m+1} &amp; x=m, m+1, \ldots, n\\
0 &amp; \text{en caso contrario}
\end{cases}
\]</span> Notemos, además, que la distribución de probabilidad de una v.a. discreta suma 1.</p>
</section>
<section id="distribución-de-bernoulli" class="level5">
<h5 class="anchored" data-anchor-id="distribución-de-bernoulli">Distribución de Bernoulli</h5>
<p>Una variable aleatoria <span class="math inline">\(X\)</span> sigue una <strong>distribución de Bernoulli</strong> si solo toma dos valores, específicamente <span class="math inline">\(0\)</span> o <span class="math inline">\(1\)</span>. Es decir que <span class="math inline">\(X\)</span> sigue una distribución de Bernoulli de parámetro <span class="math inline">\(p\in [0,1]\)</span> si <span class="math inline">\(X\)</span> toma valores <span class="math inline">\(0\)</span> o <span class="math inline">\(1\)</span> y si <span class="math inline">\(\Pr(X=1)=p\)</span>. Esto lo denotamos como <span class="math inline">\(X\sim \mbox{Bern}(p)\)</span></p>
<p>Entonces, si <span class="math inline">\(X \sim \mbox{Bern}(p)\)</span> la función de probabilidad, denotada por <span class="math inline">\(f(x)\)</span> es <span class="math display">\[
f(x) =
\begin{cases}
    p &amp; \text{si } x = 1, \\
    1 - p &amp; \text{si } x = 0, \\
    0 &amp; \text{si } x \notin \{0, 1\}
\end{cases}
\]</span> Es habitual para experimentos con solo dos resultados posibles que se interpreten los dos resultados posibles como éxito y fracaso, i.e., <span class="math inline">\(X=1\)</span> es considerado como éxito y <span class="math inline">\(X=0\)</span> como fracaso. Por ejemplo, si al lanzar una moneda, definimos <span class="math inline">\(X\)</span> según: si sale cara, <span class="math inline">\(X = 1\)</span>; y si sale sello, <span class="math inline">\(X = 0\)</span>. Entonces, <span class="math display">\[
p = \frac{1}{2}, \quad X \sim \text{Ber}(0,5).
\]</span></p>
</section>
<section id="distribución-binomial-ensayos-de-bernoulli-y-coeficiente-binomial" class="level5">
<h5 class="anchored" data-anchor-id="distribución-binomial-ensayos-de-bernoulli-y-coeficiente-binomial">Distribución Binomial: Ensayos de Bernoulli y coeficiente binomial</h5>
<p>Antes de ver distribución binomial, conviene ver un concepto previo, los famosos “<strong>Ensayos de Bernoulli</strong>”. Una <em>secuencia de ensayos de Bernoulli</em> es una secuencia <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> de variables aleatorias independientes con distribución común <span class="math inline">\(\mbox{Bern}(p)\)</span>, donde <span class="math inline">\(0 \leq p \leq 1\)</span>. Es decir, una secuencia de <span class="math inline">\(n\)</span> ensayos de Bernoulli es una secuencia de ensayos que cumple lo siguiente:</p>
<ol type="1">
<li><p>Solo dos resultados posibles en cada ensayo: 1 (éxito) y 0 (fracaso).</p></li>
<li><p>Ensayos <em>independientes</em>.</p></li>
<li><p>La misma probabilidad de éxito en cada ensayo.</p></li>
</ol>
<p>De tal modo, formalizando, diremos que una <strong>secuencia de ensayos de Bernoulli</strong> es una seguidilla de variables aleatorias independientes, tal que <span class="math display">\[
X_1 \sim \mbox{Bern}(p), X_2 \sim \mbox{Bern}(p), \ldots , X_n \sim \mbox{Bern}(p)
\]</span> donde <span class="math inline">\(0\leq p \leq 1\)</span>. En otras palabras, una secuencia de <span class="math inline">\(n\)</span> ensayos de Bernoulli cumple co que se realizan <span class="math inline">\(n\)</span> experimentos donde hay dos resultados posibles (éxito o fracaso, 1 o 0), que son independientes y donde la probabilidad de éxito es la misma para cada ensayo. Ahora bien, cuando hablemos de la <em>distribución</em> de una secuencia de <span class="math inline">\(n\)</span> ensayos de Bernoullli con parámetro <span class="math inline">\(p\)</span> o probabilidad de éxito <span class="math inline">\(p\)</span>, estamos hablando de una <strong>distribución binomial</strong>.</p>
<p>Una variable aleatoria <span class="math inline">\(X\)</span> sigue una <strong>distribución binomial</strong> con parámetros <span class="math inline">\(n\)</span> y <span class="math inline">\(p\)</span> si <span class="math inline">\(X\)</span> tiene una distribución discreta con función de probabilidad: <span class="math display">\[
f(x) =
\begin{cases}
\binom{n}{x} p^x (1-p)^{n-x} &amp; \text{para } x = 0, 1, 2, \dots, n, \\
0 &amp; \text{si no.}
\end{cases}
\]</span> El parámetro <span class="math inline">\(n\)</span> es un entero mayor o igual que uno, mientras que <span class="math inline">\(p\)</span> pertenece al intervalo <span class="math inline">\(\{0,1\}\)</span>. Escribimos <span class="math inline">\(X \sim \text{Bin}(n, p)\)</span> y decimos “<strong><span class="math inline">\(X\)</span> sigue una Binomial con parámetros <span class="math inline">\(n\)</span> y <span class="math inline">\(p\)</span></strong>”.</p>
<p>Algo que se suele ver en conteo y combinatoria, y que no incluyo en este apunte, es el <strong>coeficiente binomial</strong>. Este se escribe como <span class="math display">\[
\binom{n}{x} = \frac{n!}{x!(n-x)!}
\]</span> y en combinatoria representa el número de formas de escoger (sin importar el orden) un subconjunto de <span class="math inline">\(x\)</span> objetos extraídos de un conjunto de <span class="math inline">\(n\)</span> objetos distintos. Por ejemplo, si se tiene <span class="math inline">\(n=5\)</span> frutas distintas y queremos saber de cuántas maneras puede elegir <span class="math inline">\(x=2\)</span> de ellas, se hace lo siguiente: <span class="math display">\[
\binom{n}{x} = \frac{n!}{x!(n-x)!} = \frac{5!}{2!3!} = \frac{120}{2 \cdot 6} = 10
\]</span> Es decir, hay 10 pares distintos que se pueden formar. Esto tiene las siguiente propiedades clave (que usaremos para un teorema de sobre la distribución binomial y ensayos de Bernoulli, por eso lo coloco):</p>
<ul>
<li><p><strong>Simetría</strong><br>
<span class="math display">\[\binom{n}{x} = \binom{n}{n - x}\]</span><br>
Elegir (x) de (n) es lo mismo que elegir los (n - x) que quedan fuera.</p></li>
<li><p><strong>Valor en los extremos</strong><br>
<span class="math display">\[\binom{n}{0} = \binom{n}{n} = 1\]</span><br>
Sólo hay una forma de no escoger nada o de escoger todo.</p></li>
<li><p><strong>Relación recursiva (Triángulo de Pascal)</strong><br>
<span class="math display">\[\binom{n}{x} = \binom{n - 1}{x - 1} + \binom{n - 1}{x}\]</span></p></li>
</ul>
<p>Además, de las propieidades, una <strong>Aplicación en el Teorema del Binomio</strong> es la siguiente: en la expansión de <span class="math inline">\((a + b)^n\)</span>, los coeficientes vienen dados por:</p>
<p><span class="math display">\[
(a + b)^n = \sum_{x = 0}^{n} \binom{n}{x}\,a^x\,b^{\,n - x}.
\]</span></p>
<p>Respecto a la <strong>interpretación probabilística</strong> del coeficiente binomial, tenemos que fijarnos en lo siguiente. En un experimento de Bernoulli (éxito o fracaso) con probabilidad de éxito (p) en cada ensayo, la probabilidad de obtener exactamente (x) éxitos en (n) ensayos es:</p>
<p><span class="math display">\[
P(X = x) = \binom{n}{x}\,p^x\,(1 - p)^{\,n - x}.
\]</span></p>
<p>En resumen, <span class="math inline">\(\displaystyle \binom{n}{x}\)</span> cuenta de cuántas maneras puedes elegir <span class="math inline">\(x\)</span> elementos de un total de <span class="math inline">\(n\)</span>, y aparece de forma natural en combinatoria, en el desarrollo de potencias binomiales y en distribuciones de probabilidad.</p>
<p>Con todo esto, veremos un Teorema, que nos permite relacionar la distribución binomial con los ensayos de Bernoulli. Con ello, sabremos bien para qué nos sirve este tipo de distribución.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Teorema: Distribución Binomial y ensayos de Bernoulli.
</div>
</div>
<div class="callout-body-container callout-body">
<p>Sea <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> variables aleatorias independientes, con distribuciones Bernoulli de parámetro <span class="math inline">\(p\)</span>. Diremos, por tanto, que se trata de <span class="math inline">\(n\)</span> ensayos de Bernoulli con probabilidad de éxito <span class="math inline">\(p\)</span>, donde se sobreentiende que son independientes. Denotamos por <span class="math inline">\(S\)</span> el número de éxitos en los <span class="math inline">\(n\)</span> ensayos, es decir <span class="math display">\[
S = X_1 + X_2 + \dots + X_n.
\]</span> Entonces <span class="math inline">\(S \sim \mbox{Bin}(n, p)\)</span>.</p>
</div>
</div>
</section>
</section>
<section id="distribución-geométrica" class="level4">
<h4 class="anchored" data-anchor-id="distribución-geométrica">Distribución Geométrica</h4>
<p>Una variable aleatoria <span class="math inline">\(X\)</span> sigue una distribución geométrica de parámetro <span class="math inline">\(p\)</span>, <span class="math inline">\(0 &lt; p &lt; 1\)</span>, si <span class="math inline">\(X\)</span> tiene una distribución discreta con función de probabilidad: <span class="math display">\[
f(x) =
    \begin{cases}
    pq^x &amp; \text{para } x = 0, 1, 2, \dots \\
    0 &amp; \text{si no.}
    \end{cases}
\]</span> donde <span class="math inline">\(q = 1 - p\)</span>. En este caso, escribimos <span class="math inline">\(X \sim \mbox{Geo}(p)\)</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Teorema: Distribución Geómetrica y ensayos de Bernoulli.
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consideremos <span class="math inline">\(X_1,X_2,X_3, \ldots\)</span> v.a. <span class="math inline">\(\mbox{Ber}(p)\)</span> independientes. Denotemos, pues, <span class="math inline">\(Y\)</span> por el número de fracasos antes del primer éxito de la secuencia anterior. Entonces, <span class="math inline">\(X\)</span> sigue una distribución geométrica de parámetro <span class="math inline">\(p\)</span>.</p>
</div>
</div>
</section>
<section id="relación-bernoulli-binomial-y-geométrica" class="level4">
<h4 class="anchored" data-anchor-id="relación-bernoulli-binomial-y-geométrica">Relación Bernoulli, Binomial y Geométrica</h4>
<p>Como ya se podría intuir, este tres tipos de distribuciones de variables aleatorias discretas, están relacionadas. Y lo están de la siguiente manera:</p>
<ul>
<li><p>Cuando realizamos un experimento que tiene <strong>solo dos resultados posibles</strong>, estamos ante un ensayo Bernoulli</p></li>
<li><p>Si tenemos una secuencia <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> de variables aleatorias independientes con distribución común <span class="math inline">\(\mbox{Bern}(p)\)</span>, la suma de ``éxitoa’’ tendrá una distribución <span class="math inline">\(\mbox{Bin}(n,p)\)</span>. Es básicamente, la suma una secuencia de experimentos con distribución <span class="math inline">\(\mbox{Bern}(p)\)</span></p></li>
<li><p>Si en esta misma secuencia denotamos como <span class="math inline">\(Y\)</span> el número de ``fracasos’’ antes del primer “éxito”, <span class="math inline">\(Y\)</span> tendrá una distribución <span class="math inline">\(\mbox{Geo}(p)\)</span></p></li>
</ul>
<p>Por ejemplo, si lanzamos una moneda en la que definimos <span class="math inline">\(X=1\)</span> si sale cara y <span class="math inline">\(X=0\)</span> si sale sello. Supongamos que el resultado fue el siguiente en 8 lanzamientos: <span class="math display">\[
S = \{\text{s, s, c, s, c, c, s, s}\}
\]</span> Tenemos, pues que</p>
<ol type="1">
<li><p>El lanzamiento particular de cada moneda tiene <span class="math inline">\(\mbox{Ber}(0,5)\)</span>.</p></li>
<li><p>Si definimos <span class="math inline">\(Y\)</span> como el número de caras si lanzamos la moneda 8 veces, tenemos que el número de caras fue <span class="math inline">\(c=3\)</span>. La distribución de los lanzamientos, así, es de <span class="math inline">\(\mbox{Bin}(n=8, p=0,5\)</span>).</p></li>
<li><p>Si definimos <span class="math inline">\(Z\)</span> como el número de fracasos antes del primer éxito, dado que hubo dos sellos <span class="math inline">\(X=0\)</span> antes de cara <span class="math inline">\(X=1\)</span>, entonces, tenemos, dado que la v.a., sigue una distribución tal qeu <span class="math inline">\(\mbox{Geo}(0,5)\)</span>, entonces, que va tener un <span class="math inline">\(\Pr(Y)=q^2p\)</span></p></li>
</ol>
<p>Gráficamente puede ser aún más claro. Veamos este ejemplo en R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, scales, purrr, tidyr)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Simulaciones</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ber =</span> <span class="fu">rbinom</span>(N, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p),</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bin =</span> <span class="fu">rbinom</span>(N, <span class="at">size =</span> n, <span class="at">prob =</span> p),</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Geo =</span> <span class="fu">rgeom</span>(N, <span class="at">prob =</span> p)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Distrib"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>)</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) PMF empírica</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>df_pmf <span class="ot">&lt;-</span> sim_data <span class="sc">|&gt;</span> </span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Distrib, x) <span class="sc">|&gt;</span> </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Distrib) <span class="sc">|&gt;</span> </span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Graficar</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_pmf, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(x), <span class="at">y =</span> prob, <span class="at">fill =</span> Distrib)) <span class="sc">+</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Distrib, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">strip.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Ber"</span> <span class="ot">=</span> <span class="st">"#4E79A7"</span>, <span class="st">"Bin"</span> <span class="ot">=</span> <span class="st">"#2CA02C"</span>, <span class="st">"Geo"</span> <span class="ot">=</span> <span class="st">"#E15759"</span>)) <span class="sc">+</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Valor de la variable aleatoria"</span>,</span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Probabilidad empírica"</span>,</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relación entre Bernoulli, Binomial y Geométrica (p = 0.5, n = 8)"</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text    =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/relacion-distribuciones-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="distribución-de-poisson" class="level5">
<h5 class="anchored" data-anchor-id="distribución-de-poisson">Distribución de Poisson</h5>
<p>La distribución de Poisson es algo que podríamos colocar más adelante. Pero al ser también una distribución propia de variables aleatorias discretas decido dejarla aquí. La distribución de Poisson permite modelar el número de éxistos en un determinado intervalo de <em>tiempo</em>. Por ejemplo, si en 1 hora vendo 20 chocolates promedio, puedo modelar esto con Poisson con parámetro 20. Formalmente tenemos lo siguiente.</p>
<p>Sea <span class="math inline">\(\lambda&gt;0\)</span>. La v.a. <span class="math inline">\(X\)</span> tiene una distribución de Poisson de parámetro <span class="math inline">\(\lambda\)</span>, lo cual denotamos como <span class="math inline">\(X\sim \mbox{Poi}(\lambda)\)</span>, si su función de probabilidad satiface <span class="math display">\[
f(x) = \frac{e^{-\lambda}\lambda^x}{x!}, \qquad x= 0, 1, 2, \ldots
\]</span> Aquí es donde conviene haber visto algunas cosas antes, particularmente los términos Esperanza y Varianza en este contexto. Pero da igual porque lo pondré en el apartado siguiente. Solo quería seguir la lógica de colocar las distribuciones juntas. Una vez visto esta distribución, esperanza y varianza (siguiente sección), pasaremos a las variables aleatorias continuas y sus distribuciones. Lo que tenemos que ver ahora, respecto a la distribución de Poisson, son sus propiedades.</p>
<p><strong>Propiedades de la Distribución de Poisson</strong></p>
<ol type="1">
<li><p>Si <span class="math inline">\(X\sim \mbox{Poi}(\lambda)\)</span> entonces <span class="math display">\[
\mbox{E}(X) = \lambda, \qquad \mbox{Var}(X)=\lambda
\]</span></p></li>
<li><p>Si <span class="math inline">\(X\sim \mbox{Poi}(\lambda_1)\)</span>, <span class="math inline">\(Y\sim \mbox{Poi}(\lambda_2)\)</span>, y <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> son independientes, entonces se tiene que <span class="math display">\[
X+Y \sim \mbox{Poi}(\lambda_1 +\lambda_2).
\]</span> Es decir, la suma de las v.a. independientes Poisson es Poisson, y el parámetro de las sumas es la suma de los parámetros de las variables individuales.</p></li>
</ol>
<p>Como ya mencionamos, la distribución de Poisson es principalmente utilizada para contar el número de éxitos en un determinado intervalo de tiempo o región del espacio, pues una Poisson es una <strong>muy buena <em>aproximación</em> para una binomial</strong> con un <span class="math inline">\(n\)</span> que tiende a infinito y un parámetro <span class="math inline">\(p\)</span> muy pequeño. En efecto, si se tiene qeu <span class="math inline">\(X_n \sim \mbox{Bin}(n,p)\)</span> y <span class="math inline">\(n\)</span> tiende a infinito, entonces <span class="math inline">\(X_n\)</span> <em>converge</em> a Poisson de parámetro <span class="math inline">\(\lambda = np\)</span>, i.e., <span class="math display">\[
\lim_{n\to \infty} (\Pr(X_n=x)) = \frac{e^{-\lambda}\lambda^x}{x!}
\]</span> Por lo tanto, es recomentable usar este tipo de distribución en el caso que nos enfrentemos a una distribución binomial con un número de ensayos <span class="math inline">\(n\)</span> bastante grande y una probabilidad de éxito <span class="math inline">\(p\)</span> pequeña.</p>
</section>
</section>
<section id="distribuciones-de-variables-aleatorias-continuas" class="level4">
<h4 class="anchored" data-anchor-id="distribuciones-de-variables-aleatorias-continuas">Distribuciones de variables aleatorias continuas</h4>
<p>diferencia de las v.a. discretas, las v.a. continuas son aquellas que pueden tomar <strong>cualquier valor</strong> de un intervalo de una recta real. Es decir, cualquier número real. Un ejemplo puede ser el tiempo, los ingresos, distancias, etc. De tal modo, las v.a. continuas describen el resultado de situaciones de probabilidades en donde lso valores de la v.a. forman un <em>continuum</em> de valores y, por tanto, no es posible <em>listar</em> valores. De tal modo, conviene aprehenderlos mediante intervalos. Formalmente, tenemos lo siguiente:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>La v.a. <span class="math inline">\(X\)</span> tiene una <strong>distribución continua</strong> si existe una función <span class="math inline">\(f\)</span> definida sobre la recta real, que toma valores mayores o iguales que 0, tal que cualquier para intervalo la probabilidad de que <span class="math inline">\(X\)</span> tome valores en el intervalo que va de <span class="math inline">\(a\)</span> a <span class="math inline">\(b\)</span> es igual a la integral de <span class="math inline">\(f\)</span> sobre el intervalo. Matemáticamente, <span class="math display">\[
\Pr(a&lt;X&lt;b) = \int^b_a f(x)dx
\]</span></p>
</div>
</div>
<p>Ciertamente los intervalos dependerán de lo que queramos modelar. Si <span class="math inline">\(a\leq b\)</span>, entonces, <span class="math display">\[
\Pr(a\leq X\leq b) = \int^b_a f(x)dx
\]</span> Si, e.g., <span class="math inline">\(b=+\infty\)</span>, entonces <span class="math display">\[
\Pr(a\geq X) = \int^\infty_a f(x)dx
\]</span> O, si <span class="math inline">\(a=-\infty\)</span>, entonces, <span class="math display">\[
\Pr(X\leq b) = \int^b_{-\infty} f(x)dx
\]</span> Diremos, ademñas, que <span class="math inline">\(f(x)\)</span> es la <strong>función de <em>densidad</em> de probabilidad</strong> (o f.d.p.), y ya no solo la f.p., de la v.a. <span class="math inline">\(X\)</span>. El conjunto de valores de <span class="math inline">\(x\)</span> donde <span class="math inline">\(f(x)&gt;0\)</span>, se conoce como el <strong>soporte</strong> de <span class="math inline">\(X\)</span>. Un ejemplo de esto, lo podríamos observar con lo siguiente. Sea la v.a. continua <span class="math inline">\(X\)</span>, cuya f.d.p. está dad por <span class="math display">\[
f(x)=
\begin{cases}
  \frac{x}{2} &amp; \text{si } \quad 0 \leq x \leq 2,\\
  0 &amp; \text{si no}
\end{cases}
\]</span> Deberíamos calcular, entonces, <span class="math inline">\(\Pr(1\leq X \leq 1,5)\)</span>. Y siguiendo la definición, tendríamos que <span class="math display">\[
\Pr(1\leq X \leq 1,5) = \int^{1,5}_1 \frac{x}{2} dx
\]</span> Si resolvemos la integral: <span class="math display">\[
\begin{aligned}
  \int^{1,5}_1 \frac{x}{2} dx &amp;= \frac{1}{2}\int^{1,5}_1 xdx \quad || \text{ regla de la potencia}\\
  &amp;= \frac{1}{2}\frac{x^2}{2} \quad || \text{ simplificamos}\\
  &amp;= 0,5[0,5x^2]^{1,5}_1 \quad || F(b)- F(a)\\
  &amp;| \lim _{x\to \:1+}\left(0.5x^2\right)=0,5 \\
  &amp;| \lim _{x\to \:1,5-}\left(0.5x^2\right)=1,125 \\
  &amp;= 1,125-0,5\\
  &amp;= 0,625
\end{aligned}
\]</span> <strong>Propiedades de una v.a. continua</strong>. Para garantizar que se cumple con los <strong>axiomas de probabilidad</strong>, la f.d.p. <span class="math inline">\(f(x)\)</span> de la v.a. continua <span class="math inline">\(X\)</span> debe cumplir con:</p>
<ol type="1">
<li><p>Ser positiva: <span class="math display">\[
f(x) \geq 0 \text{ para todo } - \infty \leq x \leq \infty
\]</span></p></li>
<li><p>La probabilidad del soporte de <span class="math inline">\(X\)</span> igual a uno <span class="math display">\[
\int^\infty_{-\infty} f(x)dx =1
\]</span> ##### Función de distribución cumulativa</p></li>
</ol>
<p>Otro concepto relevante que surge una vez conocemos las v.a. continuas, es el de función de distribución cumulativa. Ahora bien, también tenemos cumulativa para v.a. discretas. Veremos ambas y las propiedades de todas las funciondes cumulativas, además de especialmente fijarnos en el caso de v.a. continuas.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>La **función de distribución cumulativa (f.d.c.) de una v.a. <span class="math inline">\(X\)</span> es la función <span class="math display">\[
F(x) = \Pr(X \leq x)
\]</span> Abreviaremos la f.d.c. como función de distribución, como función cumulativa o cumulativa. La cumulativa está definida para toda v.a. (discreta o continua), y la denotamos con mayúscula <span class="math inline">\(F(\cdot)\)</span> para distinguirla de la f.d.p y f.p.</p>
</div>
</div>
<section id="distribución-uniforme-para-el-caso-de-v.a.-continuas" class="level5">
<h5 class="anchored" data-anchor-id="distribución-uniforme-para-el-caso-de-v.a.-continuas">Distribución uniforme para el caso de v.a. continuas</h5>
<p>Partimos con una distribución que ya vimos, pero ahora para el caso de las v.a. continuas. Arrancamos por su definición</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Decimos que la v.a. <span class="math inline">\(X\)</span> sigue una distribución uniforme en el intervalo <span class="math inline">\([a,b]\)</span>, donde <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> son números reales con <span class="math inline">\(a&lt;b\)</span>, si <span class="math inline">\(X\)</span> toma valores entre <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span>, y la probabilidad de que <span class="math inline">\(X\)</span> tome valores en cualquier subintervalo de <span class="math inline">\([a,b]\)</span> es proporcional al largo del subintervalo. Si esto es así, escribimos <span class="math inline">\(X\sim \mbox{U}(a,b)\)</span>.</p>
</div>
</div>
<p>Pondré solo un ejemplo. <strong>Cumulativa de una v.a. discreta</strong>: supongamos que <span class="math inline">\(X\sim \mbox{Bin}(4, 1/2)\)</span>, de modo que su f.p. está dadar por <span class="math display">\[
f(x)=
\begin{cases}
\frac{4}{x}(1/2)^4, &amp; \quad x=0, 1, 2, 3, 4,\\
0, &amp; \quad \text{en caso contrario}
\end{cases}
\]</span> Y queremos calcular <span class="math inline">\(F(2)\)</span>. Esto es, <span class="math display">\[
\begin{aligned}
  F(2) &amp;= \Pr(X\leq 2)\\
  &amp;=\Pr(X=0) + \Pr(X=1)+\Pr(X=2)\\
  &amp;=0,5^4+4\cdot 0,5^4+6\cdot 0,5^4\\
  &amp;= \frac{11}{16}
\end{aligned}
\]</span></p>
<p>Si hicieramos esto con todos los valores que toma <span class="math inline">\(x\)</span>, y no solo <span class="math inline">\(2\)</span>, se puede construir la función cumulativa completa. En R, en el paquete <code>stats</code> hay funciones específicas para distribuciones binomiales que usamos antes. Pero vale la pena especificar que <code>dbinom()</code>, proporciona la densidad, <code>pbinom()</code> proporciona la función de distribución, <code>qbinom()</code> proporciona la función cuantílica y <code>rbinom()</code> genera desviaciones aleatorias. Gráficamente es más facil verlo, así que lo hacemos en R podemos graficarlo así:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>               patchwork) <span class="co"># Para combinar gráficos.</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos para Binomial(4, 0.5)</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x        =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">pmf      =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">prob =</span> <span class="fl">0.5</span>),</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cdf      =</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prev_cdf =</span> <span class="fu">lag</span>(cdf, <span class="at">default =</span> <span class="dv">0</span>))</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico PMF</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>p_pmf <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> pmf)) <span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> pmf)) <span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(df<span class="sc">$</span>pmf) <span class="sc">*</span> <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"f(x)"</span>, <span class="at">title =</span> <span class="st">"PMF de Binomial(4, 0.5)"</span>) <span class="sc">+</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"sans"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico CDF</span></span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>p_cdf <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="fu">aes</span>(<span class="at">y =</span> cdf), <span class="at">direction =</span> <span class="st">"hv"</span>) <span class="sc">+</span></span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cdf), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> prev_cdf), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"F(x)"</span>, <span class="at">title =</span> <span class="st">"CDF de Binomial(4, 0.5)"</span>) <span class="sc">+</span></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"sans"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar ambos juntos</span></span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>p_pmf <span class="sc">+</span> p_cdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/eg-fdc-discreta-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Puse un ejemplo por lo siguiente: en la primera figura se muestra la función de probabilidad de <span class="math inline">\(X\)</span>, donde se centra en 2. En la siguiente figura, se muestra la función cumulativa de <span class="math inline">\(X\)</span>. Como se ve, hay saltos y tiene forma de escalera. Esto ocurre porque, en la medida que nos movemos hacia la derecha, <span class="math inline">\(0,1, \ldots, 4\)</span>, cada valor del soporte de <span class="math inline">\(X\)</span> añade a su propia probabilidad de ocurrencia a la probabilidad que la función ya venía acumulando. Por esto mismo, <strong>el “tamaño” del salto para un valor particualr de <span class="math inline">\(X\)</span> es igual a la probabilidad de que <span class="math inline">\(X\)</span> tome dicho valor</strong>. Por ejemplo, <span class="math inline">\(\Pr(X=2)\)</span> se expresa la linea vertical (el “salto”) del punto blanco al negro en el valor <span class="math inline">\(2\)</span> de las abscisas.</p>
<p><strong>Cumulativa de una v.a. continua</strong>: Para definir esto, partamos con una <strong>propiedad</strong> de toda cumulativa de una v.a. continua. Sea <span class="math inline">\(X\)</span> una v.a. continua con cumativa <span class="math inline">\(F\)</span> y f.d.p. <span class="math inline">\(f\)</span>. Entonces, <span class="math display">\[
F(x)= \int^x_{-\infty}f(u)du
\]</span> Aquí la demostración es directa, pues <span class="math display">\[
F(x)= \Pr (X \leq x) = \int^x_{-\infty}f(u)du
\]</span> lo único que cambia respecto a lo que ya sabíamos es que la variable de integración <em>no puede ser</em> <span class="math inline">\(x\)</span> dado que <span class="math inline">\(x\)</span> es el límite superior de la integral. Por eso se usa <span class="math inline">\(u\)</span>, como variable auxiliar.</p>
</section>
<section id="distribución-exponencial" class="level5">
<h5 class="anchored" data-anchor-id="distribución-exponencial">Distribución exponencial</h5>
<p>Con la distribución exponencial, explicaremos lo mismo que explicamos antes con la uniforme, i.e., f.d.p., la cumulativa, sus propiedades, esperanza y varianza. La distribución exponencial es útil para modelar el <strong>tiempo de espera</strong> hasta el primer éxito en un determinado experimento, donde se sabe que los éxitos llegan a una tasa de <span class="math inline">\(\lambda\)</span> éxitos <em>en promedio</em> por unidad de tiempo<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Una v.a. continua <span class="math inline">\(X\)</span> tiene una <strong>distribución exponencial</strong> con parámetro <span class="math inline">\(\lambda&gt;0\)</span> si su densidad de probabilidad es de la forma <span class="math display">\[
f(x)=
\begin{cases}
  \lambda e^{-\lambda x}, &amp; \text{ si } x \geq 0,\\
  0 &amp; \text{ en caso contrario.}
\end{cases}
\]</span> En tal caso, escribimos <span class="math inline">\(X\sim \mbox{Exp}(\lambda)\)</span></p>
</div>
</div>
<p>Gráficamente, podemos visualizar esto (para distintos parámetros de <span class="math inline">\(\lambda\)</span>) de la siguiente manera:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, scales)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>df_expo <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">x      =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambda =</span> lambdas</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">f     =</span> lambda <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> x),</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"λ = %.1f"</span>, lambda)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_expo, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f, <span class="at">color =</span> label)) <span class="sc">+</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"λ = 0.5"</span>, <span class="st">"λ = 1.0"</span>, <span class="st">"λ = 1.5"</span>),</span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"λ = 0.5"</span> <span class="ot">=</span> <span class="st">"#1F77B4"</span>,</span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">"λ = 1.0"</span> <span class="ot">=</span> <span class="st">"#7F7F7F"</span>,</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a>      <span class="st">"λ = 1.5"</span> <span class="ot">=</span> <span class="st">"#2CA02C"</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"x"</span>,</span>
<span id="cb35-30"><a href="#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="fu">expression</span>(f[X](x)),</span>
<span id="cb35-31"><a href="#cb35-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"F.d.p. de la distribución Exponencial para distintos λ"</span>,</span>
<span id="cb35-32"><a href="#cb35-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Parámetro λ"</span></span>
<span id="cb35-33"><a href="#cb35-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb35-34"><a href="#cb35-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb35-35"><a href="#cb35-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb35-36"><a href="#cb35-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title   =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb35-37"><a href="#cb35-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb35-38"><a href="#cb35-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb35-39"><a href="#cb35-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb35-40"><a href="#cb35-40" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/dist-exponencial-fdp-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="distribución-normal-estándar" class="level3">
<h3 class="anchored" data-anchor-id="distribución-normal-estándar">Distribución normal estándar</h3>
<p>Sobre esta distribución, nos detendremos un poco más. Veremos, no solo su función de densidad y cumulativa, sino que también los percentiles de una normal estándar y propiedes importantes. Esta será nuestro vinculo directo con el otro aspecto que habíamos mencionado como relevante para la inferencia estadística y causal además de la Ley de los Grandes Números: el Teorema del Límite Central.</p>
<p>Además, la distribución normal estándar es bastante importante para las ciencias sociales y naturales. Esta distribución provee buen ajuste de los datos para muchos fenómenos naturales, económicos y sociales. Por ejemplo, los datos de altura suelen distribuirse de manera normal estándar, o al menos aproximarse como tal. Por otro lado, podríamos pensar que, e.g., la altura es la suma de multiples factores: edad, genética, sexo, alimentación, etc. Justamente el TLC muestra que el <strong>promedio</strong> de un número lo <em>suficientemente grande</em> de v.a. independientes sigue una distribución <em>muy cecana</em> a una normal. Así, cuando una v.a. resulta de sumar <strong>muchas v.a. aleatorias independientes</strong>, la distribución normal es una <em>buena aproximación</em> de la v.a. que resulta. En ello reside el vínculo de esta distribución con el TLC y, lo que posteriormente veremos en inferencia estadística y modelamiento de fenómenos de interés.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>Una variable aleatoria continua sigue una distribución normal estándar si la función de densidad viene dada por <span class="math display">\[
\phi(x) = \frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}x^2}, \qquad -\infty &lt; x &lt; + \infty
\]</span> Notemos, además, que el soporte de la distribución normal estándar son todos los <span class="math inline">\(\mathbb{R}\)</span>, i.e., <span class="math inline">\(-\infty &lt; x &lt; + \infty\)</span>.</p>
<p>Por otro lado, se puede probar que <span class="math inline">\(\int^{+\infty}_{-\infty} \phi (X) dx =1\)</span>, lo cual está unido al hehco de que <span class="math inline">\(\phi(x)&gt;0\)</span> para todo <span class="math inline">\(x\)</span> establece que <span class="math inline">\(\phi(x)\)</span> efectivamente define una densidad de probabilidad</p>
</div>
</div>
<p>Gráficamente, la densidad de una distribución normal estándar se ve así:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, grid)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear datos para la densidad de la normal estándar</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>df_norm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">|&gt;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">phi =</span> <span class="fu">dnorm</span>(x))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar densidad y marcar intervalos de 68% y 95%</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_norm, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> phi)) <span class="sc">+</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#104E8B"</span>) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#24693D"</span>) <span class="sc">+</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#8B1A1A"</span>) <span class="sc">+</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Flecha para 68%</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.25</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="fl">0.25</span>),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>)),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"#24693D"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.27</span>, <span class="at">label =</span> <span class="st">"68%"</span>, <span class="at">color =</span> <span class="st">"#24693D"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Flecha para 95%</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">xend =</span> <span class="dv">2</span>, <span class="at">yend =</span> <span class="fl">0.06</span>),</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>)),</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"#8B1A1A"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.08</span>, <span class="at">label =</span> <span class="st">"95%"</span>, <span class="at">color =</span> <span class="st">"#8B1A1A"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"x"</span>,</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="fu">expression</span>(<span class="fu">phi</span>(x)),</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Densidad de la normal estándar"</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="02-statistics_files/figure-html/fdp-normal-estandar-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Como se puede observar, la distribución aquí está centrada en una media de <span class="math inline">\(0\)</span>. La <em>probabilidad</em> de que nuestra variable aleatoria tome valores entre <span class="math inline">\([-1, 1]\)</span> es del 68%. A su vez, que la v.a. tome valores <span class="math inline">\([-2, 2]\)</span> es del 95%. Por otro lado, la <em>forma</em> de la densidad de la distribución es similar a una campana. Por ello, cuando una distribución toma dicha <em>forma</em>, se le suele decir que toma forma de <strong>campana de Gauss</strong>.</p>
<p>Como en todas las otras distribuciones, a partir de la f.d.p. podemos definir su f.d.c., que denotaremos por <span class="math inline">\(\Phi\)</span>. Definamosla:</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definición
</div>
</div>
<div class="callout-body-container callout-body">
<p>La función cumulativa correspondiente a <span class="math inline">\(\phi(x)\)</span>, que se denota por <span class="math inline">\(\Phi(x)\)</span>, está dada por <span class="math display">\[
\Phi(x) = \int^x_{-\infty} \phi(x)du
\]</span> Un punto importante, es que la función cumulativa de una normal estándar no tiene una expresión cerrada, por lo cual se usan tablas (con Excel o similares) para calcular sus valores.</p>
<p>Por otro lado, una consecuencia directa de la <strong>simetría</strong> antes mencionada (y graficada) para <span class="math inline">\(\phi(x)\)</span> es que su cumulativa <span class="math inline">\(\Phi(\cdot)\)</span> evaluada en <span class="math inline">\(-x\)</span> es <span class="math display">\[
\Phi(-x) = 1 - \Phi(x)
\]</span></p>
</div>
</div>
<section id="propiedades-de-la-distribución-normal-estándar" class="level4">
<h4 class="anchored" data-anchor-id="propiedades-de-la-distribución-normal-estándar">Propiedades de la Distribución Normal Estándar</h4>
<p>Por último, dejamos expresadas las propiedades de una distribución normal estándar. No las demostraré, luego que es más útil ver algunas cuestiones antes, particularmente al ver familia de distribuciones normales.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Propiedades de la Distribución Normal Estándar
</div>
</div>
<div class="callout-body-container callout-body">
<p>Supongamos que la v.a. <span class="math inline">\(Z\)</span> sigue una distribución normal estándar, que denotamos como <span class="math inline">\(Z \sim \mathcal{N}(0,1)\)</span>. Entonces,</p>
<ol type="1">
<li><p>Se tiene que <span class="math inline">\(\mbox{E}(Z)=0,\)</span></p></li>
<li><p>Se tiene que <span class="math inline">\(\mbox{Var}(Z)=1,\)</span></p></li>
<li><p>Se tiene que <span class="math inline">\(\mbox{E}(Z^3)=0,\)</span></p></li>
<li><p>Se tiene que <span class="math inline">\(\mbox{Var}(Z^4)=3\)</span></p></li>
</ol>
</div>
</div>


<!-- -->

</section>
</section>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>El LaTex se coloca <code>\dbtilde{}</code>. No me deja en Quarto, pero colocar <code>\tilde{\tilde{x}}</code> es para representar que se denota con doble tilde<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Esto no lo haré para los datos muestrales de la CASEN 2022. Principalmente, porque para eso usaremos, más adelante, paquetes especializados, como <code>survey</code> y <code>srvyr</code><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Yo uso las paletas de colores de <a href="https://r-charts.com/es/colores/">aquí</a><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Para ello, hay muchas bases de datos que si registran esta información. Además, el MINEDUC una buena plataforma de datos abiertos, pero para centrarnos, en este capítulo, en la CASEN<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Un proceso estocástico es aquel cuyo resultado no puede preverse con certeza de antemano. En cambio, un proceso determinista produce siempre el mismo resultado cuando se parte de una misma condición inicial. Por ejemplo, lanzar una moneda es un proceso estocástico, mientras que sumar dos números concretos es un proceso determinista. Luego lo usaremos como homólogo de proceso aleatorio<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Se podría denominar esta distribució como la contraparte continua de una v.a. geométrica, pues se utiliza frecuentemente para representar tiempo de espera antes del éxito. En rigor, la distribución exponencial es un caso particular de la distribución gamma.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb37" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Sesión 2: Estadística Descriptiva (II) y Prueba de Hipótesis (I)"</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Taller de Métodos y Técnicas de Investigación I"</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: true</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>En esta sesión entraremos de lleno en estadística descriptiva, retomando desde contenidos de la sesión pasada, pero con un enfoque más riguroso. Sumado a esto, nos enfocaremos más en esto desde una perspectiva más estadística y usando R aplicadamente, sin deternos tanto en R mismo. Aunque también aprovecharé de mostrarle como crear funciones de usuario para hacer estadísticas descriptivas con una sola función. </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## Objetivos de la sesión</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Comprender la estadística descriptiva</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Conocer medidas de la estadística descriptiva</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Crear visualizaciones avanzadas.</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Introducción a test de hipótesis y estadística inferencial</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>Pero antes de comenzar, carguemos los paquetes que utilizaremos, donde además les muestro mi forma favorita de cargar y traer paquetes en un solo paso (con <span class="in">`pacman`</span>). </span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cargar-paquetes</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| eval: false</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a><span class="co">#Forma 1 (Forma clásica)</span></span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>) <span class="co"># colección de paquetes, dplyr entre ellos</span></span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"dplyr"</span>) <span class="co"># manipular datos</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"sjmisc"</span>) <span class="co"># explorar datos</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a><span class="co">#Forma 2 (Mejor para reproductibilidad)</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a><span class="fu">invisible</span>(<span class="fu">lapply</span>(<span class="fu">c</span>(<span class="st">"tidyverse"</span>, <span class="co"># colección de paquetes, dplyr entre ellos</span></span>
<span id="cb37-35"><a href="#cb37-35" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"dplyr"</span>, <span class="co"># manipular datos</span></span>
<span id="cb37-36"><a href="#cb37-36" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"sjmisc"</span>), <span class="co"># explorar datos</span></span>
<span id="cb37-37"><a href="#cb37-37" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(p) </span>
<span id="cb37-38"><a href="#cb37-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(p, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(p)))</span>
<span id="cb37-39"><a href="#cb37-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-40"><a href="#cb37-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Llamar librería </span></span>
<span id="cb37-41"><a href="#cb37-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb37-42"><a href="#cb37-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb37-43"><a href="#cb37-43" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjmisc)</span>
<span id="cb37-44"><a href="#cb37-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-45"><a href="#cb37-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Forma 3 (Mi favorita. Es `install.packages()` -si no está bajado- más `library`)</span></span>
<span id="cb37-46"><a href="#cb37-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-47"><a href="#cb37-47" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb37-48"><a href="#cb37-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb37-49"><a href="#cb37-49" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, <span class="co"># colección de paquetes, dplyr entre ellos, pero también haven</span></span>
<span id="cb37-50"><a href="#cb37-50" aria-hidden="true" tabindex="-1"></a>               dplyr, <span class="co"># manipular datos</span></span>
<span id="cb37-51"><a href="#cb37-51" aria-hidden="true" tabindex="-1"></a>               psych, <span class="co"># para estadísticas descriptivas</span></span>
<span id="cb37-52"><a href="#cb37-52" aria-hidden="true" tabindex="-1"></a>               sjmisc, <span class="co"># explorar datos</span></span>
<span id="cb37-53"><a href="#cb37-53" aria-hidden="true" tabindex="-1"></a>               ggplot2, <span class="co"># para visualizar gráficos</span></span>
<span id="cb37-54"><a href="#cb37-54" aria-hidden="true" tabindex="-1"></a>               scales) <span class="co"># para ajustar gráficos</span></span>
<span id="cb37-55"><a href="#cb37-55" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-56"><a href="#cb37-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-57"><a href="#cb37-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-60"><a href="#cb37-60" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-61"><a href="#cb37-61" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cargar-paquetes-real</span></span>
<span id="cb37-62"><a href="#cb37-62" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb37-63"><a href="#cb37-63" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb37-64"><a href="#cb37-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb37-65"><a href="#cb37-65" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, <span class="co"># colección de paquetes, dplyr entre ellos, pero también haven</span></span>
<span id="cb37-66"><a href="#cb37-66" aria-hidden="true" tabindex="-1"></a>               dplyr, <span class="co"># manipular datos</span></span>
<span id="cb37-67"><a href="#cb37-67" aria-hidden="true" tabindex="-1"></a>               psych, <span class="co"># para estadísticas descriptivas</span></span>
<span id="cb37-68"><a href="#cb37-68" aria-hidden="true" tabindex="-1"></a>               sjmisc, <span class="co"># explorar datos</span></span>
<span id="cb37-69"><a href="#cb37-69" aria-hidden="true" tabindex="-1"></a>               ggplot2, <span class="co"># para visualizar gráficos</span></span>
<span id="cb37-70"><a href="#cb37-70" aria-hidden="true" tabindex="-1"></a>               scales) <span class="co"># para ajustar gráficos</span></span>
<span id="cb37-71"><a href="#cb37-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-72"><a href="#cb37-72" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb37-73"><a href="#cb37-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-74"><a href="#cb37-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-75"><a href="#cb37-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-76"><a href="#cb37-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-77"><a href="#cb37-77" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1. Estadística descriptiva</span></span>
<span id="cb37-78"><a href="#cb37-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-79"><a href="#cb37-79" aria-hidden="true" tabindex="-1"></a><span class="fu">## Datos </span></span>
<span id="cb37-80"><a href="#cb37-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-81"><a href="#cb37-81" aria-hidden="true" tabindex="-1"></a>Para comprender que son las estadísticas descriptivas, y para que las usaremos como futurxs sociólogxs, partamos viendo *qué son los datos*. Los **datos** son valores (o mediciones) de variables que han sido recolectados y organizados para su análisis. La palabra datos se define como información factual (como mediciones o estadísticas) utilizada como base para el razonamiento, para la discusión o para cálculos [(Merrian-Webster)](https://www.merriam-webster.com/dictionary/data). Existen tres tipos de *estrucutas de datos*: </span>
<span id="cb37-82"><a href="#cb37-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-83"><a href="#cb37-83" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Datos de corte transversal**: son mediciones de un conjunto de variables para un gurpo de unidades (personas, hogares, empresas, países, etc.) en un mismo momento del tiempo. Un ejemplo de esto puede ser los puntajes PSU de un año dado. Una base de datos de datos de corte transversal, e.g., es la CASEN, la ENUT, la ENE, etc. </span>
<span id="cb37-84"><a href="#cb37-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-85"><a href="#cb37-85" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Datos de series de tiempo**: sucesión de registros de una o varias variables de una única unidad, que son medidos en determinados momento del tiempo en un orden cronológico claro. Es importante resaltar que registra una **única** entidad/unidad a lo largo del tiempo. Un ejemplo podría ser el IMACEC o el PIB de tal a tal periodo. </span>
<span id="cb37-86"><a href="#cb37-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-87"><a href="#cb37-87" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Datos de panel o longitudinales**: sucesión de registros de un conjunto de variables para un grupo de unidades medidas en varios momentos del tiempo. Los datos de panel/longitudinales combinan las dimensiones de corte transversal y series de tiempo de los datos, pues es una sucesión de registros de un *conjunto de variables* para un *grupo de unidades*, medidas en varios momentos del tiempo con un orden cronológico claro. Un ejemplo de esto podría ser la tasa de crecimiento anual del PIB real para un grupo de países de tal a cual periodo. </span>
<span id="cb37-88"><a href="#cb37-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-89"><a href="#cb37-89" aria-hidden="true" tabindex="-1"></a>A su vez, existen dos tipos de recolección de datos:</span>
<span id="cb37-90"><a href="#cb37-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-91"><a href="#cb37-91" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Estudios observacionales**: los datos se recopilan por medio de la observación de los valores de las variables de interés sin intervención o influencia en ellos; o </span>
<span id="cb37-92"><a href="#cb37-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-93"><a href="#cb37-93" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Experimentos**: tras una exposición de ciertas unidades a una intervención, se observan los valores de las variables de interés presentes en los resultados. </span>
<span id="cb37-94"><a href="#cb37-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-95"><a href="#cb37-95" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tipos de variables</span></span>
<span id="cb37-96"><a href="#cb37-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-97"><a href="#cb37-97" aria-hidden="true" tabindex="-1"></a>Una variable es una característica o atributo que puede tomar valores diferentes para distintas unidades. Las variables tienen dos categorías principales que las distinguen: </span>
<span id="cb37-98"><a href="#cb37-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-99"><a href="#cb37-99" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Variables categóricas**: puede tomar un número limitado de valores definido sobre la base de alguna característica cualitativa. A su vez, dentro de las variables categóricas se encuentran</span>
<span id="cb37-100"><a href="#cb37-100" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-101"><a href="#cb37-101" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>*Variable categórica nominal*: es una variable categórica/cualitativa sin ningún orden o jerarquía clara. Por ejemplo, una variable que registre nombres de un curso, comunas, países, etc. Dentro de las variables categóricas nominales, se encuentran las variables *dummy*, las que poseen solo dos valores a los que se les puede asignar un número, generalmente $0$ o $1$, donde $1$ indica presencia del atributo y $0$ ausencia.</span>
<span id="cb37-102"><a href="#cb37-102" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-103"><a href="#cb37-103" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>*Varible categórica ordinal*: es una variable categórica/cualitativa que tiene un orden o jerarquí establecida entre sus categorías. Por ejemplo, el nivel educacional o las variables en "Escala Likert"</span>
<span id="cb37-104"><a href="#cb37-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-105"><a href="#cb37-105" aria-hidden="true" tabindex="-1"></a>En R, para crear una variable cualitativa, deben escribirse entre comillas sus categorías, como ya vimos la sesión pasada. Por ejemplo, </span>
<span id="cb37-106"><a href="#cb37-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-109"><a href="#cb37-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-110"><a href="#cb37-110" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-variables-categoricas</span></span>
<span id="cb37-111"><a href="#cb37-111" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true </span></span>
<span id="cb37-112"><a href="#cb37-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables categóricas</span></span>
<span id="cb37-113"><a href="#cb37-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-114"><a href="#cb37-114" aria-hidden="true" tabindex="-1"></a>var_nominal <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Karl Marx"</span>, <span class="st">"Rosa Luxemburgo"</span>, <span class="st">"Wooldrigde"</span>)</span>
<span id="cb37-115"><a href="#cb37-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-116"><a href="#cb37-116" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_nominal) <span class="co"># Comprobar naturaleza de la variable</span></span>
<span id="cb37-117"><a href="#cb37-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-118"><a href="#cb37-118" aria-hidden="true" tabindex="-1"></a>var_ordinal_educ<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Secundaria Incompleta"</span>, <span class="st">"Secundaria Completa"</span>,</span>
<span id="cb37-119"><a href="#cb37-119" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"Educación Superior Incompleta"</span>, <span class="st">"Educación Superior Completa"</span>)</span>
<span id="cb37-120"><a href="#cb37-120" aria-hidden="true" tabindex="-1"></a>var_ordinal_likert <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Muy malo"</span>, <span class="st">"Malo"</span>, <span class="st">"Maomeno"</span>,</span>
<span id="cb37-121"><a href="#cb37-121" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"Bueno"</span>, <span class="st">"Muy bueno"</span>)</span>
<span id="cb37-122"><a href="#cb37-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-123"><a href="#cb37-123" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_ordinal_educ) <span class="co"># Comprobar naturaleza de la variable</span></span>
<span id="cb37-124"><a href="#cb37-124" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_ordinal_likert) <span class="co"># Comprobar naturaleza de la variable</span></span>
<span id="cb37-125"><a href="#cb37-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-126"><a href="#cb37-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-127"><a href="#cb37-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-128"><a href="#cb37-128" aria-hidden="true" tabindex="-1"></a>Suele ser útil, en R, asignarles números a las variables cualitativas para un análisis estadísticos posteriores. Por ejemplo, podríamos tomar <span class="in">`var_ordinal_likert`</span> y, *además* de que tenga sus categorías asociadas, también tengan un número. Por ejemplo, que <span class="in">`"Muy malo"`</span> sea <span class="in">`1`</span> y <span class="in">`"Muy bueno"`</span> sea <span class="in">`5`</span>. Esto podemos hacerlo de dos maneras que mostramos de inmediato. Por cierto, la segunda la hacemos con <span class="in">`haven`</span> que es un paquete dentro de <span class="in">`tidyverse`</span>, y que usualmente usaremos ese paquete para cargar bases de datos, pero que también sirve para recodificar:</span>
<span id="cb37-129"><a href="#cb37-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-132"><a href="#cb37-132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-133"><a href="#cb37-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-variables-categoricas2</span></span>
<span id="cb37-134"><a href="#cb37-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-135"><a href="#cb37-135" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Versión con un factor ordenado (tienes la categoría y su código interno)</span></span>
<span id="cb37-136"><a href="#cb37-136" aria-hidden="true" tabindex="-1"></a>var_ordinal_likert <span class="ot">&lt;-</span> <span class="fu">factor</span>(</span>
<span id="cb37-137"><a href="#cb37-137" aria-hidden="true" tabindex="-1"></a>  var_ordinal_likert,</span>
<span id="cb37-138"><a href="#cb37-138" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels  =</span> <span class="fu">c</span>(<span class="st">"Muy malo"</span>, <span class="st">"Malo"</span>, <span class="st">"Maomeno"</span>, <span class="st">"Bueno"</span>, <span class="st">"Muy bueno"</span>),</span>
<span id="cb37-139"><a href="#cb37-139" aria-hidden="true" tabindex="-1"></a>  <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb37-140"><a href="#cb37-140" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-141"><a href="#cb37-141" aria-hidden="true" tabindex="-1"></a><span class="co"># Para ver el código numérico (1=Muy malo … 5=Muy bueno):</span></span>
<span id="cb37-142"><a href="#cb37-142" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(var_ordinal_likert)</span>
<span id="cb37-143"><a href="#cb37-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-144"><a href="#cb37-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-145"><a href="#cb37-145" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Si prefieres un vector numérico “double” con etiquetas (dos niveles),</span></span>
<span id="cb37-146"><a href="#cb37-146" aria-hidden="true" tabindex="-1"></a><span class="co">#    puedes usar haven::labelled</span></span>
<span id="cb37-147"><a href="#cb37-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-148"><a href="#cb37-148" aria-hidden="true" tabindex="-1"></a>var_ordinal_likert <span class="ot">&lt;-</span> haven<span class="sc">::</span><span class="fu">labelled</span>(</span>
<span id="cb37-149"><a href="#cb37-149" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.integer</span>(<span class="fu">factor</span>(</span>
<span id="cb37-150"><a href="#cb37-150" aria-hidden="true" tabindex="-1"></a>    var_ordinal_likert,</span>
<span id="cb37-151"><a href="#cb37-151" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels  =</span> <span class="fu">c</span>(<span class="st">"Muy malo"</span>, <span class="st">"Malo"</span>, <span class="st">"Maomeno"</span>, <span class="st">"Bueno"</span>, <span class="st">"Muy bueno"</span>),</span>
<span id="cb37-152"><a href="#cb37-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">ordered =</span> <span class="cn">TRUE</span></span>
<span id="cb37-153"><a href="#cb37-153" aria-hidden="true" tabindex="-1"></a>  )),</span>
<span id="cb37-154"><a href="#cb37-154" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb37-155"><a href="#cb37-155" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Muy malo"</span>  <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb37-156"><a href="#cb37-156" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Malo"</span>      <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb37-157"><a href="#cb37-157" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Maomeno"</span>   <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb37-158"><a href="#cb37-158" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Bueno"</span>     <span class="ot">=</span> <span class="dv">4</span>,</span>
<span id="cb37-159"><a href="#cb37-159" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Muy bueno"</span> <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb37-160"><a href="#cb37-160" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-161"><a href="#cb37-161" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-162"><a href="#cb37-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-163"><a href="#cb37-163" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprobamos:</span></span>
<span id="cb37-164"><a href="#cb37-164" aria-hidden="true" tabindex="-1"></a>var_ordinal_likert</span>
<span id="cb37-165"><a href="#cb37-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-166"><a href="#cb37-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-167"><a href="#cb37-167" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Variables cuantitativas**: son variables medidas en una escala númerica, como la edad, temperatura, estatura, etc. Y, por lo tanto, que el número mismo indica ordinalidad y jerarquía entre los valores ($x&lt;x+1$). También hay dos tipos de variables cuantitativas</span>
<span id="cb37-168"><a href="#cb37-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-169"><a href="#cb37-169" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>*Variable cuantitativa discreta*: es aquella que *solo* puede tomar números específicos como valores, sin poder tomar un valor intermedio entre dos valores específicos. Es decir, que se expresan en números enteros. Matemáticamente, simplemente son variables en que sus valores $x \in \mathbb{N}$. Un ejemplo, puede ser el número de ventas (no se puede vender -100), la edad de las personas encuestadas (no se puede tener -2), etc. </span>
<span id="cb37-170"><a href="#cb37-170" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-171"><a href="#cb37-171" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>*Variable cuantiativa continua*: puede tomar como valores un número infinito de posibilidades dentro de un rango de números, por lo que se expresa en números reales: $x\in \mathbb{R}$. Un ejemplo de esto puede ser una cuenta corriente, el peso de las personas, la temperatura, etc. </span>
<span id="cb37-172"><a href="#cb37-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-173"><a href="#cb37-173" aria-hidden="true" tabindex="-1"></a>  En R, las variables cuantitativas tienen por categorías números, sin "...". Además, si se quiere dejar como variable cuantitativa discreta (<span class="in">`integer`</span>), se le puede añadir una <span class="in">`L`</span> después del número. Esto es porque en R cualquier literal numérico sin sufijo se interpreta por defecto como tipo <span class="in">`numeric`</span> (variable cuantitativa). Al añadir la <span class="in">`L`</span> se le indica a R que es un <span class="in">`integer`</span> (número entero). No obstante, generalmente para el análisis estadístico no afectará mucho. </span>
<span id="cb37-174"><a href="#cb37-174" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-177"><a href="#cb37-177" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-178"><a href="#cb37-178" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-variables-cuantitativas</span></span>
<span id="cb37-179"><a href="#cb37-179" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-180"><a href="#cb37-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables cuantitativas discretas</span></span>
<span id="cb37-181"><a href="#cb37-181" aria-hidden="true" tabindex="-1"></a>var_discreta_hijos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>L, <span class="dv">1</span>L, <span class="dv">2</span>L, <span class="dv">3</span>L, <span class="dv">4</span>L)</span>
<span id="cb37-182"><a href="#cb37-182" aria-hidden="true" tabindex="-1"></a>var_discreta_autos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>L, <span class="dv">0</span>L, <span class="dv">2</span>L, <span class="dv">1</span>L, <span class="dv">3</span>L)</span>
<span id="cb37-183"><a href="#cb37-183" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_discreta_hijos)   </span>
<span id="cb37-184"><a href="#cb37-184" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_discreta_autos)   </span>
<span id="cb37-185"><a href="#cb37-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-186"><a href="#cb37-186" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables cuantitativas continuas</span></span>
<span id="cb37-187"><a href="#cb37-187" aria-hidden="true" tabindex="-1"></a>var_continua_altura <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.65</span>, <span class="fl">1.72</span>, <span class="fl">1.58</span>, <span class="fl">1.80</span>, <span class="fl">1.75</span>)</span>
<span id="cb37-188"><a href="#cb37-188" aria-hidden="true" tabindex="-1"></a>var_continua_peso   <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">65.4</span>, <span class="fl">70.2</span>, <span class="fl">58.9</span>, <span class="fl">80.0</span>, <span class="fl">72.5</span>)</span>
<span id="cb37-189"><a href="#cb37-189" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_continua_altura)  <span class="co"># numeric</span></span>
<span id="cb37-190"><a href="#cb37-190" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(var_continua_peso)    <span class="co"># numeric</span></span>
<span id="cb37-191"><a href="#cb37-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-192"><a href="#cb37-192" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-193"><a href="#cb37-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-194"><a href="#cb37-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-195"><a href="#cb37-195" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estadísticas descriptivas </span></span>
<span id="cb37-196"><a href="#cb37-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-197"><a href="#cb37-197" aria-hidden="true" tabindex="-1"></a>Las estadísticas descriptivas son valores fácilmente interpretables y que entregan un "resumen" de las características más importantes de un conjunto de datos, además de que utilizan para su cálculo operaciones aritméticas simples. Las estadísticas descriptivas son el primer paso en el análisis exploratorio de datos. Antes del análisis estadístico más riguroso de los datos, es esencial examinar las estadísticas descriptivas de todas las variables para:</span>
<span id="cb37-198"><a href="#cb37-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-199"><a href="#cb37-199" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Detectar errores de medición o valores atípicos (*outliers*) en los datos.</span>
<span id="cb37-200"><a href="#cb37-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-201"><a href="#cb37-201" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Detectar patrones y tendencias en los datos.</span>
<span id="cb37-202"><a href="#cb37-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-203"><a href="#cb37-203" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Evaluar la plausibilidad de los supuestos de trabajo.</span>
<span id="cb37-204"><a href="#cb37-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-205"><a href="#cb37-205" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Establecer hipótesis de trabajo.</span>
<span id="cb37-206"><a href="#cb37-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-207"><a href="#cb37-207" aria-hidden="true" tabindex="-1"></a>A su vez, las estadísticas descriptivas se pueden clasificar en tres grupos:</span>
<span id="cb37-208"><a href="#cb37-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-209"><a href="#cb37-209" aria-hidden="true" tabindex="-1"></a><span class="ss">  1. </span>**Medidas de localización o tendencia central**: Se calculan para describir un valor central alrededor del cual se ubican (distribuyen) los datos. En otras palabras, estas medidas determinan el valor donde se ubican mayoritariamente las observaciones</span>
<span id="cb37-210"><a href="#cb37-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-211"><a href="#cb37-211" aria-hidden="true" tabindex="-1"></a><span class="ss">  2. </span>**Medidas de dispersión o variabilidad**: Proporcionan una descripción de la “dispersión de los datos” o qué tan lejos están las observaciones de la tendencia central.</span>
<span id="cb37-212"><a href="#cb37-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-213"><a href="#cb37-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-214"><a href="#cb37-214" aria-hidden="true" tabindex="-1"></a><span class="ss">  3. </span>**Medidas de posición**: Resumen la posición relativa de valores específicos en los datos.</span>
<span id="cb37-215"><a href="#cb37-215" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-216"><a href="#cb37-216" aria-hidden="true" tabindex="-1"></a>Antes de seguir profundizando esto, utilizaremos bases de datos reales y conocidas para ir ejemplificando el contenido con datos observacionales. Partamos con la Encuesta de Caracterización Socioeconómica Nacional (CASEN) más actual, la CASEN 2022. Esta se puede obtener en el <span class="co">[</span><span class="ot">siguiente link</span><span class="co">](https://observatorio.ministeriodesarrollosocial.gob.cl/encuesta-casen-2022)</span>, que cuenta con 202.231 casos (encuestados) y 918 variables. </span>
<span id="cb37-217"><a href="#cb37-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-218"><a href="#cb37-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-221"><a href="#cb37-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-222"><a href="#cb37-222" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cargar-casen</span></span>
<span id="cb37-223"><a href="#cb37-223" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-224"><a href="#cb37-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-225"><a href="#cb37-225" aria-hidden="true" tabindex="-1"></a><span class="do">## Obtener ruta </span></span>
<span id="cb37-226"><a href="#cb37-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-227"><a href="#cb37-227" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>() <span class="co"># Para obtener nuestro directorio (en este casode nuestro RProject)</span></span>
<span id="cb37-228"><a href="#cb37-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-229"><a href="#cb37-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar formato sav (SPSS)</span></span>
<span id="cb37-230"><a href="#cb37-230" aria-hidden="true" tabindex="-1"></a>casen2022<span class="ot">&lt;-</span>haven<span class="sc">::</span><span class="fu">read_sav</span>(<span class="st">"data-sesiones/CASEN 2022.sav"</span>)</span>
<span id="cb37-231"><a href="#cb37-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-232"><a href="#cb37-232" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(casen2022)</span>
<span id="cb37-233"><a href="#cb37-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-234"><a href="#cb37-234" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar formato dta (STATA)</span></span>
<span id="cb37-235"><a href="#cb37-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-236"><a href="#cb37-236" aria-hidden="true" tabindex="-1"></a><span class="co"># casen2022&lt;-haven::read_dta(".../CASEN 2022.dta")</span></span>
<span id="cb37-237"><a href="#cb37-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-238"><a href="#cb37-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-239"><a href="#cb37-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-240"><a href="#cb37-240" aria-hidden="true" tabindex="-1"></a>Continuemos. Antes de pasar a estos tres grupos de estadísticas descriptivas, conviene tener en claro el concepto de estadísticos de orden. Los **estadísticos de orden** es la ordenación de un conjunto de datos u obsrvaciones, dond $y_k$ es el $k-$ésimo menor valor del conjunto de observaciones. Por ejemplo, si tenemos estos cuatro datos: </span>
<span id="cb37-241"><a href="#cb37-241" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-242"><a href="#cb37-242" aria-hidden="true" tabindex="-1"></a>x_1 =9; x_2=3, x_3 = 12; x_3 =1 ; x_5=2</span>
<span id="cb37-243"><a href="#cb37-243" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-244"><a href="#cb37-244" aria-hidden="true" tabindex="-1"></a>Los estadísticos de orden, $y_i$, corresponderían a</span>
<span id="cb37-245"><a href="#cb37-245" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-246"><a href="#cb37-246" aria-hidden="true" tabindex="-1"></a>y_1=1; y_2=2; y_3=3; y_4=9; y_5=12</span>
<span id="cb37-247"><a href="#cb37-247" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-248"><a href="#cb37-248" aria-hidden="true" tabindex="-1"></a>Es decir, la ordenación de $x_i$ de menor a mayor. Dicho esto, pasemos, en primer lugar, a las medidas de localización o tendencia central. </span>
<span id="cb37-249"><a href="#cb37-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-250"><a href="#cb37-250" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1. Medidas de localización o tendencia central</span></span>
<span id="cb37-251"><a href="#cb37-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-252"><a href="#cb37-252" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Media o promedio</span></span>
<span id="cb37-253"><a href="#cb37-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-254"><a href="#cb37-254" aria-hidden="true" tabindex="-1"></a>La *media* de $n$ observaciones de una variable, <span class="sc">\(</span>x_1, \dots, x_n<span class="sc">\)</span>, que denotaremos por <span class="sc">\(</span>\bar{x}<span class="sc">\)</span>, está definida por la suma de los valores de todas las observaciones, dividida por el número de observaciones: </span>
<span id="cb37-255"><a href="#cb37-255" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-256"><a href="#cb37-256" aria-hidden="true" tabindex="-1"></a>\bar{x} = \frac{x_1 + x_2 + \dots + x_n}{n} = \frac{1}{n} \sum_{i=1}^{n} x_i.</span>
<span id="cb37-257"><a href="#cb37-257" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-258"><a href="#cb37-258" aria-hidden="true" tabindex="-1"></a>Por ejemplo, supongamos que los datos son:</span>
<span id="cb37-259"><a href="#cb37-259" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-260"><a href="#cb37-260" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7; \quad x_2 = 1.2; \quad x_3 = 0.9; \quad x_4 = 0.6; \quad x_5 = 1.4; \quad x_6 = 1.8; \quad x_7 = 2.5.</span>
<span id="cb37-261"><a href="#cb37-261" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-262"><a href="#cb37-262" aria-hidden="true" tabindex="-1"></a>La media en este caso viene dada por:</span>
<span id="cb37-263"><a href="#cb37-263" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-264"><a href="#cb37-264" aria-hidden="true" tabindex="-1"></a>\bar{x} = \frac{0.7 + 1.2 + 0.9 + 0.6 + 1.4 + 1.8 + 2.5}{7} = 1.3.</span>
<span id="cb37-265"><a href="#cb37-265" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-266"><a href="#cb37-266" aria-hidden="true" tabindex="-1"></a>En R, la media se obtiene simplemente con el comando <span class="in">`mean()`</span>. Veamos como obtener la media de alguna variable de interés en la CASEN 2022.  </span>
<span id="cb37-269"><a href="#cb37-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-270"><a href="#cb37-270" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-mean</span></span>
<span id="cb37-271"><a href="#cb37-271" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-272"><a href="#cb37-272" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener media mediante mean()</span></span>
<span id="cb37-273"><a href="#cb37-273" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(casen2022<span class="sc">$</span>ytrabajocor) <span class="co"># Ingreso del trabajo corregido</span></span>
<span id="cb37-274"><a href="#cb37-274" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Ups! </span></span>
<span id="cb37-275"><a href="#cb37-275" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(casen2022<span class="sc">$</span>ytrabajocor,</span>
<span id="cb37-276"><a href="#cb37-276" aria-hidden="true" tabindex="-1"></a>     <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="co"># ahora si :)</span></span>
<span id="cb37-277"><a href="#cb37-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-278"><a href="#cb37-278" aria-hidden="true" tabindex="-1"></a>Como se ve, el salario promedio de los encuestados de la CASEN 2022 es de 667.690CLP. El comando <span class="in">`na.rm = TRUE`</span> es para sacar las observaciones <span class="in">`NA`</span> de la variable, las cuales registran los casos </span>
<span id="cb37-279"><a href="#cb37-279" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-280"><a href="#cb37-280" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mediana  </span></span>
<span id="cb37-281"><a href="#cb37-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-282"><a href="#cb37-282" aria-hidden="true" tabindex="-1"></a>La **mediana** es el valor medio de un conjunto de observaciones cuando se les ordena de menor a mayor. Si el número de observaciones es par, entonces la *mediana* es la suma de los dos valores medios, dividida por 2. Si ordenamos las observaciones del ejemplo anterior de menor a mayor obtenemos los **estadísticos de orden** del conjunto de observaciones: </span>
<span id="cb37-283"><a href="#cb37-283" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-284"><a href="#cb37-284" aria-hidden="true" tabindex="-1"></a>y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, \quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8, \quad y_7 = 2.5.</span>
<span id="cb37-285"><a href="#cb37-285" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-286"><a href="#cb37-286" aria-hidden="true" tabindex="-1"></a>Notar que los *estadísticos de orden* cumplen con </span>
<span id="cb37-287"><a href="#cb37-287" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-288"><a href="#cb37-288" aria-hidden="true" tabindex="-1"></a>y_1 = \min(x_1, x_2, \dots, x_7), \quad y_7 = \max(x_1, x_2, \dots, x_7), \quad y_1 \leq y_2 \leq \dots \leq y_7.</span>
<span id="cb37-289"><a href="#cb37-289" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-290"><a href="#cb37-290" aria-hidden="true" tabindex="-1"></a>Entonces, para calcular la mediana se tiene que ordenar primero la muestra de datos de menor a mayor, tal que se cumpla con los estadísticos de orden. Así, la *mediana* en este ejemplo, que denotamos por $\tilde{x}$, viene dada por: </span>
<span id="cb37-291"><a href="#cb37-291" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-292"><a href="#cb37-292" aria-hidden="true" tabindex="-1"></a>\tilde{x} = y_4 = 1.2.</span>
<span id="cb37-293"><a href="#cb37-293" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-294"><a href="#cb37-294" aria-hidden="true" tabindex="-1"></a>Ahora bien, en este caso, tenemos un $n$ impar. Luego, es más fácil establecer la mediana. Supongamos ahora que tenemos un número par de cantidad de datos, un $n=6$, por ejemplo. </span>
<span id="cb37-295"><a href="#cb37-295" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-296"><a href="#cb37-296" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7, \quad x_2 = 1.2, \quad x_3 = 0.9, \quad x_4 = 0.6, \quad x_5 = 1.4, \quad x_6 = 1.8.</span>
<span id="cb37-297"><a href="#cb37-297" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-298"><a href="#cb37-298" aria-hidden="true" tabindex="-1"></a>Es decir, los mismos datos que antes, salvo que hemos excluido el valor más grande. Entonces los estadísticos de orden son: </span>
<span id="cb37-299"><a href="#cb37-299" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-300"><a href="#cb37-300" aria-hidden="true" tabindex="-1"></a>y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, \quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8.</span>
<span id="cb37-301"><a href="#cb37-301" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-302"><a href="#cb37-302" aria-hidden="true" tabindex="-1"></a>Y la mediana es: </span>
<span id="cb37-303"><a href="#cb37-303" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-304"><a href="#cb37-304" aria-hidden="true" tabindex="-1"></a>\tilde{x} = \frac{y_3 + y_4}{2} = \frac{0.9 + 1.2}{2} = 1.05.</span>
<span id="cb37-305"><a href="#cb37-305" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-306"><a href="#cb37-306" aria-hidden="true" tabindex="-1"></a>Por lo tanto, la mediana en este caso es el promedio simple entre los dos números ``al medio'' del conjunto de datos. Si tenemos que $n=6$, entonces la mediana es el promedio entre $x_3$ y $x_4$, arrojando un valor nuevo. En suma, la mediana es un valor que puede o no puede estar en el conjunto de datos. Si el conjunto de dato es par, entonces será el promedio simple entre los 2 datos del medio y si es impar simplemente será el valor del medio.  </span>
<span id="cb37-307"><a href="#cb37-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-308"><a href="#cb37-308" aria-hidden="true" tabindex="-1"></a>En R esto se obtiene con <span class="in">`median()`</span>:</span>
<span id="cb37-309"><a href="#cb37-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-310"><a href="#cb37-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r }</span></span>
<span id="cb37-311"><a href="#cb37-311" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: eg-median</span></span>
<span id="cb37-312"><a href="#cb37-312" aria-hidden="true" tabindex="-1"></a><span class="in">#| collapse: true</span></span>
<span id="cb37-313"><a href="#cb37-313" aria-hidden="true" tabindex="-1"></a><span class="in"># Obtener mediana a través de median()</span></span>
<span id="cb37-314"><a href="#cb37-314" aria-hidden="true" tabindex="-1"></a><span class="in">median(casen2022$ytrabajocor,</span></span>
<span id="cb37-315"><a href="#cb37-315" aria-hidden="true" tabindex="-1"></a><span class="in">     na.rm = TRUE) # Ingreso del trabajo corregido</span></span>
<span id="cb37-316"><a href="#cb37-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb37-317"><a href="#cb37-317" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-318"><a href="#cb37-318" aria-hidden="true" tabindex="-1"></a>Como vemos, la mediana de los ingresos del trabajo (salario), es 480.000 CLP. Lo cual habla bastante de la dispersión de los ingresos, pues el promedio  es de 667.690 CLP. Siguiendo la lógica de los estadísticos de orden, lo que tenemos es que el $50\%$ de los encuestados gana 480.000 CLP *o menos*. Y, sin embargo, el promedio es de 667.690 CLP, i.e., de 187.690 CLP más. Esto se debe a que hay ingresos muy altos, que elevan el promedio. Y la media es una medida *sensible* a los valores extremos. En breve, profundizaremos sobre esto, pero tiene que ver con robustez de las medidas de localización, lo cual será clave más adelante para para realizas **estimaciones** con estas medidas. </span>
<span id="cb37-319"><a href="#cb37-319" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-320"><a href="#cb37-320" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Moda   </span></span>
<span id="cb37-321"><a href="#cb37-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-322"><a href="#cb37-322" aria-hidden="true" tabindex="-1"></a>La *moda* es el valor más frecuente de un conjunto de observaciones. Un conjunto de valores puede tener más de una moda. Por ejemplo, supongamos que los datos son: </span>
<span id="cb37-323"><a href="#cb37-323" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-324"><a href="#cb37-324" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7; \quad x_2 = 1.2; \quad x_3 = 1.2; \quad x_4 = 0.6; \quad x_5 = 1.4; \quad x_6 = 1.8; \quad x_7 = 2.5.</span>
<span id="cb37-325"><a href="#cb37-325" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-326"><a href="#cb37-326" aria-hidden="true" tabindex="-1"></a>Entonces la moda, que denotaremos por $\tilde{\tilde{x}}$^<span class="co">[</span><span class="ot">El LaTex se coloca `\dbtilde{}`. No me deja en Quarto, pero colocar `\tilde{\tilde{x}}` es para representar que se denota con doble tilde</span><span class="co">]</span>, viene dada por: </span>
<span id="cb37-327"><a href="#cb37-327" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-328"><a href="#cb37-328" aria-hidden="true" tabindex="-1"></a>\tilde{\tilde{x}}= 1.2. </span>
<span id="cb37-329"><a href="#cb37-329" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-330"><a href="#cb37-330" aria-hidden="true" tabindex="-1"></a>Para un conjunto de valores puede haber más de una moda.</span>
<span id="cb37-331"><a href="#cb37-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-332"><a href="#cb37-332" aria-hidden="true" tabindex="-1"></a>En R, no hay un "paquete base" para extraer la moda. Pero si se puede hacer una función, o bien, usar paquetes. Veamos</span>
<span id="cb37-333"><a href="#cb37-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-336"><a href="#cb37-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-337"><a href="#cb37-337" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-mode</span></span>
<span id="cb37-338"><a href="#cb37-338" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-339"><a href="#cb37-339" aria-hidden="true" tabindex="-1"></a><span class="co"># Moda en el caso de datos unimodales discretos</span></span>
<span id="cb37-340"><a href="#cb37-340" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">1</span>)</span>
<span id="cb37-341"><a href="#cb37-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-342"><a href="#cb37-342" aria-hidden="true" tabindex="-1"></a><span class="co">#Función para calcular la moda</span></span>
<span id="cb37-343"><a href="#cb37-343" aria-hidden="true" tabindex="-1"></a>mode <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb37-344"><a href="#cb37-344" aria-hidden="true" tabindex="-1"></a>   <span class="fu">return</span>(<span class="fu">as.numeric</span>(<span class="fu">names</span>(<span class="fu">which.max</span>(<span class="fu">table</span>(x)))))</span>
<span id="cb37-345"><a href="#cb37-345" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-346"><a href="#cb37-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-347"><a href="#cb37-347" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(x)</span>
<span id="cb37-348"><a href="#cb37-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-349"><a href="#cb37-349" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>) <span class="co"># Para desactivar notación cientifica</span></span>
<span id="cb37-350"><a href="#cb37-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-351"><a href="#cb37-351" aria-hidden="true" tabindex="-1"></a><span class="fu">mode</span>(casen2022<span class="sc">$</span>ytrabajocor)</span>
<span id="cb37-352"><a href="#cb37-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-353"><a href="#cb37-353" aria-hidden="true" tabindex="-1"></a><span class="co"># Moda con mfv() de modeest</span></span>
<span id="cb37-354"><a href="#cb37-354" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(modeest)</span>
<span id="cb37-355"><a href="#cb37-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-356"><a href="#cb37-356" aria-hidden="true" tabindex="-1"></a>modeest<span class="sc">::</span><span class="fu">mfv</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na_rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-357"><a href="#cb37-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-358"><a href="#cb37-358" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-359"><a href="#cb37-359" aria-hidden="true" tabindex="-1"></a>Como se puede observar, la moda de los ingresos del trabajo es de 400.000 CLP. Es decir, que el valor que más se repite entre los salarios de los encuestados es de 400 lucas. </span>
<span id="cb37-360"><a href="#cb37-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-361"><a href="#cb37-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-362"><a href="#cb37-362" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.1.1. Robustez de las medidas de localización</span></span>
<span id="cb37-363"><a href="#cb37-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-364"><a href="#cb37-364" aria-hidden="true" tabindex="-1"></a>Ahora bien, **¿cuán robustas son las medidas de localización?** Un tema a considerar es cuál es el impacto de observaciones aberrantes en las medidas de localización, es decir, qué impacto tiene la presencia de una fracción pequeña de observaciones con errores muy grandes en su registro o que son atípicas por otro motivo en el valor de las medidas de localización.</span>
<span id="cb37-365"><a href="#cb37-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-366"><a href="#cb37-366" aria-hidden="true" tabindex="-1"></a>Hablaremos indistintamente de observaciones aberrantes, observaciones extrañas y *outliers*. Si el número de observaciones es pequeño, se puede investigar uno por uno los valores aberrantes y corregir, reemplazar o eliminar las observaciones en cuestión. Sin embargo, cuando el número de observaciones es más grande, uno quisiera medidas de localización que sean insensibles a la presencia de una fracción moderada de observaciones extrañas y que, al mismo tiempo, sean un buen resumen numérico de la tendencia central de los datos. Analicemos, pues, cuán robusta son estas medidas. </span>
<span id="cb37-367"><a href="#cb37-367" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-368"><a href="#cb37-368" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Robustez de la media</span></span>
<span id="cb37-369"><a href="#cb37-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-370"><a href="#cb37-370" aria-hidden="true" tabindex="-1"></a>Supongamos que los datos son </span>
<span id="cb37-371"><a href="#cb37-371" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-372"><a href="#cb37-372" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7;\ x_2 = 1.2;\ x_3 = 0.9;\ x_4 = 0.6;\ x_5 = 1.4;\ x_6 = 1.8;\ x_7 = 2.5.</span>
<span id="cb37-373"><a href="#cb37-373" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-374"><a href="#cb37-374" aria-hidden="true" tabindex="-1"></a>Como vimos la media viene dada por $\bar{x} = 1.3$. Intuitivamente la media **no** es robusta, pues un solo outlier puede tener un efecto devastador sobre su valor. En efecto, si una de las observaciones, digamos la primera, es reportada con un error de medición $e$, de modo que </span>
<span id="cb37-375"><a href="#cb37-375" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-376"><a href="#cb37-376" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7 + e</span>
<span id="cb37-377"><a href="#cb37-377" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-378"><a href="#cb37-378" aria-hidden="true" tabindex="-1"></a>entonces la media, como función del error $e$, será:</span>
<span id="cb37-379"><a href="#cb37-379" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-380"><a href="#cb37-380" aria-hidden="true" tabindex="-1"></a>\bar{x}(e) = 1.3 + \frac{e}{7}</span>
<span id="cb37-381"><a href="#cb37-381" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-382"><a href="#cb37-382" aria-hidden="true" tabindex="-1"></a>y tenemos que</span>
<span id="cb37-383"><a href="#cb37-383" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-384"><a href="#cb37-384" aria-hidden="true" tabindex="-1"></a>\lim_{e \to \infty} \bar{x}(e) = \infty, \quad \lim_{e \to -\infty} \bar{x}(e) = -\infty.</span>
<span id="cb37-385"><a href="#cb37-385" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-386"><a href="#cb37-386" aria-hidden="true" tabindex="-1"></a>En el caso más general tenemos $\bar{x}(e) = \bar{x}(0) + \frac{e}{n}$, de modo que esta expresión tiende a $\pm\infty$ cuando $e$ tiende a $\pm\infty$.</span>
<span id="cb37-387"><a href="#cb37-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-388"><a href="#cb37-388" aria-hidden="true" tabindex="-1"></a>En suma, la media es una medida de localización central **muy** sensible a valores atípicos/*outliers*. En este sentido, a pesar de que indica información, hay que tener cuidado y en general suele ser complementada con otras medidas, tal como vimos con la mediana.  </span>
<span id="cb37-389"><a href="#cb37-389" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-390"><a href="#cb37-390" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Robustez de la mediana</span></span>
<span id="cb37-391"><a href="#cb37-391" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-392"><a href="#cb37-392" aria-hidden="true" tabindex="-1"></a>Como vimos, los *estadísticos de orden* de las observaciones anteriores están dadas por: </span>
<span id="cb37-393"><a href="#cb37-393" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-394"><a href="#cb37-394" aria-hidden="true" tabindex="-1"></a>y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, \quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8, \quad y_7 = 2.5.</span>
<span id="cb37-395"><a href="#cb37-395" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-396"><a href="#cb37-396" aria-hidden="true" tabindex="-1"></a>Vimos también que la mediana, que denotamos por $\tilde{x}$, viene dada por: </span>
<span id="cb37-397"><a href="#cb37-397" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-398"><a href="#cb37-398" aria-hidden="true" tabindex="-1"></a>\tilde{x} = y_4 = 1.2.</span>
<span id="cb37-399"><a href="#cb37-399" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-400"><a href="#cb37-400" aria-hidden="true" tabindex="-1"></a>Ahora, suponiendo nuevamente que la primera observación se midió con error $e$, de modo que $x_1 = 0.7 + e$, y denotando por $\tilde{x}(e)$ la mediana cuando $x_1$ se reemplaza por $x_1 + e$, tenemos </span>
<span id="cb37-401"><a href="#cb37-401" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-402"><a href="#cb37-402" aria-hidden="true" tabindex="-1"></a>\tilde{x}(e) =</span>
<span id="cb37-403"><a href="#cb37-403" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb37-404"><a href="#cb37-404" aria-hidden="true" tabindex="-1"></a>    1.2 &amp; \text{si } e \leq 0.5, <span class="sc">\\</span></span>
<span id="cb37-405"><a href="#cb37-405" aria-hidden="true" tabindex="-1"></a>    0.7 + e &amp; \text{si } 0.5 &lt; e \leq 0.7, <span class="sc">\\</span></span>
<span id="cb37-406"><a href="#cb37-406" aria-hidden="true" tabindex="-1"></a>    1.4 &amp; \text{si } e &gt; 0.7.</span>
<span id="cb37-407"><a href="#cb37-407" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb37-408"><a href="#cb37-408" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-409"><a href="#cb37-409" aria-hidden="true" tabindex="-1"></a>En el caso general con $n = 2m+1$ observaciones, donde elegimos tamaño impar solo para simplificar las expresiones, tendremos que $\tilde{x}(e) \in <span class="co">[</span><span class="ot">y_m, y_{m+2}</span><span class="co">]</span>$. Por tanto, la influencia de un valor aberrante en la mediana está acotada. Es decir, la **mediana es una medida robusta**.   </span>
<span id="cb37-410"><a href="#cb37-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-411"><a href="#cb37-411" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Robustez de la moda  </span></span>
<span id="cb37-412"><a href="#cb37-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-413"><a href="#cb37-413" aria-hidden="true" tabindex="-1"></a>Supongamos que los datos están dados por:</span>
<span id="cb37-414"><a href="#cb37-414" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-415"><a href="#cb37-415" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7, \quad x_2 = 1.2, \quad x_3 = 1.2, \quad x_4 = 0.6, \quad x_5 = 1.4, \quad x_6 = 1.8, \quad x_7 = 99.9.</span>
<span id="cb37-416"><a href="#cb37-416" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-417"><a href="#cb37-417" aria-hidden="true" tabindex="-1"></a>Entonces la moda viene dada por $\tilde{\tilde{x}} = 1.2$.</span>
<span id="cb37-418"><a href="#cb37-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-419"><a href="#cb37-419" aria-hidden="true" tabindex="-1"></a>Suponiendo nuevamente que la primera observación se midió con error $e$, de modo que $x_1 = 0.7 + e$, y denotando por $\tilde{\tilde{x}}(e)$ la moda cuando $x_1$ se reemplaza por $x_1 + e$, tenemos que:</span>
<span id="cb37-420"><a href="#cb37-420" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-421"><a href="#cb37-421" aria-hidden="true" tabindex="-1"></a>\lim_{e \to \infty} \tilde{\tilde{x}}(e) = 1.2, \quad \lim_{e \to -\infty} \tilde{\tilde{x}}(e) = 1.2.</span>
<span id="cb37-422"><a href="#cb37-422" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-423"><a href="#cb37-423" aria-hidden="true" tabindex="-1"></a>En cambio, si la observación con error es la segunda observación, de modo que se midió $x_2 = 1.2 + e$, para $e = 0.6$, la moda será $1.8$. El cambio en la moda puede ser mucho mayor, existen valores de $e$ para los cuales la moda es $99.9$. En contraste, no existen valores de $e$ para los cuales la mediana cambie tanto.En suma, la moda es **muy** sensible a la presencia de *outliers*, no obstante va depende en qué localización de los datos se encuentre. Entonces, no siempre es muy sensible, pero a veces sí.   </span>
<span id="cb37-424"><a href="#cb37-424" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-425"><a href="#cb37-425" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Sintesis </span></span>
<span id="cb37-426"><a href="#cb37-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-427"><a href="#cb37-427" aria-hidden="true" tabindex="-1"></a>Como se desprende de las expresiones derivadas en los apartados anteriores, el impacto de valores extremos o atípicos es acotado tanto para la mediana como para la moda, mientras que para la media crece sin límite cuando $|e|$ tiende a infinito.Al mismo tiempo, la mediana pareciera ser más robusta que la moda, pues la influencia de errores de medición es menor. La moda pareciera estar entremedio, el impacto de outliers es acotado pero puede ser mucho más grande que su impacto en la mediana. Entonces, **¿media, mediana o moda?**</span>
<span id="cb37-428"><a href="#cb37-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-429"><a href="#cb37-429" aria-hidden="true" tabindex="-1"></a>En general, la moda se usa poco para resumir en una cifra la localización de los datos. Probablemente, porque es “demasiado localizada”. Por ejemplo, puede que la moda esté en 0, porque un 10% de las observaciones son iguales a cero, pero la mayoría de los datos sean mayores que 100. En casos como este la moda captura muy mal la localización de los datos, pues uno quisiera algún número mayor que 100, no cero. La media es la medida de localización más utilizada en la práctica, seguida de la mediana. Esto nos lleva a considerar las siguientes ventajas y desventajas</span>
<span id="cb37-430"><a href="#cb37-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-431"><a href="#cb37-431" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Mediana**: más robusta.</span>
<span id="cb37-432"><a href="#cb37-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-433"><a href="#cb37-433" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Media**: usa toda la información. Al menos intuitivamente, la robustez de la mediana tiene como contraparte que usa poco la información disponible.</span>
<span id="cb37-434"><a href="#cb37-434" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-435"><a href="#cb37-435" aria-hidden="true" tabindex="-1"></a>Entonces, la media entrega más información, pero es menos robusta, en cambio la mediana sufre la ventaja/desventaja opuesta. La digresión anterior motiva considerar medidas de localización más robustas que la media y que usan más información que la mediana. Con ese objetivo consideramos a continuación **las medias podadas**.  </span>
<span id="cb37-436"><a href="#cb37-436" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-437"><a href="#cb37-437" aria-hidden="true" tabindex="-1"></a><span class="fu">### Medias podadas </span></span>
<span id="cb37-438"><a href="#cb37-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-439"><a href="#cb37-439" aria-hidden="true" tabindex="-1"></a>Supongamos que los datos están dado por:</span>
<span id="cb37-440"><a href="#cb37-440" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-441"><a href="#cb37-441" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7, \; x_2 = 1.2, \; x_3 = 0.9, \; x_4 = 0.6, \; x_5 = 1.4, \; x_6 = 1.8, \; x_7 = 2.5,</span>
<span id="cb37-442"><a href="#cb37-442" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-443"><a href="#cb37-443" aria-hidden="true" tabindex="-1"></a>Como vimos, sus estadísticos de orden correspondientes son:</span>
<span id="cb37-444"><a href="#cb37-444" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-445"><a href="#cb37-445" aria-hidden="true" tabindex="-1"></a>y_1 = 0.6, \; y_2 = 0.7, \; y_3 = 0.9, \; y_4 = 1.2, \; y_5 = 1.4, \; y_6 = 1.8, \; y_7 = 2.5.</span>
<span id="cb37-446"><a href="#cb37-446" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-447"><a href="#cb37-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-448"><a href="#cb37-448" aria-hidden="true" tabindex="-1"></a>Definimos la siguiente medida de localización:</span>
<span id="cb37-449"><a href="#cb37-449" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-450"><a href="#cb37-450" aria-hidden="true" tabindex="-1"></a>\bar{x}^p = \frac{1}{5}(y_2 + y_3 + \dots + y_6).</span>
<span id="cb37-451"><a href="#cb37-451" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-452"><a href="#cb37-452" aria-hidden="true" tabindex="-1"></a>Es decir, primero **podamos** los datos de la muestra ordenada de menor a mayor, removiendo un valor de cada extremo y luego calculamos el promedio de las observaciones podadas. El estadístico descriptivo que resulta se conoce como *media podada*, de nivel $k=1$ porque removimos una observación de cada extremo. Lo denominamos por $\bar{x}^p$. Para las observaciones en cuestión tenemos que la media podada de nivel 1 es 1,2.</span>
<span id="cb37-453"><a href="#cb37-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-454"><a href="#cb37-454" aria-hidden="true" tabindex="-1"></a>En síntesis, se eliminan los valores extremos, el más pequeño y el más grande en este caso. Y después calculamos el promedio. Con ello, se le agrega mayor robustez y estaremos usando más información que usando la mediana. Veamos el caso general, no solo para $k=1$</span>
<span id="cb37-455"><a href="#cb37-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-456"><a href="#cb37-456" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Medias podadas: Caso General </span></span>
<span id="cb37-457"><a href="#cb37-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-458"><a href="#cb37-458" aria-hidden="true" tabindex="-1"></a>:::{.definition}</span>
<span id="cb37-459"><a href="#cb37-459" aria-hidden="true" tabindex="-1"></a> Sean $x_1, \dots, x_n$ las observaciones y $y_1, \dots, y_n$ los estadísticos de orden correspondientes. Entonces, para $k &lt; n/2$ definimos la media podada de nivel $k$ mediante: </span>
<span id="cb37-460"><a href="#cb37-460" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-461"><a href="#cb37-461" aria-hidden="true" tabindex="-1"></a>    \bar{x}^p = \frac{1}{n - 2k} \sum_{i = k+1}^{n-k} y_i.</span>
<span id="cb37-462"><a href="#cb37-462" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-463"><a href="#cb37-463" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-464"><a href="#cb37-464" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-465"><a href="#cb37-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-466"><a href="#cb37-466" aria-hidden="true" tabindex="-1"></a>En palabras: dadas observaciones $x_1, \dots, x_n$, la media podada de nivel $k$ será el promedio de los valores que se obtiene luego de remover $k$ observaciones de cada uno de sus extremos (las $k$ más grandes y las $k$ más pequeñas). Las medias podadas de nivel $k = 1$ —se remueve el mínimo y máximo— se utilizan para pasar de las evaluaciones individuales de los jurados en varios deportes, entre ellos nado sincronizado y gimnasia, a la evaluación agregada.</span>
<span id="cb37-467"><a href="#cb37-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-468"><a href="#cb37-468" aria-hidden="true" tabindex="-1"></a>En R, esto se puede hacer de dos formas, con una función o con <span class="in">`mean()`</span> y especificaciones: </span>
<span id="cb37-469"><a href="#cb37-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-472"><a href="#cb37-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-473"><a href="#cb37-473" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-media-podada</span></span>
<span id="cb37-474"><a href="#cb37-474" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-475"><a href="#cb37-475" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb37-476"><a href="#cb37-476" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb37-477"><a href="#cb37-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-478"><a href="#cb37-478" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Función manual para media podada de nivel k</span></span>
<span id="cb37-479"><a href="#cb37-479" aria-hidden="true" tabindex="-1"></a>media_podada <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k) {</span>
<span id="cb37-480"><a href="#cb37-480" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb37-481"><a href="#cb37-481" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="dv">2</span><span class="sc">*</span>k <span class="sc">&gt;=</span> n) <span class="fu">stop</span>(<span class="st">"k debe ser menor que n/2"</span>)</span>
<span id="cb37-482"><a href="#cb37-482" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb37-483"><a href="#cb37-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(y[(k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(n <span class="sc">-</span> k)])</span>
<span id="cb37-484"><a href="#cb37-484" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-485"><a href="#cb37-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-486"><a href="#cb37-486" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la media podada para k = 1</span></span>
<span id="cb37-487"><a href="#cb37-487" aria-hidden="true" tabindex="-1"></a><span class="fu">media_podada</span>(x, <span class="dv">1</span>)</span>
<span id="cb37-488"><a href="#cb37-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-489"><a href="#cb37-489" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Usando la función base mean() con el argumento trim</span></span>
<span id="cb37-490"><a href="#cb37-490" aria-hidden="true" tabindex="-1"></a><span class="co">#    trim espera la fracción a recortar por cada extremo: k/n</span></span>
<span id="cb37-491"><a href="#cb37-491" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb37-492"><a href="#cb37-492" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb37-493"><a href="#cb37-493" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x, <span class="at">trim =</span> k <span class="sc">/</span> n)</span>
<span id="cb37-494"><a href="#cb37-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-495"><a href="#cb37-495" aria-hidden="true" tabindex="-1"></a><span class="co"># Media podada de los ingresos del trabajo</span></span>
<span id="cb37-496"><a href="#cb37-496" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(casen2022<span class="sc">$</span>ytrabajocor, </span>
<span id="cb37-497"><a href="#cb37-497" aria-hidden="true" tabindex="-1"></a>     <span class="at">trim =</span> k<span class="sc">/</span>n,</span>
<span id="cb37-498"><a href="#cb37-498" aria-hidden="true" tabindex="-1"></a>     <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb37-499"><a href="#cb37-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-500"><a href="#cb37-500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-501"><a href="#cb37-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-502"><a href="#cb37-502" aria-hidden="true" tabindex="-1"></a><span class="fu">### Medias Windorizadas (opcional) </span></span>
<span id="cb37-503"><a href="#cb37-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-504"><a href="#cb37-504" aria-hidden="true" tabindex="-1"></a>Esto es una medición opcional en el sentido de que no se usa mucho. Pero puede ser útil. Supongamos que los datos están dado por:</span>
<span id="cb37-505"><a href="#cb37-505" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-506"><a href="#cb37-506" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7; \, x_2 = 1.2; \, x_3 = 0.9; \, x_4 = 0.6; \, x_5 = 1.4; \, x_6 = 1.8; \, x_7 = 2.5.</span>
<span id="cb37-507"><a href="#cb37-507" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-508"><a href="#cb37-508" aria-hidden="true" tabindex="-1"></a>Como vimos, sus estadísticos de orden correspondientes son: </span>
<span id="cb37-509"><a href="#cb37-509" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-510"><a href="#cb37-510" aria-hidden="true" tabindex="-1"></a>y_1 = 0.6, \, y_2 = 0.7, \, y_3 = 0.9, \, y_4 = 1.2, \, y_5 = 1.4, \, y_6 = 1.8, \, y_7 = 2.5.</span>
<span id="cb37-511"><a href="#cb37-511" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-512"><a href="#cb37-512" aria-hidden="true" tabindex="-1"></a>Definimos la siguiente medida de localización:</span>
<span id="cb37-513"><a href="#cb37-513" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-514"><a href="#cb37-514" aria-hidden="true" tabindex="-1"></a>\bar{x}^p = \frac{1}{7} <span class="co">[</span><span class="ot">y_2 + y_2 + y_3 + y_4 + y_5 + y_6 + y_6</span><span class="co">]</span>.</span>
<span id="cb37-515"><a href="#cb37-515" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-516"><a href="#cb37-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-517"><a href="#cb37-517" aria-hidden="true" tabindex="-1"></a>Es decir, ordenadas las observaciones de menor a mayor, sustituimos un valor de cada extremo por el valor inmediatamente anterior o posterior y luego calculamos el promedio de todos los valores. El estadístico descriptivo que resulta se conoce como **media winsorizada**, de nivel $k = 1$ porque sustituimos una observación de cada extremo. Lo denotamos por $\bar{x}^w$. Para las observaciones en cuestión tenemos que la media winsorizada de nivel 1 es 1,21 (aproximadamente).</span>
<span id="cb37-518"><a href="#cb37-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-519"><a href="#cb37-519" aria-hidden="true" tabindex="-1"></a>:::{.definition}</span>
<span id="cb37-520"><a href="#cb37-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-521"><a href="#cb37-521" aria-hidden="true" tabindex="-1"></a>**Medias Winsorizadas: Caso General**</span>
<span id="cb37-522"><a href="#cb37-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-523"><a href="#cb37-523" aria-hidden="true" tabindex="-1"></a>Sean $x_1, \dots, x_n$ las observaciones y $y_1, \dots, y_n$ los estadísticos de orden correspondientes. Entonces, para $k &lt; n/2$ definimos la media winsorizada de nivel $k$ mediante:</span>
<span id="cb37-524"><a href="#cb37-524" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-525"><a href="#cb37-525" aria-hidden="true" tabindex="-1"></a>  \bar{x}^w = \frac{k y_{k+1} + \sum_{i=k+1}^{n-k} y_i + k y_{n-k}}{n}.</span>
<span id="cb37-526"><a href="#cb37-526" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-527"><a href="#cb37-527" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-528"><a href="#cb37-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-529"><a href="#cb37-529" aria-hidden="true" tabindex="-1"></a>En palabras: dadas observaciones $x_1, \dots, x_n$, la media winsorizada de nivel $k$ será el promedio de los valores que se obtiene luego de sustituir $k$ observaciones de cada uno de sus extremos (las $k$ más grandes y las $k$ más pequeñas) por el valor inmediatamente anterior o posterior. En R, se puede hacer con funciones nuevamente, o con el paquete <span class="in">`DescTools`</span>.</span>
<span id="cb37-530"><a href="#cb37-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-533"><a href="#cb37-533" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-534"><a href="#cb37-534" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-media-winsorizada</span></span>
<span id="cb37-535"><a href="#cb37-535" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-536"><a href="#cb37-536" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb37-537"><a href="#cb37-537" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb37-538"><a href="#cb37-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-539"><a href="#cb37-539" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Función winsorizada + argumento na.rm</span></span>
<span id="cb37-540"><a href="#cb37-540" aria-hidden="true" tabindex="-1"></a>media_winsorizada <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k, <span class="at">na.rm =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb37-541"><a href="#cb37-541" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (na.rm) x <span class="ot">&lt;-</span> x[<span class="sc">!</span><span class="fu">is.na</span>(x)]</span>
<span id="cb37-542"><a href="#cb37-542" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb37-543"><a href="#cb37-543" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="dv">2</span><span class="sc">*</span>k <span class="sc">&gt;=</span> n) <span class="fu">stop</span>(<span class="st">"k debe ser menor que n/2"</span>)</span>
<span id="cb37-544"><a href="#cb37-544" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb37-545"><a href="#cb37-545" aria-hidden="true" tabindex="-1"></a>  <span class="co"># sustituir k extremos</span></span>
<span id="cb37-546"><a href="#cb37-546" aria-hidden="true" tabindex="-1"></a>  y[<span class="dv">1</span><span class="sc">:</span>k]           <span class="ot">&lt;-</span> y[k <span class="sc">+</span> <span class="dv">1</span>]</span>
<span id="cb37-547"><a href="#cb37-547" aria-hidden="true" tabindex="-1"></a>  y[(n <span class="sc">-</span> k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n] <span class="ot">&lt;-</span> y[n <span class="sc">-</span> k]</span>
<span id="cb37-548"><a href="#cb37-548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(y)</span>
<span id="cb37-549"><a href="#cb37-549" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-550"><a href="#cb37-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-551"><a href="#cb37-551" aria-hidden="true" tabindex="-1"></a><span class="co"># Cálculo de la media winsorizada para k = 1</span></span>
<span id="cb37-552"><a href="#cb37-552" aria-hidden="true" tabindex="-1"></a><span class="fu">media_winsorizada</span>(x, <span class="dv">1</span>)</span>
<span id="cb37-553"><a href="#cb37-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-554"><a href="#cb37-554" aria-hidden="true" tabindex="-1"></a><span class="fu">media_winsorizada</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="dv">1</span>,</span>
<span id="cb37-555"><a href="#cb37-555" aria-hidden="true" tabindex="-1"></a>                  <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb37-556"><a href="#cb37-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-557"><a href="#cb37-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-558"><a href="#cb37-558" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Usando la función Winsorize() del paquete DescTools</span></span>
<span id="cb37-559"><a href="#cb37-559" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(DescTools)</span>
<span id="cb37-560"><a href="#cb37-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-561"><a href="#cb37-561" aria-hidden="true" tabindex="-1"></a><span class="co">#  Vector limpio de NAs</span></span>
<span id="cb37-562"><a href="#cb37-562" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(casen2022<span class="sc">$</span>ytrabajocor)</span>
<span id="cb37-563"><a href="#cb37-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-564"><a href="#cb37-564" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Definimos k y calculamos n</span></span>
<span id="cb37-565"><a href="#cb37-565" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb37-566"><a href="#cb37-566" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb37-567"><a href="#cb37-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-568"><a href="#cb37-568" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Calculamos los cuantiles que usarán de umbrales</span></span>
<span id="cb37-569"><a href="#cb37-569" aria-hidden="true" tabindex="-1"></a>umbrales <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="at">probs =</span> <span class="fu">c</span>(k<span class="sc">/</span>n, <span class="dv">1</span> <span class="sc">-</span> k<span class="sc">/</span>n), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-570"><a href="#cb37-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-571"><a href="#cb37-571" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Winsorizamos usando 'val = umbrales'</span></span>
<span id="cb37-572"><a href="#cb37-572" aria-hidden="true" tabindex="-1"></a>x_wins <span class="ot">&lt;-</span> <span class="fu">Winsorize</span>(x, <span class="at">val =</span> umbrales)</span>
<span id="cb37-573"><a href="#cb37-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-574"><a href="#cb37-574" aria-hidden="true" tabindex="-1"></a><span class="co"># 6) Y finalmente sacamos la media</span></span>
<span id="cb37-575"><a href="#cb37-575" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x_wins)</span>
<span id="cb37-576"><a href="#cb37-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-577"><a href="#cb37-577" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-578"><a href="#cb37-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-579"><a href="#cb37-579" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Síntesis </span></span>
<span id="cb37-580"><a href="#cb37-580" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-581"><a href="#cb37-581" aria-hidden="true" tabindex="-1"></a>¿Qué hacemos en la práctica?</span>
<span id="cb37-582"><a href="#cb37-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-583"><a href="#cb37-583" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si se desea resumir la localización de los datos, parta por calcular la media, mediana y moda, así como también las medias podadas para algunos valores de $k$ (por ejemplo, $k/n \simeq 0,05$ y $k/n \simeq 0,1$)</span>
<span id="cb37-584"><a href="#cb37-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-585"><a href="#cb37-585" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si obtiene valores similares, reportar la media y mediana</span>
<span id="cb37-586"><a href="#cb37-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-587"><a href="#cb37-587" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si hay diferencias importantes, mire los datos con cuidado, entienda de dónde vienen las diferencias y luego decida qué hacer.</span>
<span id="cb37-588"><a href="#cb37-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-589"><a href="#cb37-589" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.2. Medidas de dispersión</span></span>
<span id="cb37-590"><a href="#cb37-590" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-591"><a href="#cb37-591" aria-hidden="true" tabindex="-1"></a><span class="fu">### La varianza</span></span>
<span id="cb37-592"><a href="#cb37-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-593"><a href="#cb37-593" aria-hidden="true" tabindex="-1"></a>Las medidas de dispersión lo que buscan es determinar cuán dispersos están los datos con respectos a una medida de tendencia central. Una de ellas es la varianza. La **varianza** es una medida que resume la **dispersión de las observaciones _con respecto_ a su media**.</span>
<span id="cb37-594"><a href="#cb37-594" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-595"><a href="#cb37-595" aria-hidden="true" tabindex="-1"></a>:::{.definition}</span>
<span id="cb37-596"><a href="#cb37-596" aria-hidden="true" tabindex="-1"></a>Dadas $n$ observaciones, $x_1, \ldots, x_n$, la varianza de este conjunto de datos, que denotaremos por $\hat{\sigma}^2$, está dada por:</span>
<span id="cb37-597"><a href="#cb37-597" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-598"><a href="#cb37-598" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-599"><a href="#cb37-599" aria-hidden="true" tabindex="-1"></a>\hat{\sigma}^2 &amp;= \frac{(x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 + \dots + (x_n - \bar{x})^2}{n}<span class="sc">\\</span></span>
<span id="cb37-600"><a href="#cb37-600" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n} \sum_{i=1}^{n} (x_i - \bar{x})^2 <span class="sc">\\</span></span>
<span id="cb37-601"><a href="#cb37-601" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n} \sum_{i=1}^{n} x_i^2 - \bar{x}^2.</span>
<span id="cb37-602"><a href="#cb37-602" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-603"><a href="#cb37-603" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-604"><a href="#cb37-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-605"><a href="#cb37-605" aria-hidden="true" tabindex="-1"></a>:::  </span>
<span id="cb37-606"><a href="#cb37-606" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-607"><a href="#cb37-607" aria-hidden="true" tabindex="-1"></a>Por ejemplo, si tuvieramos que</span>
<span id="cb37-608"><a href="#cb37-608" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-609"><a href="#cb37-609" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7; \quad x_2 = 1.2; \quad x_3 = 0.9; \quad x_4 = 0.6; \quad x_5 = 1.4; \quad x_6 = 1.8; \quad x_7 = 2.5,</span>
<span id="cb37-610"><a href="#cb37-610" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-611"><a href="#cb37-611" aria-hidden="true" tabindex="-1"></a>entonces, la varianza de estos datos sería </span>
<span id="cb37-612"><a href="#cb37-612" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-613"><a href="#cb37-613" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-614"><a href="#cb37-614" aria-hidden="true" tabindex="-1"></a>  \hat{\sigma}^2 = \frac{(0.7 - 1.3)^2 + (1.2 - 1.3)^2 + (0.9 - 1.3)^2}{7} <span class="sc">\\</span></span>
<span id="cb37-615"><a href="#cb37-615" aria-hidden="true" tabindex="-1"></a><span class="ss">  + </span>\frac{(0.6 - 1.3)^2 + (1.4 - 1.3)^2 + (1.8 - 1.3)^2 + (2.5 - 1.3)^2}{7} = 0.39.</span>
<span id="cb37-616"><a href="#cb37-616" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-617"><a href="#cb37-617" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-618"><a href="#cb37-618" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-619"><a href="#cb37-619" aria-hidden="true" tabindex="-1"></a>Ojo,cuando hay muchos datos, la fórmula más simple es el promedio de las observaciones al cuadrado, menos la media al cuadrado. O sea, la última igualdad que pusimos anteriormente, es decir,  </span>
<span id="cb37-620"><a href="#cb37-620" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-621"><a href="#cb37-621" aria-hidden="true" tabindex="-1"></a>  \hat{\sigma}^2 =\frac{1}{n} \sum_{i=1}^{n} x_i^2 - \bar{x}^2.</span>
<span id="cb37-622"><a href="#cb37-622" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-623"><a href="#cb37-623" aria-hidden="true" tabindex="-1"></a>Esta, sin embargo, es una demostración de la primera sumatoria, aunque bastante trivial.</span>
<span id="cb37-624"><a href="#cb37-624" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-625"><a href="#cb37-625" aria-hidden="true" tabindex="-1"></a>:::{.proof}</span>
<span id="cb37-626"><a href="#cb37-626" aria-hidden="true" tabindex="-1"></a>Si</span>
<span id="cb37-627"><a href="#cb37-627" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-628"><a href="#cb37-628" aria-hidden="true" tabindex="-1"></a>\frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2 = \frac{1}{n} \sum_{i=1}^n x_i^2 - \bar{x}^2</span>
<span id="cb37-629"><a href="#cb37-629" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-630"><a href="#cb37-630" aria-hidden="true" tabindex="-1"></a>En efecto,</span>
<span id="cb37-631"><a href="#cb37-631" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-632"><a href="#cb37-632" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-633"><a href="#cb37-633" aria-hidden="true" tabindex="-1"></a>\frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2 &amp;= \frac{1}{n} \sum_{i=1}^n \left( x_i^2 - 2x_i \bar{x} + \bar{x}^2 \right)<span class="sc">\\</span></span>
<span id="cb37-634"><a href="#cb37-634" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n} \sum_{i=1}^n x_i^2 - 2 \bar{x} \frac{1}{n} \sum_{i=1}^n x_i + \frac{1}{n} \sum_{i=1}^n \bar{x}^2<span class="sc">\\</span></span>
<span id="cb37-635"><a href="#cb37-635" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n} \sum_{i=1}^n x_i^2 - 2 \bar{x}^2 + \bar{x}^2<span class="sc">\\</span></span>
<span id="cb37-636"><a href="#cb37-636" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n} \sum_{i=1}^n x_i^2 - \bar{x}^2. </span>
<span id="cb37-637"><a href="#cb37-637" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-638"><a href="#cb37-638" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-639"><a href="#cb37-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-640"><a href="#cb37-640" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb37-641"><a href="#cb37-641" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-642"><a href="#cb37-642" aria-hidden="true" tabindex="-1"></a>En R es mucho más fácil que estos cálculos tediosos. Esto se hace con el comando de R Base <span class="in">`var()`</span>. No obstante, hay que tener en cuenta que <span class="in">`var()`</span> es por defecto la varianaza muestra. Asumiendo que tenemos datos poblaciales podemos hacer dos cosas^<span class="co">[</span><span class="ot">Esto no lo haré para los datos muestrales de la CASEN 2022. Principalmente, porque para eso usaremos, más adelante, paquetes especializados, como `survey` y `srvyr`</span><span class="co">]</span>. Veamos cómo: </span>
<span id="cb37-643"><a href="#cb37-643" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-646"><a href="#cb37-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-647"><a href="#cb37-647" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-varianza</span></span>
<span id="cb37-648"><a href="#cb37-648" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-649"><a href="#cb37-649" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb37-650"><a href="#cb37-650" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb37-651"><a href="#cb37-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-652"><a href="#cb37-652" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza poblacional</span></span>
<span id="cb37-653"><a href="#cb37-653" aria-hidden="true" tabindex="-1"></a>var_poblacional <span class="ot">&lt;-</span> <span class="fu">mean</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb37-654"><a href="#cb37-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-655"><a href="#cb37-655" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza simplificada</span></span>
<span id="cb37-656"><a href="#cb37-656" aria-hidden="true" tabindex="-1"></a>var_pobl_simplificada <span class="ot">&lt;-</span> <span class="fu">mean</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">mean</span>(x)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb37-657"><a href="#cb37-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-658"><a href="#cb37-658" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza muestral</span></span>
<span id="cb37-659"><a href="#cb37-659" aria-hidden="true" tabindex="-1"></a>var_muestral <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb37-660"><a href="#cb37-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-661"><a href="#cb37-661" aria-hidden="true" tabindex="-1"></a><span class="co"># Varianza muestral de casen2022$ytrabajocor</span></span>
<span id="cb37-662"><a href="#cb37-662" aria-hidden="true" tabindex="-1"></a>var_casen_muestral <span class="ot">&lt;-</span> <span class="fu">var</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-663"><a href="#cb37-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-664"><a href="#cb37-664" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb37-665"><a href="#cb37-665" aria-hidden="true" tabindex="-1"></a>var_poblacional</span>
<span id="cb37-666"><a href="#cb37-666" aria-hidden="true" tabindex="-1"></a>var_pobl_simplificada</span>
<span id="cb37-667"><a href="#cb37-667" aria-hidden="true" tabindex="-1"></a>var_muestral</span>
<span id="cb37-668"><a href="#cb37-668" aria-hidden="true" tabindex="-1"></a>var_casen_muestral</span>
<span id="cb37-669"><a href="#cb37-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-670"><a href="#cb37-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-671"><a href="#cb37-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-672"><a href="#cb37-672" aria-hidden="true" tabindex="-1"></a><span class="fu">### La desviación estándar</span></span>
<span id="cb37-673"><a href="#cb37-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-674"><a href="#cb37-674" aria-hidden="true" tabindex="-1"></a>Una vez se tiene la varianza, la desviación estándar es muy fácil de calcular, pues es simplemente la raíz cuadrada de la varianza. La *desviación estándar* también es una medida de dispersión de los elementos del conjunto de observaciones con respecto a su media. </span>
<span id="cb37-675"><a href="#cb37-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-676"><a href="#cb37-676" aria-hidden="true" tabindex="-1"></a>Dadas $n$ observaciones, $x_1, \ldots, x_n $, la desviación estándar de este conjunto de datos, que denotaremos por $\hat{\sigma}$, está dada por la raíz cuadrada de la varianza:</span>
<span id="cb37-677"><a href="#cb37-677" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-678"><a href="#cb37-678" aria-hidden="true" tabindex="-1"></a>\hat{\sigma} = \sqrt{\hat{\sigma}^2} = \sqrt{\frac{(x_1 - \bar{x})^2 + (x_2 - \bar{x})^2 + \ldots + (x_n - \bar{x})^2}{n}} = \sqrt{\frac{1}{n} \sum_{i=1}^{n} (x_i - \bar{x})^2}.</span>
<span id="cb37-679"><a href="#cb37-679" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-680"><a href="#cb37-680" aria-hidden="true" tabindex="-1"></a>Por ejemplo, si </span>
<span id="cb37-681"><a href="#cb37-681" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-682"><a href="#cb37-682" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7; \, x_2 = 1.2; \, x_3 = 0.9; \, x_4 = 0.6; \, x_5 = 1.4; \, x_6 = 1.8; \, x_7 = 2.5,</span>
<span id="cb37-683"><a href="#cb37-683" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-684"><a href="#cb37-684" aria-hidden="true" tabindex="-1"></a>entonces, la desviación estándar de estos datos es: $\hat{\sigma} = 0.62$. A diferencia de lo que ocurre con la varianza, la desviación estándar está medida en las mismas unidades que el conjunto de observaciones bajo análisis. Como veremos más adelante, esto hace que su interpretación sea más fácil y explica por qué se usa más que la varianza como medida de dispersión. Por lo tanto, la ventaja principal es esa. La desviación estándar está medida en las mismas unidades que las observaciones que estamos trabajando, y no así la varianza. En R es muy simple de hacer, con <span class="in">`sd()`</span>. Al igual que con <span class="in">`var()`</span>, <span class="in">`sd()`</span> calcula por defecto al desviación estándar muestral. </span>
<span id="cb37-685"><a href="#cb37-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-688"><a href="#cb37-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-689"><a href="#cb37-689" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-desviacion-estandar</span></span>
<span id="cb37-690"><a href="#cb37-690" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-691"><a href="#cb37-691" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb37-692"><a href="#cb37-692" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb37-693"><a href="#cb37-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-694"><a href="#cb37-694" aria-hidden="true" tabindex="-1"></a><span class="co"># Desviación estándar poblacional</span></span>
<span id="cb37-695"><a href="#cb37-695" aria-hidden="true" tabindex="-1"></a>sd_poblacional <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>((x <span class="sc">-</span> <span class="fu">mean</span>(x))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb37-696"><a href="#cb37-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-697"><a href="#cb37-697" aria-hidden="true" tabindex="-1"></a><span class="co"># Desviación estándar simplificada</span></span>
<span id="cb37-698"><a href="#cb37-698" aria-hidden="true" tabindex="-1"></a>sd_simplificada <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">mean</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">mean</span>(x)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb37-699"><a href="#cb37-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-700"><a href="#cb37-700" aria-hidden="true" tabindex="-1"></a><span class="co"># Desviación estándar muestral</span></span>
<span id="cb37-701"><a href="#cb37-701" aria-hidden="true" tabindex="-1"></a>sd_muestral <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb37-702"><a href="#cb37-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-703"><a href="#cb37-703" aria-hidden="true" tabindex="-1"></a><span class="co"># Desviación estándar muestral de casen2022$ytrabajocor</span></span>
<span id="cb37-704"><a href="#cb37-704" aria-hidden="true" tabindex="-1"></a>sd_casen_muestral <span class="ot">&lt;-</span> <span class="fu">sd</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-705"><a href="#cb37-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-706"><a href="#cb37-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-707"><a href="#cb37-707" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb37-708"><a href="#cb37-708" aria-hidden="true" tabindex="-1"></a>sd_poblacional</span>
<span id="cb37-709"><a href="#cb37-709" aria-hidden="true" tabindex="-1"></a>sd_simplificada</span>
<span id="cb37-710"><a href="#cb37-710" aria-hidden="true" tabindex="-1"></a>sd_muestral</span>
<span id="cb37-711"><a href="#cb37-711" aria-hidden="true" tabindex="-1"></a>sd_casen_muestral</span>
<span id="cb37-712"><a href="#cb37-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-713"><a href="#cb37-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-714"><a href="#cb37-714" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-715"><a href="#cb37-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-716"><a href="#cb37-716" aria-hidden="true" tabindex="-1"></a>Considerando la desviación estándar es una medida de dispersión que describe la descripción de los datos en las mismas unidades que el conjunto de observaciones nos sirve para comparar ahora <span class="in">`var_casen_muestral`</span> con <span class="in">`sd_casen_muestral`</span>. En el primer caso, <span class="in">`var_casen_muestral = 665844368478`</span>, significa simplemente que la varianza de los datos es de ese valor, esa es su varianza. En cambio, <span class="in">`sd_casen_muestral = 815992.9`</span> implica que la variación de los datos es de 815.992 CLP, pues la variable <span class="in">`ytrabajocor`</span> mide pesos chilenos. En el caso de la varianza, nos dice cuán dispersos están los datos respecto a la media. En el caso de la desviación estándar, es también una medida de dispersión de los elementos del conjunto de observaciones con respecto a su media, pero que está en las unidades de la variable en cuestión, es decir, que hay una dispersión de los datos de 815.992 CLP respecto de la media (667.690 CLP, como habíamos visto). Por cierto, los valores elevados de dispersión son típicos en los ingresos, pues dada la desigualdad en estos, suelen tener una alta dispersión los datos de ingresos. </span>
<span id="cb37-717"><a href="#cb37-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-718"><a href="#cb37-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-719"><a href="#cb37-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-720"><a href="#cb37-720" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1.2.1. Robustez en las medidas de dispersión </span></span>
<span id="cb37-721"><a href="#cb37-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-722"><a href="#cb37-722" aria-hidden="true" tabindex="-1"></a>Ahora bien, **¿cuál es más robusta?** La *desviación estándar muestral* y la *varianza muestral* no son medidas robustas de la dispersión de los datos. Aunque el álgebra es un poco más complejo, el problema es similar al que vimos con la media muestral.</span>
<span id="cb37-723"><a href="#cb37-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-724"><a href="#cb37-724" aria-hidden="true" tabindex="-1"></a>Por ejemplo, denotando por $\hat{\sigma}^2(e)$ la varianza muestral cuando $x_1$ se mide con error $e$, se tiene que, usando el resultado de que la varianza muestral es igual a la media muestral de los cuadrados menos el cuadrado de la media muestral:</span>
<span id="cb37-725"><a href="#cb37-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-726"><a href="#cb37-726" aria-hidden="true" tabindex="-1"></a>:::{.proof}</span>
<span id="cb37-727"><a href="#cb37-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-728"><a href="#cb37-728" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-729"><a href="#cb37-729" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-730"><a href="#cb37-730" aria-hidden="true" tabindex="-1"></a>\hat{\sigma}^2(e) &amp;= \frac{1}{n} \left<span class="co">[</span><span class="ot"> (x_1 + e)^2 + \sum_{i=2}^{n} x_i^2 \right</span><span class="co">]</span> - \left( \frac{1}{n} \left<span class="co">[</span><span class="ot"> (x_1 + e) + x_2 + \ldots + x_n \right</span><span class="co">]</span> \right)^2 <span class="sc">\\</span></span>
<span id="cb37-731"><a href="#cb37-731" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n} \sum_{i=1}^{n} x_i^2 + \frac{x_1 e}{n} + \frac{e^2}{n} - \left( \bar{x} + \frac{e}{n} \right)^2 <span class="sc">\\</span></span>
<span id="cb37-732"><a href="#cb37-732" aria-hidden="true" tabindex="-1"></a>&amp;= \frac{1}{n} \sum_{i=1}^{n} x_i^2 + \frac{x_1 e}{n} + \frac{e^2}{n} - \bar{x}^2 - 2 \bar{x} \frac{e}{n} - \frac{e^2}{n^2} <span class="sc">\\</span></span>
<span id="cb37-733"><a href="#cb37-733" aria-hidden="true" tabindex="-1"></a>&amp;= \hat{\sigma}^2(0) + \frac{2}{n}(x_1 - \bar{x})e + \frac{n-1}{n^2}e^2.</span>
<span id="cb37-734"><a href="#cb37-734" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-735"><a href="#cb37-735" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-736"><a href="#cb37-736" aria-hidden="true" tabindex="-1"></a>De donde se concluye que </span>
<span id="cb37-737"><a href="#cb37-737" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-738"><a href="#cb37-738" aria-hidden="true" tabindex="-1"></a>\lim_{e \to \pm \infty} \hat{\sigma}^2(e) = +\infty,</span>
<span id="cb37-739"><a href="#cb37-739" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-740"><a href="#cb37-740" aria-hidden="true" tabindex="-1"></a>y, por lo tanto, también que </span>
<span id="cb37-741"><a href="#cb37-741" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-742"><a href="#cb37-742" aria-hidden="true" tabindex="-1"></a>\lim_{e \to \pm \infty} \hat{\sigma}(e) = +\infty.</span>
<span id="cb37-743"><a href="#cb37-743" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-744"><a href="#cb37-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-745"><a href="#cb37-745" aria-hidden="true" tabindex="-1"></a>::: </span>
<span id="cb37-746"><a href="#cb37-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-747"><a href="#cb37-747" aria-hidden="true" tabindex="-1"></a>En simple, las dos medidas de dispersión, la varianza y la desviación estándar, tienden a infinito positivo cuando el término de error tiende - o + infinito. Por lo tanto, ambas son medidas que no son robustas y, por lo tanto, sensibles a la presencia de valores extremos, de *outliers*. </span>
<span id="cb37-748"><a href="#cb37-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-749"><a href="#cb37-749" aria-hidden="true" tabindex="-1"></a><span class="fu">### El rango</span></span>
<span id="cb37-750"><a href="#cb37-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-751"><a href="#cb37-751" aria-hidden="true" tabindex="-1"></a>El *rango* es la diferencia entre los valores **más grande** y **más pequeño** de un conjunto de observaciones de una variable. Al tomar el valor máximo y mínimo de los datos, permite obtener una idea de la *dispersión* de los datos. Así, cuanto mayor es el rango, aún más dispersos están los datos. Por ejemplo, si</span>
<span id="cb37-752"><a href="#cb37-752" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-753"><a href="#cb37-753" aria-hidden="true" tabindex="-1"></a>x_1 = 0.7; \quad x_2 = 1.2; \quad x_3 = 0.9; \quad x_4 = 0.6; \quad x_5 = 1.4; \quad x_6 = 1.8; \quad x_7 = 2.5,</span>
<span id="cb37-754"><a href="#cb37-754" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-755"><a href="#cb37-755" aria-hidden="true" tabindex="-1"></a>entonces, como ya vimos:</span>
<span id="cb37-756"><a href="#cb37-756" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-757"><a href="#cb37-757" aria-hidden="true" tabindex="-1"></a>y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, \quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8, \quad y_7 = 2.5.</span>
<span id="cb37-758"><a href="#cb37-758" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-759"><a href="#cb37-759" aria-hidden="true" tabindex="-1"></a>Entonces el rango está dado por:</span>
<span id="cb37-760"><a href="#cb37-760" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-761"><a href="#cb37-761" aria-hidden="true" tabindex="-1"></a>y_7 - y_1 = 2.5 - 0.6 = 1.9.</span>
<span id="cb37-762"><a href="#cb37-762" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-763"><a href="#cb37-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-764"><a href="#cb37-764" aria-hidden="true" tabindex="-1"></a>Como ya se puede intuir a estas alturas, el rango tampoco es una medida de dispersión robusta, pues basta un *outlier* en los valores mínimos o máximos para que el rango se distorsiones. Así, aunque el rango de un conjunto de datos es simple de calcular, su valor no es muy útil porque depende fuertemente de valores extremos y, por tanto, no es robusto a la presencia de *outliers*. Formalmente, si tomamos el ejemplo anterior, tendríamos que </span>
<span id="cb37-765"><a href="#cb37-765" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-766"><a href="#cb37-766" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-767"><a href="#cb37-767" aria-hidden="true" tabindex="-1"></a>y_1 = 0.6, \quad y_2 = 0.7, \quad y_3 = 0.9, &amp;\quad y_4 = 1.2, \quad y_5 = 1.4, \quad y_6 = 1.8, \quad y_7 = 2.5.<span class="sc">\\</span></span>
<span id="cb37-768"><a href="#cb37-768" aria-hidden="true" tabindex="-1"></a>y_7 - y_1 = &amp;2.5 - 0.6 = 1.9.</span>
<span id="cb37-769"><a href="#cb37-769" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-770"><a href="#cb37-770" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-771"><a href="#cb37-771" aria-hidden="true" tabindex="-1"></a>Ahora bien, suponiendo nuevamente que la primera observación se midió con error $e$, de modo que $x_1 = 0.7 + e$, y denotando por $y_7(e)$ y $y_1(e)$ al valor máximo y mínimo cuando $x_1$ se reemplaza por $x_1 + e$, respectivamente, tenemos que:</span>
<span id="cb37-772"><a href="#cb37-772" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-773"><a href="#cb37-773" aria-hidden="true" tabindex="-1"></a>\lim_{e \to -\infty}(y_7(e) - y_1(e)) = \infty, \quad \lim_{e \to +\infty}(y_7(e) - y_1(e)) = \infty.</span>
<span id="cb37-774"><a href="#cb37-774" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-775"><a href="#cb37-775" aria-hidden="true" tabindex="-1"></a>Por lo que valores aberrantes o *outliers* tienen efectos brutales en el rango. En R es muy fácil de hacer, se puede "manualmente" o con <span class="in">`range()`</span> y <span class="in">`diff()`</span>. Lo mostramos y luego pasamos a la primera medida de dispersión robusta: el rango intercuartil. </span>
<span id="cb37-776"><a href="#cb37-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-779"><a href="#cb37-779" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-780"><a href="#cb37-780" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-rango</span></span>
<span id="cb37-781"><a href="#cb37-781" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-782"><a href="#cb37-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-783"><a href="#cb37-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-784"><a href="#cb37-784" aria-hidden="true" tabindex="-1"></a><span class="co"># Para obtener el rango (max–min) usa diff(range(x, na.rm=TRUE))</span></span>
<span id="cb37-785"><a href="#cb37-785" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">1.2</span>, <span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="fl">1.4</span>, <span class="fl">1.8</span>, <span class="fl">2.5</span>)</span>
<span id="cb37-786"><a href="#cb37-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-787"><a href="#cb37-787" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango con max–min</span></span>
<span id="cb37-788"><a href="#cb37-788" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">&lt;-</span> <span class="fu">max</span>(x) <span class="sc">-</span> <span class="fu">min</span>(x)</span>
<span id="cb37-789"><a href="#cb37-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-790"><a href="#cb37-790" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango con diff(range())</span></span>
<span id="cb37-791"><a href="#cb37-791" aria-hidden="true" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="co"># range(x, na.rm=TRUE) devuelve c(min, max), no la diferencia</span></span>
<span id="cb37-792"><a href="#cb37-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-793"><a href="#cb37-793" aria-hidden="true" tabindex="-1"></a><span class="co"># En tu variable de casen2022</span></span>
<span id="cb37-794"><a href="#cb37-794" aria-hidden="true" tabindex="-1"></a>r_casen_1 <span class="ot">&lt;-</span> <span class="fu">max</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> </span>
<span id="cb37-795"><a href="#cb37-795" aria-hidden="true" tabindex="-1"></a>             <span class="fu">min</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-796"><a href="#cb37-796" aria-hidden="true" tabindex="-1"></a>r_casen_2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">range</span>(casen2022<span class="sc">$</span>ytrabajocor, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb37-797"><a href="#cb37-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-798"><a href="#cb37-798" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb37-799"><a href="#cb37-799" aria-hidden="true" tabindex="-1"></a>r1</span>
<span id="cb37-800"><a href="#cb37-800" aria-hidden="true" tabindex="-1"></a>r2</span>
<span id="cb37-801"><a href="#cb37-801" aria-hidden="true" tabindex="-1"></a>r_casen_1</span>
<span id="cb37-802"><a href="#cb37-802" aria-hidden="true" tabindex="-1"></a>r_casen_2</span>
<span id="cb37-803"><a href="#cb37-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-804"><a href="#cb37-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-805"><a href="#cb37-805" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-806"><a href="#cb37-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-807"><a href="#cb37-807" aria-hidden="true" tabindex="-1"></a><span class="fu">### El rango intercuartil</span></span>
<span id="cb37-808"><a href="#cb37-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-809"><a href="#cb37-809" aria-hidden="true" tabindex="-1"></a>El **primer cuartil** de un conjunto de observaciones de una variable, que denotaremos por $q_1$, es el valor para el cual el 25\% de las observaciones son más pequeñas y el 75\% son más grandes. En otras palabras, el primer cuartil es la mediana del 50\% más pequeño de los datos.</span>
<span id="cb37-810"><a href="#cb37-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-811"><a href="#cb37-811" aria-hidden="true" tabindex="-1"></a>El **segundo cuartil**, $q_2$, es el mismo valor que aquel de la mediana (50\% son más pequeños, 50\% son más grandes).</span>
<span id="cb37-812"><a href="#cb37-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-813"><a href="#cb37-813" aria-hidden="true" tabindex="-1"></a>El **tercer cuartil**, $q_3$, es el valor para el cual el 25\% de las observaciones son más grandes y el 75\% son más pequeñas. En otras palabras, el tercer cuartil es la mediana del 50\% más grande de los datos.</span>
<span id="cb37-814"><a href="#cb37-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-815"><a href="#cb37-815" aria-hidden="true" tabindex="-1"></a>El **rango intercuartil**, que denotaremos \textbf{RIC}, está dado por: $q_3 - q_1$.</span>
<span id="cb37-816"><a href="#cb37-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-817"><a href="#cb37-817" aria-hidden="true" tabindex="-1"></a>Notar que el RIC es el **rango** del conjunto de observaciones con los cuartos más pequeño y más grande eliminados (*podados*), similar en espíritu a las observaciones que se consideran para calcular la media podada.Entonces, formalicemos su robustez.</span>
<span id="cb37-818"><a href="#cb37-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-819"><a href="#cb37-819" aria-hidden="true" tabindex="-1"></a>Por ejemplo, supongamos que las observaciones (ordenadas de menor a mayor) son:</span>
<span id="cb37-820"><a href="#cb37-820" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-821"><a href="#cb37-821" aria-hidden="true" tabindex="-1"></a>43, 48, 50, 50, 52, 53, 56, 58, 59, 60, 62, 65, 66, 68, 70, 71, 74, 76, 78, 80,</span>
<span id="cb37-822"><a href="#cb37-822" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-823"><a href="#cb37-823" aria-hidden="true" tabindex="-1"></a>entonces los cuartiles de este conjunto de observaciones son: </span>
<span id="cb37-824"><a href="#cb37-824" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-825"><a href="#cb37-825" aria-hidden="true" tabindex="-1"></a>q_1 = 52.5, \quad q_2 = 61, \quad q_3 = 70.5</span>
<span id="cb37-826"><a href="#cb37-826" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-827"><a href="#cb37-827" aria-hidden="true" tabindex="-1"></a>y el RIC viene dado por $q_3 - q_1 = 18$</span>
<span id="cb37-828"><a href="#cb37-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-829"><a href="#cb37-829" aria-hidden="true" tabindex="-1"></a>Ahora bien, suponiendo que el valor 43 se midió con un error $e$, de modo que su valor es $43 + e$, y denotando por $RIC(e)$ el valor del rango intercuartil cuando el valor 43 se reemplaza por $43 + e$, tenemos que: </span>
<span id="cb37-830"><a href="#cb37-830" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-831"><a href="#cb37-831" aria-hidden="true" tabindex="-1"></a>RIC(e) \in <span class="co">[</span><span class="ot">16,18</span><span class="co">]</span></span>
<span id="cb37-832"><a href="#cb37-832" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-833"><a href="#cb37-833" aria-hidden="true" tabindex="-1"></a>De modo que **el RIC es una medida de dispersión de los datos robusta a la presencia de _outliers_**. Para calcular cuartiles en R se usa <span class="in">`quantile()`</span>. Lo importante es especificar adecuadamente el cuantil de interés (50%, 75%, etc.) A su vez, entre los paquete de R base, específicamente en <span class="in">`stats`</span>, se tiene <span class="in">`IQR()`</span> nos permite calcular rangos intercuartiles. </span>
<span id="cb37-834"><a href="#cb37-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-837"><a href="#cb37-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-838"><a href="#cb37-838" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-IQR</span></span>
<span id="cb37-839"><a href="#cb37-839" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-840"><a href="#cb37-840" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb37-841"><a href="#cb37-841" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">43</span>, <span class="dv">48</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">56</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">62</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">74</span>, <span class="dv">76</span>, <span class="dv">78</span>, <span class="dv">80</span>)</span>
<span id="cb37-842"><a href="#cb37-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-843"><a href="#cb37-843" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular cuartiles</span></span>
<span id="cb37-844"><a href="#cb37-844" aria-hidden="true" tabindex="-1"></a>q1   <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.25</span>)</span>
<span id="cb37-845"><a href="#cb37-845" aria-hidden="true" tabindex="-1"></a>q2   <span class="ot">&lt;-</span> <span class="fu">median</span>(x)</span>
<span id="cb37-846"><a href="#cb37-846" aria-hidden="true" tabindex="-1"></a>q3   <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="fl">0.75</span>)</span>
<span id="cb37-847"><a href="#cb37-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-848"><a href="#cb37-848" aria-hidden="true" tabindex="-1"></a><span class="co"># Rango intercuartil</span></span>
<span id="cb37-849"><a href="#cb37-849" aria-hidden="true" tabindex="-1"></a>ric  <span class="ot">&lt;-</span> q3 <span class="sc">-</span> q1</span>
<span id="cb37-850"><a href="#cb37-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-851"><a href="#cb37-851" aria-hidden="true" tabindex="-1"></a><span class="co"># Para casen2022$ytrabajocor</span></span>
<span id="cb37-852"><a href="#cb37-852" aria-hidden="true" tabindex="-1"></a>x_casen    <span class="ot">&lt;-</span> casen2022<span class="sc">$</span>ytrabajocor</span>
<span id="cb37-853"><a href="#cb37-853" aria-hidden="true" tabindex="-1"></a>q1_casen   <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x_casen, <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-854"><a href="#cb37-854" aria-hidden="true" tabindex="-1"></a>q2_casen   <span class="ot">&lt;-</span> <span class="fu">median</span>(x_casen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-855"><a href="#cb37-855" aria-hidden="true" tabindex="-1"></a>q3_casen   <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x_casen, <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-856"><a href="#cb37-856" aria-hidden="true" tabindex="-1"></a>ric_casen  <span class="ot">&lt;-</span> q3_casen <span class="sc">-</span> q1_casen</span>
<span id="cb37-857"><a href="#cb37-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-858"><a href="#cb37-858" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternativa con función base</span></span>
<span id="cb37-859"><a href="#cb37-859" aria-hidden="true" tabindex="-1"></a>ric_casen2 <span class="ot">&lt;-</span> <span class="fu">IQR</span>(x_casen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-860"><a href="#cb37-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-861"><a href="#cb37-861" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb37-862"><a href="#cb37-862" aria-hidden="true" tabindex="-1"></a>q1; q2; q3; ric</span>
<span id="cb37-863"><a href="#cb37-863" aria-hidden="true" tabindex="-1"></a>q1_casen; q2_casen; q3_casen; ric_casen; ric_casen2</span>
<span id="cb37-864"><a href="#cb37-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-865"><a href="#cb37-865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-866"><a href="#cb37-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-867"><a href="#cb37-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-868"><a href="#cb37-868" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.3. Medidas de posición</span></span>
<span id="cb37-869"><a href="#cb37-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-870"><a href="#cb37-870" aria-hidden="true" tabindex="-1"></a><span class="fu">### Los percentiles </span></span>
<span id="cb37-871"><a href="#cb37-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-872"><a href="#cb37-872" aria-hidden="true" tabindex="-1"></a>El percentil de un conjunto de observaciones es una medida de posición que indica, una vez ordenados los datos de menor a mayor, el valor por debajo del cual se encuentra un porcentaje dado de observaciones. En general, el percentil $k$-ésimo, que denotaremos por $p_k$, es un valor para el cual un $k\%$ por ciento de las observaciones son menores que ella.</span>
<span id="cb37-873"><a href="#cb37-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-874"><a href="#cb37-874" aria-hidden="true" tabindex="-1"></a>La definición anterior es un tanto vaga: ¿menor o igual?, ¿qué pasa si no hay valores que cumplan?, ¿qué pasa si hay varios? Se pueden adoptar varios criterios, todos los cuales arrojan resultados parecidos cuando se aplican con conjuntos grandes de observaciones.</span>
<span id="cb37-875"><a href="#cb37-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-876"><a href="#cb37-876" aria-hidden="true" tabindex="-1"></a>Notar que, en general, $p_{25} = q_1$, $p_{50}$ es la mediana y $p_{75} = q_3$. Por ejemplo, si las observaciones (ordenadas de menor a mayor) son: </span>
<span id="cb37-877"><a href="#cb37-877" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-878"><a href="#cb37-878" aria-hidden="true" tabindex="-1"></a>43, 48, 50, 50, 52, 53, 56, 58, 59, 60, 62, 65, 66, 68, 70, 71, 74, 76, 78, 80,</span>
<span id="cb37-879"><a href="#cb37-879" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-880"><a href="#cb37-880" aria-hidden="true" tabindex="-1"></a>y exigimos que los percentiles sean observaciones y la definición es con "menor o igual", tenemos: </span>
<span id="cb37-881"><a href="#cb37-881" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-882"><a href="#cb37-882" aria-hidden="true" tabindex="-1"></a>p_{10} = 48, \quad p_{25} = 52, \quad p_{50} = 60, \quad p_{75} = 68, \quad p_{100} = 76.</span>
<span id="cb37-883"><a href="#cb37-883" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-884"><a href="#cb37-884" aria-hidden="true" tabindex="-1"></a>En R no hay una distinción entre cuantiles y percentiles a nivel de comando. Ahora bien, para obtener los percentiles en la posición que nos interesan podemos hacer lo siguiente: </span>
<span id="cb37-885"><a href="#cb37-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-888"><a href="#cb37-888" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-889"><a href="#cb37-889" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-percentiles</span></span>
<span id="cb37-890"><a href="#cb37-890" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-891"><a href="#cb37-891" aria-hidden="true" tabindex="-1"></a><span class="co"># Datos de ejemplo</span></span>
<span id="cb37-892"><a href="#cb37-892" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">43</span>, <span class="dv">48</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">56</span>, <span class="dv">58</span>, <span class="dv">59</span>, <span class="dv">60</span>, <span class="dv">62</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">68</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">74</span>, <span class="dv">76</span>, <span class="dv">78</span>, <span class="dv">80</span>)</span>
<span id="cb37-893"><a href="#cb37-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-894"><a href="#cb37-894" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos percentiles deseados</span></span>
<span id="cb37-895"><a href="#cb37-895" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.75</span>, <span class="fl">1.00</span>)</span>
<span id="cb37-896"><a href="#cb37-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-897"><a href="#cb37-897" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculamos percentiles como observaciones (type = 1)</span></span>
<span id="cb37-898"><a href="#cb37-898" aria-hidden="true" tabindex="-1"></a>percentiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x, <span class="at">probs =</span> p, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb37-899"><a href="#cb37-899" aria-hidden="true" tabindex="-1"></a>p10   <span class="ot">&lt;-</span> percentiles[<span class="dv">1</span>]</span>
<span id="cb37-900"><a href="#cb37-900" aria-hidden="true" tabindex="-1"></a>p25   <span class="ot">&lt;-</span> percentiles[<span class="dv">2</span>]</span>
<span id="cb37-901"><a href="#cb37-901" aria-hidden="true" tabindex="-1"></a>p50   <span class="ot">&lt;-</span> percentiles[<span class="dv">3</span>]</span>
<span id="cb37-902"><a href="#cb37-902" aria-hidden="true" tabindex="-1"></a>p75   <span class="ot">&lt;-</span> percentiles[<span class="dv">4</span>]</span>
<span id="cb37-903"><a href="#cb37-903" aria-hidden="true" tabindex="-1"></a>p100  <span class="ot">&lt;-</span> percentiles[<span class="dv">5</span>]</span>
<span id="cb37-904"><a href="#cb37-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-905"><a href="#cb37-905" aria-hidden="true" tabindex="-1"></a><span class="co"># Para casen2022$ytrabajocor</span></span>
<span id="cb37-906"><a href="#cb37-906" aria-hidden="true" tabindex="-1"></a>x_casen <span class="ot">&lt;-</span> casen2022<span class="sc">$</span>ytrabajocor</span>
<span id="cb37-907"><a href="#cb37-907" aria-hidden="true" tabindex="-1"></a>percentiles_casen <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x_casen, <span class="at">probs =</span> p, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb37-908"><a href="#cb37-908" aria-hidden="true" tabindex="-1"></a>p10_casen  <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">1</span>]</span>
<span id="cb37-909"><a href="#cb37-909" aria-hidden="true" tabindex="-1"></a>p25_casen  <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">2</span>]</span>
<span id="cb37-910"><a href="#cb37-910" aria-hidden="true" tabindex="-1"></a>p50_casen  <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">3</span>]</span>
<span id="cb37-911"><a href="#cb37-911" aria-hidden="true" tabindex="-1"></a>p75_casen  <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">4</span>]</span>
<span id="cb37-912"><a href="#cb37-912" aria-hidden="true" tabindex="-1"></a>p100_casen <span class="ot">&lt;-</span> percentiles_casen[<span class="dv">5</span>]</span>
<span id="cb37-913"><a href="#cb37-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-914"><a href="#cb37-914" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar resultados</span></span>
<span id="cb37-915"><a href="#cb37-915" aria-hidden="true" tabindex="-1"></a>percentiles</span>
<span id="cb37-916"><a href="#cb37-916" aria-hidden="true" tabindex="-1"></a>percentiles_casen</span>
<span id="cb37-917"><a href="#cb37-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-918"><a href="#cb37-918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-919"><a href="#cb37-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-920"><a href="#cb37-920" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.4. Transformaciones lineales de los datos descriptivos </span></span>
<span id="cb37-921"><a href="#cb37-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-922"><a href="#cb37-922" aria-hidden="true" tabindex="-1"></a>Una transformación lineal de un conjunto de datos es aquella en la que cada observación se multiplica por una constante y se le suma otra constante. Concretamente, dadas $n$ observaciones, $x_1, x_2, \dots, x_n$, una transformación lineal de ellas está dada por </span>
<span id="cb37-923"><a href="#cb37-923" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-924"><a href="#cb37-924" aria-hidden="true" tabindex="-1"></a>ax_1 + b, ax_2 + b, \dots, ax_n + b,</span>
<span id="cb37-925"><a href="#cb37-925" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-926"><a href="#cb37-926" aria-hidden="true" tabindex="-1"></a>con $a$ y $b$ constantes cualesquiera. </span>
<span id="cb37-927"><a href="#cb37-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-928"><a href="#cb37-928" aria-hidden="true" tabindex="-1"></a>De tal modo, las transformaciones lineales permiten transformar los datos de las estadísticas descriptivas transformadas linealmente con las estadísticas descriptivas originales. Un ejemplo de esto, podría ser la transformación de los datos de precios a los mismos precios en UF de algún día dado. Con ello, podríamos ver, e.g., el ingreso en pesos y queremos verlo en UF. De tal modo, podríamos comprar el ingreso original en pesos con el ingreso en UF sin distorsionar la proporción mediante esta multiplicación con constantes (ponderar en la misma cantidad básicamente). En nuestro ejemplo, de CLP $\to$ UF tendríamos que la constante $a$ sería el valor de la UF y la constante $b$ simplemente sería 0.  </span>
<span id="cb37-929"><a href="#cb37-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-930"><a href="#cb37-930" aria-hidden="true" tabindex="-1"></a>Lo que se sigue de esto, es determinar la relación entre las medidas que hemos visto hasta hora, en sus estadísticas descriptivas originales, y compararlas con sus respectivas transformaciones lineales. </span>
<span id="cb37-931"><a href="#cb37-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-932"><a href="#cb37-932" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si denotamos por $\bar{x}$ a la *media* de los valores de las observaciones originales y por $\bar{x}_t$ a la media de los datos después de aplicarles la transformación lineal, tenemos que </span>
<span id="cb37-933"><a href="#cb37-933" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-934"><a href="#cb37-934" aria-hidden="true" tabindex="-1"></a>\bar{x}_t = \frac{ax_1 + b + ax_2 + b + \dots + ax_n + b}{n} = a\bar{x} + b.</span>
<span id="cb37-935"><a href="#cb37-935" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-936"><a href="#cb37-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-937"><a href="#cb37-937" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si denotamos por $\hat{\sigma}^2$ a la *varianza* de los valores de las observaciones originales y por $\hat{\sigma}^2_t$ a la varianza de los datos después de aplicarles la transformación lineal, tenemos que</span>
<span id="cb37-938"><a href="#cb37-938" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-939"><a href="#cb37-939" aria-hidden="true" tabindex="-1"></a>\hat{\sigma}^2_t = \frac{(ax_1 + b - \bar{x}_t)^2 + (ax_2 + b - \bar{x}_t)^2 + \dots + (ax_n + b - \bar{x}_t)^2}{n} = a^2 \hat{\sigma}^2.</span>
<span id="cb37-940"><a href="#cb37-940" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-941"><a href="#cb37-941" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>De modo que para el caso de la *desviación estándar*, tenemos que: </span>
<span id="cb37-942"><a href="#cb37-942" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-943"><a href="#cb37-943" aria-hidden="true" tabindex="-1"></a>\hat{\sigma}_t = |a| \hat{\sigma}.</span>
<span id="cb37-944"><a href="#cb37-944" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-945"><a href="#cb37-945" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si denotamos por $\tilde{\tilde{x}}$ a la *moda* de los valores originales y por $\tilde{\tilde{x}}_t$ a la moda de los datos transformados, tenemos que: </span>
<span id="cb37-946"><a href="#cb37-946" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-947"><a href="#cb37-947" aria-hidden="true" tabindex="-1"></a>\tilde{\tilde{x}}_t = a \tilde{\tilde{x}} + b.</span>
<span id="cb37-948"><a href="#cb37-948" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-949"><a href="#cb37-949" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si denotamos por $y_1, y_2, \dots, y_n$ a los *estadísticos de orden* de los valores originales de los datos, tenemos que los estadísticos de orden de los datos transformados linealmente están dados por $a y_1 + b, a y_2 + b, \dots, a y_n + b$ si $a \geq 0$, o por $a y_n + b, a y_{n-1} + b, \dots, a y_1 + b$ si $a &lt; 0$.</span>
<span id="cb37-950"><a href="#cb37-950" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si denotamos por $\bar{x}$ a la *mediana* de las observaciones originales y por $\tilde{x}_t$ a la mediana de los datos después de aplicarles la transformación lineal, tenemos que: </span>
<span id="cb37-951"><a href="#cb37-951" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-952"><a href="#cb37-952" aria-hidden="true" tabindex="-1"></a>\tilde{x}_t = a \tilde{x} + b.</span>
<span id="cb37-953"><a href="#cb37-953" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-954"><a href="#cb37-954" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>El rango de los datos transformados está dado por $\left| a \right| (y_n - y_1)$.</span>
<span id="cb37-955"><a href="#cb37-955" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>El rango intercuartil de los datos después de aplicarles la transformación lineal está dado por $\left| a \right| (q_3 - q_1)$, donde $q_3$ y $q_1$ son los cuartiles 3 y 1 de los datos originales, respectivamente.</span>
<span id="cb37-956"><a href="#cb37-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-957"><a href="#cb37-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-958"><a href="#cb37-958" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2. Estadística descriptiva y visualización de los datos</span></span>
<span id="cb37-959"><a href="#cb37-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-960"><a href="#cb37-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-961"><a href="#cb37-961" aria-hidden="true" tabindex="-1"></a>La **visualización de datos** es otro paso importante en el *análisis exploratorio de datos* y, por tanto, para la *estadística descriptiva*. La **visualización de datos** es el proceso de resumir gráficamente la información, por lo que suelen ser fundamentales para las estadísticas descriptiva. Su utilidad radica en que nos ayuda a interpretar los datos disponibles y a detectar patrones, tendencias y anomalías en ellos. Además, la visualización de datos es una herramienta que nos permite comunicar claramente ideas complejas de una forma atractiva. Concretamente, el **gráfico** presenta lo que los números no pueden comunicar por sí mismos, y lo transmite de una manera visible y más fácil de asimilar y de recordar. Un **(buen) gráfico** vale más que mil palabras. Y el propósito principal de graficar los datos es **comunicar** información de los datos.</span>
<span id="cb37-962"><a href="#cb37-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-963"><a href="#cb37-963" aria-hidden="true" tabindex="-1"></a>En R, existe el comando <span class="in">`plot()`</span> en los paquetes bases. Pero se suele graficar con el paquete <span class="in">`ggplot2`</span>. También hay paquetes basados en <span class="in">`ggplot2`</span> pero que incorporan otro tipos de gramáticas, como <span class="in">`tidyplots`</span> que se especializa en gráficos para artículos científicos. Por no ser un apunte sobre cómo usar paquetes, usaré <span class="in">`ggplot2`</span>. También usaré <span class="in">`scales`</span> que complementará <span class="in">`ggplot2`</span> ajustando escalas. No obstante, ambos paquetes tienen múltiples páginas webs, tutoriales, etc., sobre cómo usarlos. También cargamos la CASEN 2022 nuevamente</span>
<span id="cb37-964"><a href="#cb37-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-965"><a href="#cb37-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-966"><a href="#cb37-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-967"><a href="#cb37-967" aria-hidden="true" tabindex="-1"></a><span class="fu">## Tipos de gráficos </span></span>
<span id="cb37-968"><a href="#cb37-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-969"><a href="#cb37-969" aria-hidden="true" tabindex="-1"></a>La elección de la **visualización de datos* depende de varios elementos, pero principalmente de </span>
<span id="cb37-970"><a href="#cb37-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-971"><a href="#cb37-971" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Qué tipo de variable se quiere investigar/presentar.</span>
<span id="cb37-972"><a href="#cb37-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-973"><a href="#cb37-973" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Lo que esperamos mostrar. </span>
<span id="cb37-974"><a href="#cb37-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-975"><a href="#cb37-975" aria-hidden="true" tabindex="-1"></a>Hay gráficos que son más adecuados para presentar ciertos tipos de datos, al igual que hay gráficos que no sirven para visualizar algunas variables según su naturaleza. Al mismo tiempo, dependerá de dónde y a quién se quiera presentar los gráficos. Dado que nuestra intención es *comunicar* información de los datos de manera gráfica, es importante tener en consideración si los gráficos se expondran en un artículo científico, una presentación en un congreso, en una afiche divulgativo, para una clase, etc. No obstante, aquí dejo una pauta general de qué gráficos usar según los tipos de variables y cuántas variables queramos comunicar. </span>
<span id="cb37-976"><a href="#cb37-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-977"><a href="#cb37-977" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Los **gráficos univariados**: muestran la distribución básica de una variable. Para ello utilizamos </span>
<span id="cb37-978"><a href="#cb37-978" aria-hidden="true" tabindex="-1"></a>  a. Gráficos de barras,</span>
<span id="cb37-979"><a href="#cb37-979" aria-hidden="true" tabindex="-1"></a>  b. Histogramas y</span>
<span id="cb37-980"><a href="#cb37-980" aria-hidden="true" tabindex="-1"></a>  c. Gráficos de caja (boxplots)</span>
<span id="cb37-981"><a href="#cb37-981" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-982"><a href="#cb37-982" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Los **gráficos bivariados**: muestran cómo dos variables están *relacionadas* entre sí. Cuál usar depende del tipo de variables bajo análisis:</span>
<span id="cb37-983"><a href="#cb37-983" aria-hidden="true" tabindex="-1"></a>  a. Dos variables categóricas: gráficos de barras.</span>
<span id="cb37-984"><a href="#cb37-984" aria-hidden="true" tabindex="-1"></a>  b. Una categórica y una cuantitativa: gráficos de cajas.</span>
<span id="cb37-985"><a href="#cb37-985" aria-hidden="true" tabindex="-1"></a>  c. Dos variables cuantitativas: gráficos de dispersión de puntos.</span>
<span id="cb37-986"><a href="#cb37-986" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-987"><a href="#cb37-987" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-988"><a href="#cb37-988" aria-hidden="true" tabindex="-1"></a>Veamos cómo graficar estos tipos de gráficos en R usando <span class="in">`ggplot2`</span> y datos reales de la CASEN 2022.   </span>
<span id="cb37-989"><a href="#cb37-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-990"><a href="#cb37-990" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gráficos univariados</span></span>
<span id="cb37-991"><a href="#cb37-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-992"><a href="#cb37-992" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gráficos de barras</span></span>
<span id="cb37-993"><a href="#cb37-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-994"><a href="#cb37-994" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eg-barplots, echo=TRUE, collapse=TRUE}</span></span>
<span id="cb37-995"><a href="#cb37-995" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: eg-barplots</span></span>
<span id="cb37-996"><a href="#cb37-996" aria-hidden="true" tabindex="-1"></a><span class="in">#| collapse: true</span></span>
<span id="cb37-997"><a href="#cb37-997" aria-hidden="true" tabindex="-1"></a><span class="in"># Vemos datos de nuestra variable de interés</span></span>
<span id="cb37-998"><a href="#cb37-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-999"><a href="#cb37-999" aria-hidden="true" tabindex="-1"></a><span class="in">sjmisc::frq(casen2022$sexo) # ups! no funciona en RMarkdown</span></span>
<span id="cb37-1000"><a href="#cb37-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1001"><a href="#cb37-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1002"><a href="#cb37-1002" aria-hidden="true" tabindex="-1"></a><span class="in"># Gráfico de barras de la variable sexo</span></span>
<span id="cb37-1003"><a href="#cb37-1003" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(casen2022, aes(x = factor(sexo, labels = c("Hombre", "Mujer")))) +</span></span>
<span id="cb37-1004"><a href="#cb37-1004" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_bar() +</span></span>
<span id="cb37-1005"><a href="#cb37-1005" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb37-1006"><a href="#cb37-1006" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Sexo",</span></span>
<span id="cb37-1007"><a href="#cb37-1007" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Frecuencia",</span></span>
<span id="cb37-1008"><a href="#cb37-1008" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Distribución de la variable Sexo"</span></span>
<span id="cb37-1009"><a href="#cb37-1009" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb37-1010"><a href="#cb37-1010" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb37-1011"><a href="#cb37-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1012"><a href="#cb37-1012" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1013"><a href="#cb37-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1014"><a href="#cb37-1014" aria-hidden="true" tabindex="-1"></a>Si queremos agregarle más colores^<span class="co">[</span><span class="ot">Yo uso las paletas de colores de [aquí](https://r-charts.com/es/colores/)</span><span class="co">]</span>, cambiar el tamaño de las letras, ponerle caption, etc., solo hay que usar comandos de <span class="in">`ggplot2`</span> que sirvan para ello y seguir su gramática "en capas" adecuadamente </span>
<span id="cb37-1015"><a href="#cb37-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1018"><a href="#cb37-1018" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1019"><a href="#cb37-1019" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-barplots2</span></span>
<span id="cb37-1020"><a href="#cb37-1020" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1021"><a href="#cb37-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1022"><a href="#cb37-1022" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico de barras de la variable sexo más bonito</span></span>
<span id="cb37-1023"><a href="#cb37-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(casen2022, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(sexo, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)), </span>
<span id="cb37-1024"><a href="#cb37-1024" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fill =</span> <span class="fu">factor</span>(sexo))) <span class="sc">+</span></span>
<span id="cb37-1025"><a href="#cb37-1025" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb37-1026"><a href="#cb37-1026" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#8F8F8F"</span>, <span class="st">"#8B0000"</span>)) <span class="sc">+</span></span>
<span id="cb37-1027"><a href="#cb37-1027" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-1028"><a href="#cb37-1028" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb37-1029"><a href="#cb37-1029" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb37-1030"><a href="#cb37-1030" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribución de Sexo en CASEN 2022"</span>, </span>
<span id="cb37-1031"><a href="#cb37-1031" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Elaboración propia a partir de Encuesta CASEN 2022"</span></span>
<span id="cb37-1032"><a href="#cb37-1032" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-1033"><a href="#cb37-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-1034"><a href="#cb37-1034" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-1035"><a href="#cb37-1035" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1036"><a href="#cb37-1036" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb37-1037"><a href="#cb37-1037" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb37-1038"><a href="#cb37-1038" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-1039"><a href="#cb37-1039" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb37-1040"><a href="#cb37-1040" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-1041"><a href="#cb37-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1042"><a href="#cb37-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb37-1043"><a href="#cb37-1043" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-1044"><a href="#cb37-1044" aria-hidden="true" tabindex="-1"></a>Más allá de "enchular" el gráfico, lo importante es que el gráfico es más fácil de comprender rápidamente que una tabla de frecuencias, como vimos con <span class="in">`frq()`</span>. Y cuando se agrega más categorías, facilita aún más. Por ejemplo, veamos Clasificación Internacional Normalizada de Educación (CINE-F). Para ello usaremos <span class="in">`cinef13_area`</span> de la CASEN 2022, pero excluiremos las categorías sin datos </span>
<span id="cb37-1045"><a href="#cb37-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1048"><a href="#cb37-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1049"><a href="#cb37-1049" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-barplots3</span></span>
<span id="cb37-1050"><a href="#cb37-1050" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1051"><a href="#cb37-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1052"><a href="#cb37-1052" aria-hidden="true" tabindex="-1"></a><span class="co">#Exploramos nuestra variable de interés</span></span>
<span id="cb37-1053"><a href="#cb37-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1054"><a href="#cb37-1054" aria-hidden="true" tabindex="-1"></a><span class="fu">frq</span>(casen2022<span class="sc">$</span>cinef13_area)</span>
<span id="cb37-1055"><a href="#cb37-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1056"><a href="#cb37-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1057"><a href="#cb37-1057" aria-hidden="true" tabindex="-1"></a><span class="co"># Como vemos Doctorado en Ciencias Básicas no tiene casos</span></span>
<span id="cb37-1058"><a href="#cb37-1058" aria-hidden="true" tabindex="-1"></a><span class="co"># y Sin dato no nos interesa. Tampoco NA</span></span>
<span id="cb37-1059"><a href="#cb37-1059" aria-hidden="true" tabindex="-1"></a><span class="co"># Usamos dplyr</span></span>
<span id="cb37-1060"><a href="#cb37-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1061"><a href="#cb37-1061" aria-hidden="true" tabindex="-1"></a>area_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb37-1062"><a href="#cb37-1062" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Salud y Bienestar"</span>,</span>
<span id="cb37-1063"><a href="#cb37-1063" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ingeniería, Industria y Construcción"</span>,</span>
<span id="cb37-1064"><a href="#cb37-1064" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Educación"</span>,</span>
<span id="cb37-1065"><a href="#cb37-1065" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Servicios"</span>,</span>
<span id="cb37-1066"><a href="#cb37-1066" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Administración de Empresas y Derecho"</span>,</span>
<span id="cb37-1067"><a href="#cb37-1067" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ciencias Sociales, Periodismo e Información"</span>,</span>
<span id="cb37-1068"><a href="#cb37-1068" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Ciencias naturales, matemáticas y estadística"</span>,</span>
<span id="cb37-1069"><a href="#cb37-1069" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Agricultura, Silvicultura, Pesca y Veterinaria"</span>,</span>
<span id="cb37-1070"><a href="#cb37-1070" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Tecnología de la Información y la Comunicación (TIC)"</span>,</span>
<span id="cb37-1071"><a href="#cb37-1071" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Artes y Humanidades"</span></span>
<span id="cb37-1072"><a href="#cb37-1072" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-1073"><a href="#cb37-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1074"><a href="#cb37-1074" aria-hidden="true" tabindex="-1"></a>df_area <span class="ot">&lt;-</span> casen2022 <span class="sc">|&gt;</span> </span>
<span id="cb37-1075"><a href="#cb37-1075" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>cinef13_area <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">11</span>, <span class="dv">88</span>, <span class="cn">NA</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb37-1076"><a href="#cb37-1076" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(cinef13_area) <span class="sc">|&gt;</span> </span>
<span id="cb37-1077"><a href="#cb37-1077" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">area =</span> <span class="fu">factor</span>(cinef13_area, <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">labels =</span> area_labels))</span>
<span id="cb37-1078"><a href="#cb37-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1079"><a href="#cb37-1079" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_area, <span class="fu">aes</span>(<span class="at">x =</span> area, <span class="at">y =</span> n, <span class="at">fill =</span> area)) <span class="sc">+</span></span>
<span id="cb37-1080"><a href="#cb37-1080" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"white"</span>, <span class="at">width =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb37-1081"><a href="#cb37-1081" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-1082"><a href="#cb37-1082" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Área CINE-F"</span>,</span>
<span id="cb37-1083"><a href="#cb37-1083" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb37-1084"><a href="#cb37-1084" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribución de Áreas CINE-F (códigos 1–10)"</span></span>
<span id="cb37-1085"><a href="#cb37-1085" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-1086"><a href="#cb37-1086" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-1087"><a href="#cb37-1087" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-1088"><a href="#cb37-1088" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x    =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb37-1089"><a href="#cb37-1089" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1090"><a href="#cb37-1090" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb37-1091"><a href="#cb37-1091" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-1092"><a href="#cb37-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1093"><a href="#cb37-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1094"><a href="#cb37-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```</span>   </span>
<span id="cb37-1095"><a href="#cb37-1095" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-1096"><a href="#cb37-1096" aria-hidden="true" tabindex="-1"></a>Esto es mucho más amable que una tabla en la que comparamos números, porque permite una comparación visual entre categorías. Entonces, la ganancia del gráfico de barra se da en la medida que haya más categorías a analizar. </span>
<span id="cb37-1097"><a href="#cb37-1097" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-1098"><a href="#cb37-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1099"><a href="#cb37-1099" aria-hidden="true" tabindex="-1"></a><span class="fu">### Histogramas (y kernels)</span></span>
<span id="cb37-1100"><a href="#cb37-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1101"><a href="#cb37-1101" aria-hidden="true" tabindex="-1"></a>Este tipo de visualizaciones es recomendable para resumir gráficamente la información de una **variable cuantitativa**. Un histograma muestra la distribución empírica de las observaciones de un variable cuantitativa. Muchas veces, por ejemplo, se usa para observar si una variable sigue o no una distribución normal. </span>
<span id="cb37-1102"><a href="#cb37-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1103"><a href="#cb37-1103" aria-hidden="true" tabindex="-1"></a>En un histograma, la altura de cada barra representa cuántas observaciones en el conjunto de datos caen dentro de un cierto rango (intervalo) de la variable cuantitativa bajo análisis. Un elemento fundamental al momento de hacer un histograma es la definición del número de rangos (intervalos) de la variable cuantitativa que se considerarán para agrupar los datos. Si no se elige el número correcto (ancho adecuado) para dichos intervalos, se corre el riesgo de que el histograma no refleje las características esenciales del conjunto de datos, llevándonos a malinterpretar cómo se distribuyen las observaciones. </span>
<span id="cb37-1104"><a href="#cb37-1104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb37-1105"><a href="#cb37-1105" aria-hidden="true" tabindex="-1"></a>Veamos la distribución de los ingresos del trabajo en un histograma: </span>
<span id="cb37-1108"><a href="#cb37-1108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1109"><a href="#cb37-1109" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-histogram</span></span>
<span id="cb37-1110"><a href="#cb37-1110" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1111"><a href="#cb37-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1112"><a href="#cb37-1112" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(casen2022, <span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor)) <span class="sc">+</span></span>
<span id="cb37-1113"><a href="#cb37-1113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"#4E79A7"</span>, <span class="at">color =</span> <span class="st">"white"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb37-1114"><a href="#cb37-1114" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span> <span class="co"># para sacar notación científica</span></span>
<span id="cb37-1115"><a href="#cb37-1115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-1116"><a href="#cb37-1116" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb37-1117"><a href="#cb37-1117" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb37-1118"><a href="#cb37-1118" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Histograma de ytrabajocor"</span></span>
<span id="cb37-1119"><a href="#cb37-1119" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-1120"><a href="#cb37-1120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-1121"><a href="#cb37-1121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-1122"><a href="#cb37-1122" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1123"><a href="#cb37-1123" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb37-1124"><a href="#cb37-1124" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-1125"><a href="#cb37-1125" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-1126"><a href="#cb37-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1127"><a href="#cb37-1127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1128"><a href="#cb37-1128" aria-hidden="true" tabindex="-1"></a>Como se ve, la desigualdad de los ingresos nuevamente ataca. Al haber pocas personas con ingresos muy altos, y muchas personas con ingresos bajos, ni se alcanzan a ver las personas de ingresos altos. Ciertamente, esta forma de elefante dentro de una serpiente hacia un lado del gráfico es habitual verla en gráficos de distribución en los ingresos. Podemos para ver cómo varía esto, por ejemplo, usar percentiles, deciles, quintiles, etc., para filtar casos y observar la distribución empírica de los ingresos, e.g., para el 90% de los ingresos (excluyendo al 10% más alto):</span>
<span id="cb37-1129"><a href="#cb37-1129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1132"><a href="#cb37-1132" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1133"><a href="#cb37-1133" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-histogram2</span></span>
<span id="cb37-1134"><a href="#cb37-1134" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1135"><a href="#cb37-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1136"><a href="#cb37-1136" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span> </span>
<span id="cb37-1137"><a href="#cb37-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor), dau <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-1138"><a href="#cb37-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor)) <span class="sc">+</span></span>
<span id="cb37-1139"><a href="#cb37-1139" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"#4E79A7"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb37-1140"><a href="#cb37-1140" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-1141"><a href="#cb37-1141" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-1142"><a href="#cb37-1142" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb37-1143"><a href="#cb37-1143" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb37-1144"><a href="#cb37-1144" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Histograma de ytrabajocor (deciles 1–9)"</span></span>
<span id="cb37-1145"><a href="#cb37-1145" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1146"><a href="#cb37-1146" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-1147"><a href="#cb37-1147" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb37-1148"><a href="#cb37-1148" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1149"><a href="#cb37-1149" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb37-1150"><a href="#cb37-1150" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-1151"><a href="#cb37-1151" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-1152"><a href="#cb37-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1153"><a href="#cb37-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1154"><a href="#cb37-1154" aria-hidden="true" tabindex="-1"></a>¿Y si queremos, por ejemplo, para el 80%? Solo basta modificar <span class="in">`dau &lt; x`</span> en el código, pues <span class="in">`dau`</span> es la variable del Decil autónomo nacional dentro de la CASEN 2022. </span>
<span id="cb37-1155"><a href="#cb37-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1158"><a href="#cb37-1158" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1159"><a href="#cb37-1159" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-histogram3</span></span>
<span id="cb37-1160"><a href="#cb37-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1161"><a href="#cb37-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1162"><a href="#cb37-1162" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span> </span>
<span id="cb37-1163"><a href="#cb37-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor), dau <span class="sc">&lt;</span> <span class="dv">9</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-1164"><a href="#cb37-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor)) <span class="sc">+</span></span>
<span id="cb37-1165"><a href="#cb37-1165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"#4E79A7"</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb37-1166"><a href="#cb37-1166" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-1167"><a href="#cb37-1167" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-1168"><a href="#cb37-1168" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb37-1169"><a href="#cb37-1169" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="st">"Frecuencia"</span>,</span>
<span id="cb37-1170"><a href="#cb37-1170" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Histograma de ytrabajocor (deciles 1–8)"</span></span>
<span id="cb37-1171"><a href="#cb37-1171" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1172"><a href="#cb37-1172" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-1173"><a href="#cb37-1173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb37-1174"><a href="#cb37-1174" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1175"><a href="#cb37-1175" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb37-1176"><a href="#cb37-1176" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-1177"><a href="#cb37-1177" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-1178"><a href="#cb37-1178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1179"><a href="#cb37-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1180"><a href="#cb37-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1181"><a href="#cb37-1181" aria-hidden="true" tabindex="-1"></a>Algo que también se puede hacer, similar a los histogramas, es observar esto con *kernels*, que son como histogramas pero con densidad y continuos (no en barras). Esto se hace con <span class="in">`geom_density()`</span>. Además, esto nos facilita (para visualizar la distribución empírica) ver nuestra variable de interés agrupada según otra variable que nos interese. Por ejemplo, podríamso ver el ingreso del trabajo según sexo. </span>
<span id="cb37-1182"><a href="#cb37-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1185"><a href="#cb37-1185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1186"><a href="#cb37-1186" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-kernels</span></span>
<span id="cb37-1187"><a href="#cb37-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1188"><a href="#cb37-1188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1189"><a href="#cb37-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1190"><a href="#cb37-1190" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span> </span>
<span id="cb37-1191"><a href="#cb37-1191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor), dau <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-1192"><a href="#cb37-1192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb37-1193"><a href="#cb37-1193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb37-1194"><a href="#cb37-1194" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>,<span class="at">adjust =</span><span class="dv">2</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb37-1195"><a href="#cb37-1195" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-1196"><a href="#cb37-1196" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-1197"><a href="#cb37-1197" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Distribución de ingreso de trabajo corregido por sexo"</span>,</span>
<span id="cb37-1198"><a href="#cb37-1198" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb37-1199"><a href="#cb37-1199" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Densidad"</span>,</span>
<span id="cb37-1200"><a href="#cb37-1200" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill  =</span> <span class="st">"Sexo"</span></span>
<span id="cb37-1201"><a href="#cb37-1201" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1202"><a href="#cb37-1202" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-1203"><a href="#cb37-1203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb37-1204"><a href="#cb37-1204" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1205"><a href="#cb37-1205" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb37-1206"><a href="#cb37-1206" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text       =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-1207"><a href="#cb37-1207" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-1208"><a href="#cb37-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1209"><a href="#cb37-1209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1210"><a href="#cb37-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1211"><a href="#cb37-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1212"><a href="#cb37-1212" aria-hidden="true" tabindex="-1"></a>Otra cosa que puede resultarnos util es ver donde está mediana en el gráfico. Aprovechamos de mostrar como se verían los gráficos ya no superpuestos, sino al lado: </span>
<span id="cb37-1213"><a href="#cb37-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1216"><a href="#cb37-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1217"><a href="#cb37-1217" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-kernels2</span></span>
<span id="cb37-1218"><a href="#cb37-1218" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1219"><a href="#cb37-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1220"><a href="#cb37-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1221"><a href="#cb37-1221" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> casen2022 <span class="sc">|&gt;</span></span>
<span id="cb37-1222"><a href="#cb37-1222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor), dau <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-1223"><a href="#cb37-1223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)))</span>
<span id="cb37-1224"><a href="#cb37-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1225"><a href="#cb37-1225" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraemos medianas</span></span>
<span id="cb37-1226"><a href="#cb37-1226" aria-hidden="true" tabindex="-1"></a>medianas <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span></span>
<span id="cb37-1227"><a href="#cb37-1227" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo) <span class="sc">|&gt;</span></span>
<span id="cb37-1228"><a href="#cb37-1228" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mediana =</span> <span class="fu">median</span>(ytrabajocor))</span>
<span id="cb37-1229"><a href="#cb37-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1230"><a href="#cb37-1230" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficamos </span></span>
<span id="cb37-1231"><a href="#cb37-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> ytrabajocor, <span class="at">fill =</span> sexo, <span class="at">color =</span> sexo)) <span class="sc">+</span></span>
<span id="cb37-1232"><a href="#cb37-1232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">adjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-1233"><a href="#cb37-1233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data =</span> medianas, <span class="fu">aes</span>(<span class="at">xintercept =</span> mediana, <span class="at">color =</span> sexo),</span>
<span id="cb37-1234"><a href="#cb37-1234" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-1235"><a href="#cb37-1235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> sexo) <span class="sc">+</span></span>
<span id="cb37-1236"><a href="#cb37-1236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span> <span class="ot">=</span> <span class="st">"#C51517"</span>, <span class="st">"Mujer"</span> <span class="ot">=</span> <span class="st">"#BAB3EB"</span>)) <span class="sc">+</span></span>
<span id="cb37-1237"><a href="#cb37-1237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span> <span class="ot">=</span> <span class="st">"#9C0824"</span>, <span class="st">"Mujer"</span> <span class="ot">=</span> <span class="st">"#312271"</span>)) <span class="sc">+</span></span>
<span id="cb37-1238"><a href="#cb37-1238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-1239"><a href="#cb37-1239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-1240"><a href="#cb37-1240" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribución de ingreso de trabajo corregido por sexo"</span>,</span>
<span id="cb37-1241"><a href="#cb37-1241" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb37-1242"><a href="#cb37-1242" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">""</span>,</span>
<span id="cb37-1243"><a href="#cb37-1243" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill  =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb37-1244"><a href="#cb37-1244" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Sexo"</span></span>
<span id="cb37-1245"><a href="#cb37-1245" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-1246"><a href="#cb37-1246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-1247"><a href="#cb37-1247" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-1248"><a href="#cb37-1248" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1249"><a href="#cb37-1249" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb37-1250"><a href="#cb37-1250" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text       =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-1251"><a href="#cb37-1251" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-1252"><a href="#cb37-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1253"><a href="#cb37-1253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1254"><a href="#cb37-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1255"><a href="#cb37-1255" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gráfico de cajas (boxplots)</span></span>
<span id="cb37-1256"><a href="#cb37-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1257"><a href="#cb37-1257" aria-hidden="true" tabindex="-1"></a>Cuando son gráficos univariados este tipo de visualizaciones tipo *boxplot* es recomendable para resumir gráficamente la información de una **variable cuantitativa** (continua o discreta). Un grafico de caja o *boxplot* muestra las **características de la distribución** de las observaciones de una variable cuantitativa: “mínimo”, primer cuartil ($q_1$), mediana, tercer cuartil ($q_3$), “máximo”. También etiqueta posibles valores atípicos como puntos separados en el gráfico. En un gráfico de caja, pues, se tiene que:</span>
<span id="cb37-1258"><a href="#cb37-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1259"><a href="#cb37-1259" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>El “mínimo” corresponde a $q_1 - 1,5RIC$ (no es el valor más pequeño entre las observaciones).</span>
<span id="cb37-1260"><a href="#cb37-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1261"><a href="#cb37-1261" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>El “máximo” corresponde a $q_3 + 1,5RIC$ (no es el valor más grande entre las observaciones).</span>
<span id="cb37-1262"><a href="#cb37-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1263"><a href="#cb37-1263" aria-hidden="true" tabindex="-1"></a>En esta herramienta gráfica, las observaciones etiquetadas como posibles valores atípicos (*outliers*) son aquellas que se ubican fuera del intervalo dado por:</span>
<span id="cb37-1264"><a href="#cb37-1264" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1265"><a href="#cb37-1265" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">q_1 - 1,5RIC, q_3 + 1,5RIC</span><span class="co">]</span></span>
<span id="cb37-1266"><a href="#cb37-1266" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1267"><a href="#cb37-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1268"><a href="#cb37-1268" aria-hidden="true" tabindex="-1"></a>Veamos como hacer esto con <span class="in">`ggplot2`</span>. Usaremos otra variable cuantitativa, y ya no ingresos del trabajo porque, dada su dispersión se verá así: </span>
<span id="cb37-1269"><a href="#cb37-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1272"><a href="#cb37-1272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1273"><a href="#cb37-1273" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-boxplot</span></span>
<span id="cb37-1274"><a href="#cb37-1274" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1275"><a href="#cb37-1275" aria-hidden="true" tabindex="-1"></a><span class="co"># Para ingresos del trabajo</span></span>
<span id="cb37-1276"><a href="#cb37-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1277"><a href="#cb37-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1278"><a href="#cb37-1278" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(casen2022, <span class="fu">aes</span>(<span class="at">y =</span> ytrabajocor)) <span class="sc">+</span></span>
<span id="cb37-1279"><a href="#cb37-1279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#4E79A7"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb37-1280"><a href="#cb37-1280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-1281"><a href="#cb37-1281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-1282"><a href="#cb37-1282" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Ingreso de trabajo corregido"</span>,</span>
<span id="cb37-1283"><a href="#cb37-1283" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Boxplot de ingreso de trabajo corregido"</span></span>
<span id="cb37-1284"><a href="#cb37-1284" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-1285"><a href="#cb37-1285" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-1286"><a href="#cb37-1286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-1287"><a href="#cb37-1287" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1288"><a href="#cb37-1288" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-1289"><a href="#cb37-1289" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-1290"><a href="#cb37-1290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1291"><a href="#cb37-1291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1292"><a href="#cb37-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1293"><a href="#cb37-1293" aria-hidden="true" tabindex="-1"></a>Probemos con otra variable que sea interesante, por ejemplo con la varriable <span class="in">`tot_per_h`</span> que registra el "Total de personas en el hogar" de los hogares encuestados por la CASEN</span>
<span id="cb37-1294"><a href="#cb37-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1297"><a href="#cb37-1297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1298"><a href="#cb37-1298" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-boxplot2</span></span>
<span id="cb37-1299"><a href="#cb37-1299" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1300"><a href="#cb37-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1301"><a href="#cb37-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1302"><a href="#cb37-1302" aria-hidden="true" tabindex="-1"></a><span class="co"># Para Total de personas en el hogar</span></span>
<span id="cb37-1303"><a href="#cb37-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1304"><a href="#cb37-1304" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb37-1305"><a href="#cb37-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(tot_per_h)) <span class="sc">|&gt;</span></span>
<span id="cb37-1306"><a href="#cb37-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_per_h)) <span class="sc">+</span></span>
<span id="cb37-1307"><a href="#cb37-1307" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">fill =</span> <span class="st">"#CAE1FF"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb37-1308"><a href="#cb37-1308" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">13</span>)) <span class="sc">+</span></span>
<span id="cb37-1309"><a href="#cb37-1309" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-1310"><a href="#cb37-1310" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Total de personas en el hogar"</span>,</span>
<span id="cb37-1311"><a href="#cb37-1311" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Boxplot de total de personas en el hogar"</span></span>
<span id="cb37-1312"><a href="#cb37-1312" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1313"><a href="#cb37-1313" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-1314"><a href="#cb37-1314" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb37-1315"><a href="#cb37-1315" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1316"><a href="#cb37-1316" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-1317"><a href="#cb37-1317" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-1318"><a href="#cb37-1318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1319"><a href="#cb37-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1320"><a href="#cb37-1320" aria-hidden="true" tabindex="-1"></a>La intepretación del boxplot, entonces, debe incluir lo siguiente: </span>
<span id="cb37-1321"><a href="#cb37-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1322"><a href="#cb37-1322" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>La mediana está en 3 miembros, lo que indica que la mitad de los hogares tiene 3 o menos personas y la otra mitad 3 o más.</span>
<span id="cb37-1323"><a href="#cb37-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1324"><a href="#cb37-1324" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>El primer cuartil ($Q1$) se sitúa en 2 personas y el tercer cuartil ($Q3$) en 4 personas. Esto nos dice que el 50% central de los hogares (entre $Q1$ y $Q3$) agrupa tamaños de 2 a 4 miembros.</span>
<span id="cb37-1325"><a href="#cb37-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1326"><a href="#cb37-1326" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>El rango intercuartílico ($RIC = Q3 – Q1$) es 2 personas, reflejando una variabilidad moderada en el tamaño típico de los hogares.</span>
<span id="cb37-1327"><a href="#cb37-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1328"><a href="#cb37-1328" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Los “bigotes” se extienden desde 1 hasta 7 miembros aproximadamente, marcando los límites dentro de $1,5·RIC$.</span>
<span id="cb37-1329"><a href="#cb37-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1330"><a href="#cb37-1330" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Más allá de 7 personas aparecen puntos aislados (*outliers*), correspondientes a hogares muy numerosos (8 a 13 personas), que representan casos excepcionales en la distribución.</span>
<span id="cb37-1331"><a href="#cb37-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1332"><a href="#cb37-1332" aria-hidden="true" tabindex="-1"></a>En conjunto, el gráfico revela que la mayoría de los hogares chilenos encuestados están compuestos por entre 2 y 4 personas, con un hogar típico de 3 miembros, y que los tamaños extremos (hogares muy grandes) son poco frecuentes.</span>
<span id="cb37-1333"><a href="#cb37-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1334"><a href="#cb37-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1335"><a href="#cb37-1335" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gráficos bivariados</span></span>
<span id="cb37-1336"><a href="#cb37-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1337"><a href="#cb37-1337" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gráficos de barras de dos variables</span></span>
<span id="cb37-1338"><a href="#cb37-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1339"><a href="#cb37-1339" aria-hidden="true" tabindex="-1"></a>Esta visualización es recomendable para resumir gráficamente la información sobre la relación entre **dos variables categóricas**. Específicamente, este gráfico destaca cómo una variable categórica puede diferir entre las categorías de otra variable categórica. Por ejemplo, podríamos mostrar cómo la matrícula en la educación superior difiere por género.</span>
<span id="cb37-1340"><a href="#cb37-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1341"><a href="#cb37-1341" aria-hidden="true" tabindex="-1"></a>Para ello, tomaré la variable <span class="in">`e6a_asiste`</span> que responde a la pregunta ¿Cuál es el nivel educacional al que asiste?, dado que supone que asiste, al momento de ser encuestado/a, a un establecimiento educacional o no. En este caso, solo tomaremos la categoría <span class="in">`13`</span> que es "13. Profesional (Carreras 4 o más años)". Aunque no es una variable sobre la matricula como tal, es un buen *proxy*^<span class="co">[</span><span class="ot">Para ello, hay muchas bases de datos que si registran esta información. Además, el MINEDUC una buena plataforma de datos abiertos, pero para centrarnos, en este capítulo, en la CASEN</span><span class="co">]</span> </span>
<span id="cb37-1342"><a href="#cb37-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1345"><a href="#cb37-1345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1346"><a href="#cb37-1346" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-barplot-bivariado</span></span>
<span id="cb37-1347"><a href="#cb37-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1348"><a href="#cb37-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1349"><a href="#cb37-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1350"><a href="#cb37-1350" aria-hidden="true" tabindex="-1"></a><span class="co"># Creamos un df ad hoc</span></span>
<span id="cb37-1351"><a href="#cb37-1351" aria-hidden="true" tabindex="-1"></a>df_asiste_prof <span class="ot">&lt;-</span> casen2022 <span class="sc">|&gt;</span></span>
<span id="cb37-1352"><a href="#cb37-1352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(e6a_asiste <span class="sc">==</span> <span class="dv">13</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-1353"><a href="#cb37-1353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sexo) <span class="sc">|&gt;</span></span>
<span id="cb37-1354"><a href="#cb37-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)))</span>
<span id="cb37-1355"><a href="#cb37-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1356"><a href="#cb37-1356" aria-hidden="true" tabindex="-1"></a><span class="co"># Ploteamos</span></span>
<span id="cb37-1357"><a href="#cb37-1357" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_asiste_prof, <span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> n, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb37-1358"><a href="#cb37-1358" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb37-1359"><a href="#cb37-1359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-1360"><a href="#cb37-1360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-1361"><a href="#cb37-1361" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb37-1362"><a href="#cb37-1362" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Número de estudiantes en carreras profesionales (4+ años)"</span>,</span>
<span id="cb37-1363"><a href="#cb37-1363" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Asistencia a la universidad (Profesional) por sexo"</span></span>
<span id="cb37-1364"><a href="#cb37-1364" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-1365"><a href="#cb37-1365" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"Fira Sans"</span>, <span class="at">base_size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb37-1366"><a href="#cb37-1366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-1367"><a href="#cb37-1367" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1368"><a href="#cb37-1368" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb37-1369"><a href="#cb37-1369" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb37-1370"><a href="#cb37-1370" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-1371"><a href="#cb37-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1372"><a href="#cb37-1372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1373"><a href="#cb37-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1374"><a href="#cb37-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1375"><a href="#cb37-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1376"><a href="#cb37-1376" aria-hidden="true" tabindex="-1"></a><span class="fu">### Boxplots bivariados </span></span>
<span id="cb37-1377"><a href="#cb37-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1378"><a href="#cb37-1378" aria-hidden="true" tabindex="-1"></a>Este tipo de visualización es recomendable para resumir gráficamente la información de la relación entre una *variable categórica* y una *variable cuantitativa*. Concretamente, se visualizan los gráficos de cajas para una variable cuantitativa, separados para cada valor posible de una variable categórica. Por lo tanto, permite ver cómo la variable cuantitativa se distribuye dentro de cada valor de una variable categórica.</span>
<span id="cb37-1379"><a href="#cb37-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1380"><a href="#cb37-1380" aria-hidden="true" tabindex="-1"></a>Para ello, podríamos ver el ingreso del trabajo (variable continua) por sexo (categórica). Pero, como ya vimos, los boxplots con variables con *tanta dispersión*, se ven feos y *comunican* mal. Ahora bien, algo que es recomendable para comprimir la escala y reducir la asimetría entre los valores para variables con mucha dispersión es aplicarle un logaritmo a la variable de interés. De hecho, esto es algo que se hace bastante con el ingreso. No me interesa profundizar en esto ahora, porque es algo que trateremos cuando lleguemos a regresiones. No obstante, si es de interés, en este punto, el capítulo 2 de @masteringmetrics ofrece una explicación didáctica y profunda. Además, en el apéndice de dicho capítulo, específicamente en el apartado "*Building Models with Logs*" o "Modelos logarítmicos" --en la traducción del libro--, se profundiza específicamente en la utilidad de aplicar logaritmos a variables como el ingreso. </span>
<span id="cb37-1381"><a href="#cb37-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1382"><a href="#cb37-1382" aria-hidden="true" tabindex="-1"></a>Veamos cómo queda el gráfico, que además <span class="in">`ggplot2`</span> tiene funciones para realizar transformaciones logarítmicas de las varaibles sin hacer recodificación previa. Primero lo hago con codificación previa ("manual") y luego en ggplot mismo. </span>
<span id="cb37-1383"><a href="#cb37-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1386"><a href="#cb37-1386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1387"><a href="#cb37-1387" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-boxplot-bivariado</span></span>
<span id="cb37-1388"><a href="#cb37-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1389"><a href="#cb37-1389" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb37-1390"><a href="#cb37-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor)) <span class="sc">|&gt;</span></span>
<span id="cb37-1391"><a href="#cb37-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-1392"><a href="#cb37-1392" aria-hidden="true" tabindex="-1"></a>    <span class="at">sexo        =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>)),</span>
<span id="cb37-1393"><a href="#cb37-1393" aria-hidden="true" tabindex="-1"></a>    <span class="at">log_ingreso =</span> <span class="fu">log</span>(ytrabajocor) <span class="co"># transformación manual</span></span>
<span id="cb37-1394"><a href="#cb37-1394" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb37-1395"><a href="#cb37-1395" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> log_ingreso, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb37-1396"><a href="#cb37-1396" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb37-1397"><a href="#cb37-1397" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb37-1398"><a href="#cb37-1398" aria-hidden="true" tabindex="-1"></a>      <span class="at">name   =</span> <span class="st">"Log(Ingreso de trabajo corregido)"</span>,</span>
<span id="cb37-1399"><a href="#cb37-1399" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> comma</span>
<span id="cb37-1400"><a href="#cb37-1400" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1401"><a href="#cb37-1401" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-1402"><a href="#cb37-1402" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb37-1403"><a href="#cb37-1403" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Boxplot de ingreso de trabajo corregido (log) por sexo"</span></span>
<span id="cb37-1404"><a href="#cb37-1404" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1405"><a href="#cb37-1405" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-1406"><a href="#cb37-1406" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb37-1407"><a href="#cb37-1407" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1408"><a href="#cb37-1408" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb37-1409"><a href="#cb37-1409" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb37-1410"><a href="#cb37-1410" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-1411"><a href="#cb37-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1412"><a href="#cb37-1412" aria-hidden="true" tabindex="-1"></a><span class="do">## Transformación logaritmica dentro de ggplot2</span></span>
<span id="cb37-1413"><a href="#cb37-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1414"><a href="#cb37-1414" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb37-1415"><a href="#cb37-1415" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ytrabajocor)) <span class="sc">|&gt;</span></span>
<span id="cb37-1416"><a href="#cb37-1416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sexo =</span> <span class="fu">factor</span>(sexo, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Hombre"</span>, <span class="st">"Mujer"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb37-1417"><a href="#cb37-1417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sexo, <span class="at">y =</span> ytrabajocor, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb37-1418"><a href="#cb37-1418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">outlier.color =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb37-1419"><a href="#cb37-1419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-1420"><a href="#cb37-1420" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-1421"><a href="#cb37-1421" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Sexo"</span>,</span>
<span id="cb37-1422"><a href="#cb37-1422" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Ingreso de trabajo corregido (escala log)"</span>,</span>
<span id="cb37-1423"><a href="#cb37-1423" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Boxplot de ingreso de trabajo corregido por sexo (escala log)"</span></span>
<span id="cb37-1424"><a href="#cb37-1424" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1425"><a href="#cb37-1425" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-1426"><a href="#cb37-1426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb37-1427"><a href="#cb37-1427" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title     =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1428"><a href="#cb37-1428" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text      =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb37-1429"><a href="#cb37-1429" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb37-1430"><a href="#cb37-1430" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-1431"><a href="#cb37-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1432"><a href="#cb37-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1433"><a href="#cb37-1433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1434"><a href="#cb37-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1435"><a href="#cb37-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1436"><a href="#cb37-1436" aria-hidden="true" tabindex="-1"></a>Como se puede observar, la comparación de ambos *boxplots* deja claro que, al final, la forma de la distribución (posición de cuartiles, mediana y “bigotes”) es exactamente la misma: la transformación logarítmica sólo reescala los datos de manera monotónica, sin alterar su orden ni la detección de *outliers*. De modo general, sobre los gráficos podemos decir: </span>
<span id="cb37-1437"><a href="#cb37-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1438"><a href="#cb37-1438" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>La mediana del ingreso de los hombres está algo por encima de la de las mujeres, lo cual se ve en ambos casos.</span>
<span id="cb37-1439"><a href="#cb37-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1440"><a href="#cb37-1440" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>El rango intercuartílico (caja) es ligeramente más amplio en los hombres, indicando mayor dispersión en el 50 % central.</span>
<span id="cb37-1441"><a href="#cb37-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1442"><a href="#cb37-1442" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Aparecen outliers en ambos sexos, sobre todo hacia los ingresos muy bajos y muy altos, que quedan marcados como puntos fuera de los “bigotes”.</span>
<span id="cb37-1443"><a href="#cb37-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1444"><a href="#cb37-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1445"><a href="#cb37-1445" aria-hidden="true" tabindex="-1"></a>Respecto a las diferencias gráficas según transformación logarítmica "manual" o *en* el código de <span class="in">`ggplot2`</span>: </span>
<span id="cb37-1446"><a href="#cb37-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1447"><a href="#cb37-1447" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Boxplot con transformación manual** (<span class="in">`log_ingreso`</span>): </span>
<span id="cb37-1448"><a href="#cb37-1448" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>En el eje Y leemos directamente la escala de log(ingreso). Por ejemplo, una mediana alrededor de 12,4 en hombres equivale a un ingreso de $\approx e^{12,4} \approx 2,4 \times^5 $, es decir, 240.000 pesos </span>
<span id="cb37-1449"><a href="#cb37-1449" aria-hidden="true" tabindex="-1"></a><span class="ss"> - </span>Es útil si nuestro interés está en trabajar explícitamente con valores logarítmicos (p. ej. para comparar diferencias porcentuales, como veremos después).</span>
<span id="cb37-1450"><a href="#cb37-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1451"><a href="#cb37-1451" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Boxplot con ggplot2** (<span class="in">`scale_y_log10()`</span>): </span>
<span id="cb37-1452"><a href="#cb37-1452" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Aquí el eje Y muestra los valores de ingreso en pesos, pero “espaciados” según su logaritmo. La mediana se lee directamente en unidades monetarias (p. ej. 200.00 vs 180.000), lo que facilita la interpretación sin cálculo inverso.</span>
<span id="cb37-1453"><a href="#cb37-1453" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Conserva el lenguaje natural de las unidades en el gráfico (no aparecen logaritmos ni ejes en valores crudos de log), pero controla la asimetría y comprime los outliers en una visual más manejable.</span>
<span id="cb37-1454"><a href="#cb37-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1455"><a href="#cb37-1455" aria-hidden="true" tabindex="-1"></a>En resumen, ambas aproximaciones equivalen en términos estadísticos. La elección depende de si quieres presentar valores ya en escala log (transformación manual) o prefieres mantener el eje en la unidad original (pesos) pero con la ventaja visual de una escala logarítmica que ofrece el paquete (<span class="in">`scale_y_log10()`</span>).</span>
<span id="cb37-1456"><a href="#cb37-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1457"><a href="#cb37-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1458"><a href="#cb37-1458" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gráficos de dispresión de puntos (*scatter plots*)</span></span>
<span id="cb37-1459"><a href="#cb37-1459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1460"><a href="#cb37-1460" aria-hidden="true" tabindex="-1"></a>Este tipo de gráficos es recomendable para resumir gráficamente la información de **la _asociación_ de dos variables cuantitativas**. Un gráfico de dispersión muestra cada observación como un punto en un sistema de coordenadas para dos variables cuantitativas. Por ejemplo, podríamos graficar la relación entre el ingreso del trabajo y los años de escolaridad.</span>
<span id="cb37-1461"><a href="#cb37-1461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1462"><a href="#cb37-1462" aria-hidden="true" tabindex="-1"></a>Ahora bien, un problema común que surge en los gráficos de dispersión es cuando los datos de muchas observaciones se intentan presentar en sólo una figura. En nuestro ejemplo, contamos con la información de más de 200.000 encuestados. En estos casos, es recomendable procesar antes los datos. Se pueden hacer varias cosas. Podrían crearse rangos de ingresos, por ejemplo, o tomar quintiles, deciles, etc., de ingresos. O bien, también podríamos aplicar una transformación logarítmica en los datos como hicimos anteriormente. </span>
<span id="cb37-1463"><a href="#cb37-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1464"><a href="#cb37-1464" aria-hidden="true" tabindex="-1"></a>Podemos hacer ambas, pero la verdad es que dependerá mucho de la variable cuál es mejor. Por ejemplo, si estuvieramos viendo puntajes PSU de Matemáticas y a su asociación al Ranking, sería útil hacer grupos. Pero para ingresos no funciona mucho esto. En las clases Estadística I de Engel y Díaz de la FEN se pasa el primer ejemplo. Se presentan primero sin agrupar y luego agrupando: </span>
<span id="cb37-1465"><a href="#cb37-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1466"><a href="#cb37-1466" aria-hidden="true" tabindex="-1"></a>&lt;img src="images-sesiones/grafico de dispersión sin procesar.png" </span>
<span id="cb37-1467"><a href="#cb37-1467" aria-hidden="true" tabindex="-1"></a>     alt="Datos sin agrupar" </span>
<span id="cb37-1468"><a href="#cb37-1468" aria-hidden="true" tabindex="-1"></a>     style="display: block; margin: auto;" /&gt;</span>
<span id="cb37-1469"><a href="#cb37-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1470"><a href="#cb37-1470" aria-hidden="true" tabindex="-1"></a>&lt;img src="images-sesiones/grafico de dispersion de puntos procesado.png" </span>
<span id="cb37-1471"><a href="#cb37-1471" aria-hidden="true" tabindex="-1"></a>     alt="Datos ya agrupados" </span>
<span id="cb37-1472"><a href="#cb37-1472" aria-hidden="true" tabindex="-1"></a>     style="display: block; margin: auto;" /&gt;</span>
<span id="cb37-1473"><a href="#cb37-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1474"><a href="#cb37-1474" aria-hidden="true" tabindex="-1"></a>Ahora bien, veamos cómo quedaría con ingreso esto. Primero tomaremos los déciles, registrados por la casen en <span class="in">`dau`</span> (Decil autónomo nacional) que se calculan tomando todos los ingresos del hogar (o sea, ya no ingresos del trabajo de los encuestados encuestado) y se dividen, siguiendo la lógica explicada en las *medidas de posición*, en 10 grupos. En este caso, el grupo 1 es el grupo de ingresos más bajos (el 10% más pobre) y el 10 es el de ingresos más altos (el 10% más rico). Luego, para ver si es un problema de que sean pocos grupos, lo haremos para percentiles (100 grupos). Para la otra variable, en ambos casos, usaremos <span class="in">`esc`</span> que mide los años de escolaridad (solo personas de 15 años en adelante) como variable cuantitativa discreta.</span>
<span id="cb37-1475"><a href="#cb37-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1478"><a href="#cb37-1478" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1479"><a href="#cb37-1479" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: scatter-plot</span></span>
<span id="cb37-1480"><a href="#cb37-1480" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1481"><a href="#cb37-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1482"><a href="#cb37-1482" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Scatter: escolaridad vs decil de ingreso del hogar</span></span>
<span id="cb37-1483"><a href="#cb37-1483" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb37-1484"><a href="#cb37-1484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(esc), dau <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb37-1485"><a href="#cb37-1485" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> esc, <span class="at">y =</span> dau)) <span class="sc">+</span></span>
<span id="cb37-1486"><a href="#cb37-1486" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"#4E79A7"</span>) <span class="sc">+</span></span>
<span id="cb37-1487"><a href="#cb37-1487" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb37-1488"><a href="#cb37-1488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-1489"><a href="#cb37-1489" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Años de escolaridad"</span>,</span>
<span id="cb37-1490"><a href="#cb37-1490" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Decil autónomo nacional"</span>,</span>
<span id="cb37-1491"><a href="#cb37-1491" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Dispersión: Escolaridad vs Decil de ingreso del hogar"</span></span>
<span id="cb37-1492"><a href="#cb37-1492" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1493"><a href="#cb37-1493" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb37-1494"><a href="#cb37-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1495"><a href="#cb37-1495" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Agrupar ingreso autónomo del hogar en 100 percentiles y graficar</span></span>
<span id="cb37-1496"><a href="#cb37-1496" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb37-1497"><a href="#cb37-1497" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(esc), <span class="sc">!</span><span class="fu">is.na</span>(yautcorh)) <span class="sc">|&gt;</span></span>
<span id="cb37-1498"><a href="#cb37-1498" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentil =</span> <span class="fu">ntile</span>(yautcorh, <span class="dv">100</span>)) <span class="sc">|&gt;</span></span>
<span id="cb37-1499"><a href="#cb37-1499" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> esc, <span class="at">y =</span> percentil)) <span class="sc">+</span></span>
<span id="cb37-1500"><a href="#cb37-1500" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">"#4E79A7"</span>) <span class="sc">+</span></span>
<span id="cb37-1501"><a href="#cb37-1501" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb37-1502"><a href="#cb37-1502" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-1503"><a href="#cb37-1503" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Años de escolaridad"</span>,</span>
<span id="cb37-1504"><a href="#cb37-1504" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Percentil de ingreso autónomo del hogar"</span>,</span>
<span id="cb37-1505"><a href="#cb37-1505" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Dispersión: Escolaridad vs Percentiles de ingreso"</span></span>
<span id="cb37-1506"><a href="#cb37-1506" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1507"><a href="#cb37-1507" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb37-1508"><a href="#cb37-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1509"><a href="#cb37-1509" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1510"><a href="#cb37-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1511"><a href="#cb37-1511" aria-hidden="true" tabindex="-1"></a>Ahora bien, en ninguno de los casos se ve bien. Esto es por dos motivos: 1) ambas variables son discretas con muy pocos valores únicos (<span class="in">`esc`</span> y <span class="in">`dau`</span>). Pero, incluso si aumentamos a 100 grupos, y ya no usamos <span class="in">`dau`</span>, tampoco funciona. En realidad, esto nuevamente se debe a la naturaleza de la variable ingreso, que es continua y tiene un rango muy alto. 2) Esto último produce lo que se conoce como *overplotting*, que en nuestro caso, con más de 200.000 observaciones, incluso un pequeño desplazamiento de jitter deja millones de puntos amontonados, de modo que no se distingue ninguna tendencia ni densidad real.</span>
<span id="cb37-1512"><a href="#cb37-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1513"><a href="#cb37-1513" aria-hidden="true" tabindex="-1"></a>Entonces, para lo que queremos graficar, en este caso, ingresos y su asociación son el nivel de escolaridad, no nos sirve tomar dos variables discretas, aunque sean cuantitativas ambas. Probemos, entonces, si el viejo logaritmo nos ayuda en este caso. </span>
<span id="cb37-1514"><a href="#cb37-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1515"><a href="#cb37-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1518"><a href="#cb37-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1519"><a href="#cb37-1519" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: scatter-plot2</span></span>
<span id="cb37-1520"><a href="#cb37-1520" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1521"><a href="#cb37-1521" aria-hidden="true" tabindex="-1"></a>casen2022 <span class="sc">|&gt;</span></span>
<span id="cb37-1522"><a href="#cb37-1522" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(esc), <span class="sc">!</span><span class="fu">is.na</span>(yautcorh)) <span class="sc">|&gt;</span></span>
<span id="cb37-1523"><a href="#cb37-1523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> esc, <span class="at">y =</span> yautcorh)) <span class="sc">+</span></span>
<span id="cb37-1524"><a href="#cb37-1524" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"#ADD8E6"</span>) <span class="sc">+</span></span>
<span id="cb37-1525"><a href="#cb37-1525" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-1526"><a href="#cb37-1526" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-1527"><a href="#cb37-1527" aria-hidden="true" tabindex="-1"></a>      <span class="at">x     =</span> <span class="st">"Años de escolaridad"</span>,</span>
<span id="cb37-1528"><a href="#cb37-1528" aria-hidden="true" tabindex="-1"></a>      <span class="at">y     =</span> <span class="st">"Ingreso autónomo corregido (escala log)"</span>,</span>
<span id="cb37-1529"><a href="#cb37-1529" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Dispersión: Escolaridad vs Ingreso (log)"</span></span>
<span id="cb37-1530"><a href="#cb37-1530" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-1531"><a href="#cb37-1531" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb37-1532"><a href="#cb37-1532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1533"><a href="#cb37-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1534"><a href="#cb37-1534" aria-hidden="true" tabindex="-1"></a>Como se ve, ahora si el gráfico nos comunica algo más comprensible. Además, se puede ver cómo va reduciendo la dispersión en cuanto avanzan los años de escolaridad. Es importante resaltar la cantidad de *outliers* que hay que notienen ingresos autónomos, aún avancen los años de escolaridad. Esto también puede tener que ver con que estamos usando ingresos autónomos del hogar y no de los individuos. Pero, a saber. No voy a profundizar en esto ahora. </span>
<span id="cb37-1535"><a href="#cb37-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1536"><a href="#cb37-1536" aria-hidden="true" tabindex="-1"></a>Lo que si me parece más interesante ahora es adelantar algo bacán que se puede hacer con <span class="in">`ggplot2`</span> y los *scatterplots*. Esta tendencia que vemos en los datos, también podemos inmediatamente modelarla. El paquete permite, al graficar la dispersión de los datos, trazar una linea de tendencia con bandas de error estándar mediante un modelo lineal. Como ya advertimos antes, ahora es aún más útil aplicar <span class="in">`log()`</span>, porque dado que los ingresos no se comportan con una distribución normal, transformamos el eje x (<span class="in">`yautcorh`</span>) de una escala linear a una escala logarítmica. Esto nos permitirá un mejor ajuste de la línea de regresión estimada. Luego, cuando lleguemos a regresiones, veremos la utilidad de esto, como ya he ido adelantando. También podemos ajustar los valores de ingres a una notación mas adecuada, en este caso, pesos chilenos.</span>
<span id="cb37-1537"><a href="#cb37-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1538"><a href="#cb37-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1541"><a href="#cb37-1541" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1542"><a href="#cb37-1542" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: scatter-plot-regresion</span></span>
<span id="cb37-1543"><a href="#cb37-1543" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1544"><a href="#cb37-1544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1545"><a href="#cb37-1545" aria-hidden="true" tabindex="-1"></a><span class="co">#Scatter plot con línea de regresión</span></span>
<span id="cb37-1546"><a href="#cb37-1546" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb37-1547"><a href="#cb37-1547" aria-hidden="true" tabindex="-1"></a>  casen2022 <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(esc), <span class="sc">!</span><span class="fu">is.na</span>(yautcorh)),</span>
<span id="cb37-1548"><a href="#cb37-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> esc, <span class="at">y =</span> yautcorh)</span>
<span id="cb37-1549"><a href="#cb37-1549" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb37-1550"><a href="#cb37-1550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">color =</span> <span class="st">"#36648B"</span>) <span class="sc">+</span></span>
<span id="cb37-1551"><a href="#cb37-1551" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(</span>
<span id="cb37-1552"><a href="#cb37-1552" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"gam"</span>,</span>
<span id="cb37-1553"><a href="#cb37-1553" aria-hidden="true" tabindex="-1"></a>    <span class="at">se     =</span> <span class="cn">TRUE</span>,</span>
<span id="cb37-1554"><a href="#cb37-1554" aria-hidden="true" tabindex="-1"></a>    <span class="at">color  =</span> <span class="st">"#8B0000"</span>,</span>
<span id="cb37-1555"><a href="#cb37-1555" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill   =</span> <span class="st">"#696969"</span>,</span>
<span id="cb37-1556"><a href="#cb37-1556" aria-hidden="true" tabindex="-1"></a>    <span class="at">size   =</span> <span class="dv">1</span></span>
<span id="cb37-1557"><a href="#cb37-1557" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-1558"><a href="#cb37-1558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">dollar_format</span>(<span class="at">prefix =</span> <span class="st">"$"</span>, <span class="at">suffix =</span> <span class="st">" CLP"</span>)) <span class="sc">+</span></span>
<span id="cb37-1559"><a href="#cb37-1559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-1560"><a href="#cb37-1560" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Años de escolaridad"</span>,</span>
<span id="cb37-1561"><a href="#cb37-1561" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Ingreso autónomo corregido del hogar"</span>,</span>
<span id="cb37-1562"><a href="#cb37-1562" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Nivel de ingreso autónomo corregido según años de escolaridad"</span></span>
<span id="cb37-1563"><a href="#cb37-1563" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-1564"><a href="#cb37-1564" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-1565"><a href="#cb37-1565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-1566"><a href="#cb37-1566" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1567"><a href="#cb37-1567" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-1568"><a href="#cb37-1568" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-1569"><a href="#cb37-1569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1570"><a href="#cb37-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1571"><a href="#cb37-1571" aria-hidden="true" tabindex="-1"></a>Entonces, y ahora sí, el gráfico muestra, en escala logarítmica, cómo varía el ingreso autónomo corregido del hogar según los años de escolaridad (para personas de 15 años en adelante). De este *scatter plot* se puede interpretar que hay</span>
<span id="cb37-1572"><a href="#cb37-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1573"><a href="#cb37-1573" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Tendencia creciente**. La línea de tendencia sube de izquierda a derecha, lo que indica que a más años de escolaridad corresponde, en promedio, un ingreso mayor; </span>
<span id="cb37-1574"><a href="#cb37-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1575"><a href="#cb37-1575" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>No obstante, existen **rendimientos decrecientes**. La pendiente es más pronunciada en los primeros años de escolaridad y se aplana conforme avanzamos hacia niveles superiores, sugiriendo que cada año adicional de educación añade menos aumento porcentual al ingreso que el año anterior.</span>
<span id="cb37-1576"><a href="#cb37-1576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1577"><a href="#cb37-1577" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Alta dispersión**. A cualquier nivel de escolaridad hay una enorme variabilidad de ingresos (nubes de puntos muy extendidas). Esto refleja que, aunque el promedio sube con la educación, los ingresos individuales probablemente dependen también de otros factores (sector, experiencia, género, etc., a saber).</span>
<span id="cb37-1578"><a href="#cb37-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1579"><a href="#cb37-1579" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Respecto a la **confianza de la curva**, se puede observar que la banda gris alrededor de la línea es más estrecha en los niveles de escolaridad donde hay más observaciones (por ejemplo entre 8 y 12 años) y más ancha en los extremos (muy poca gente con 0 ó &gt;20 años), lo que nos habla de mayor incertidumbre al estimar la relación fuera del rango central.</span>
<span id="cb37-1580"><a href="#cb37-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1581"><a href="#cb37-1581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1582"><a href="#cb37-1582" aria-hidden="true" tabindex="-1"></a>En suma, el gráfico confirma una asociación positiva entre educación e ingreso, con incrementos relativos mayores al inicio de la escolaridad y un efecto suavemente decreciente en los niveles más altos. </span>
<span id="cb37-1583"><a href="#cb37-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1584"><a href="#cb37-1584" aria-hidden="true" tabindex="-1"></a>Finalmente, respecto a los gráficos de tipo *scatter plot*, hay que tener ojo qué tipo de variables vamos a visualizar. No basta con asociar dos variables cuantitativas, sino que también hay que fijarse en si son discretas, continuas, en la cantidad de observaciones, etc.; en definitiva, en la naturaleza de las variables asociadas. A menudo, tendremos que realizar transformaciones a nuestras variables para que el gráfico **comunique mejor** el carácter de la asociación de las variables de interés.</span>
<span id="cb37-1585"><a href="#cb37-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1586"><a href="#cb37-1586" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Estadística inferencial: una introducción</span></span>
<span id="cb37-1587"><a href="#cb37-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1588"><a href="#cb37-1588" aria-hidden="true" tabindex="-1"></a>Retomemos algunas cosas y veamos algunas cosas con las que deberíamos haber comenzado todo, pero que por cuestiones del curso no alcanzan. Partamos por qué es una *variable aleatoria*.</span>
<span id="cb37-1589"><a href="#cb37-1589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1590"><a href="#cb37-1590" aria-hidden="true" tabindex="-1"></a><span class="fu">### Variables aleatorias: funciones y distribución de probabilidad</span></span>
<span id="cb37-1591"><a href="#cb37-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1592"><a href="#cb37-1592" aria-hidden="true" tabindex="-1"></a>La probabilidad es una medida que nos entrega un grado de *certidumbre* de que ocurra un evento *incierto*. La teoría de la probabilidad es la base de toda estadístíca y, por tanto, de la econometría. Y la base de la probabilidad es la teoría de conjuntos y la matemática. Teníamos que la probabilidad intenta *asignar* a cada evento de un experimento un valor $(\in \mathbb{R})$ para capturar la frecuencia del evento si el experiemento fuese repetido muchas veces. De ello, deducimos los axiomas de la probabilidad y otras propiedades que eran consecuencias de ellos. Finalmente, examinamos los tipos de probabilidades (conjunta, margianl y condicional), poniendo un énfasis especial en la probabilidad condicional y la independencia estadística entre eventos. Con todo eso, veamos qué es una variable aleatoria. </span>
<span id="cb37-1593"><a href="#cb37-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1594"><a href="#cb37-1594" aria-hidden="true" tabindex="-1"></a>Una variable aleatoria es "una función de valor real para la cual el dominio es un espacio </span>
<span id="cb37-1595"><a href="#cb37-1595" aria-hidden="true" tabindex="-1"></a>muestral" (<span class="co">[</span><span class="ot">Wackerly, et al., 2010, p. 76</span><span class="co">](https://www.cimat.mx/ciencia_para_jovenes/bachillerato/libros/[Wackerly,Mendenhall,Scheaffer]Estadistica_Matematica_con_Aplicaciones.pdf)</span>). Una variable aleatoria (v.a.), así, toma valores que son determinados por un proceso aleatorio, que muchas veces puede ser un proceso natural estocástico.^<span class="co">[</span><span class="ot">Un proceso estocástico es aquel cuyo resultado no puede preverse con certeza de antemano. En cambio, un proceso determinista produce siempre el mismo resultado cuando se parte de una misma condición inicial. Por ejemplo, lanzar una moneda es un proceso estocástico, mientras que sumar dos números concretos es un proceso determinista. Luego lo usaremos como homólogo de proceso aleatorio</span><span class="co">]</span>. De tal modo, una v.a. no es más que una representación numérica de los resultados potenciales de un experimento. Formalmente,</span>
<span id="cb37-1596"><a href="#cb37-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1597"><a href="#cb37-1597" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb37-1598"><a href="#cb37-1598" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definición</span></span>
<span id="cb37-1599"><a href="#cb37-1599" aria-hidden="true" tabindex="-1"></a>Sea $\mbox{S}$ el espacio muestral de un experimento. Una función de valor real definida en $\mbox{S}$ se denomina *variable aleatoria* (DeGroot y Schervish, 2014, p. 93)</span>
<span id="cb37-1600"><a href="#cb37-1600" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-1601"><a href="#cb37-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1602"><a href="#cb37-1602" aria-hidden="true" tabindex="-1"></a>De tal modo, dado que una variable aleatoria es un resumen numérico de algún resultado de interés. Y que, formalmente, es una función que asocia un número real a cada elemento de $\mbox{S}$, podemos representarla matemáticamente como</span>
<span id="cb37-1603"><a href="#cb37-1603" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1604"><a href="#cb37-1604" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-1605"><a href="#cb37-1605" aria-hidden="true" tabindex="-1"></a>    X&amp;:\mbox{S} \longrightarrow \mathbb{R}<span class="sc">\\</span></span>
<span id="cb37-1606"><a href="#cb37-1606" aria-hidden="true" tabindex="-1"></a>    &amp;u \longrightarrow X(u).</span>
<span id="cb37-1607"><a href="#cb37-1607" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-1608"><a href="#cb37-1608" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1609"><a href="#cb37-1609" aria-hidden="true" tabindex="-1"></a>Por ejemplo, imaginemos que lanzamos una moneda 2 veces, tal que su  espacio muestral es $S = <span class="sc">\{</span>cc, cs, sc, ss<span class="sc">\}</span>$. Definimos, pues, la variable aleatoria $X$ que es el número de caras en los dos lanzamientos.</span>
<span id="cb37-1610"><a href="#cb37-1610" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1611"><a href="#cb37-1611" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-1612"><a href="#cb37-1612" aria-hidden="true" tabindex="-1"></a>    X(cc) &amp;= 2 <span class="sc">\\</span></span>
<span id="cb37-1613"><a href="#cb37-1613" aria-hidden="true" tabindex="-1"></a>    X(cs) &amp;= 1 <span class="sc">\\</span></span>
<span id="cb37-1614"><a href="#cb37-1614" aria-hidden="true" tabindex="-1"></a>    X(sc) &amp;= 1 <span class="sc">\\</span></span>
<span id="cb37-1615"><a href="#cb37-1615" aria-hidden="true" tabindex="-1"></a>    X(ss) &amp;= 0</span>
<span id="cb37-1616"><a href="#cb37-1616" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-1617"><a href="#cb37-1617" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1618"><a href="#cb37-1618" aria-hidden="true" tabindex="-1"></a>En el fondo, para cada caso que saliera cara, $c$, la función arrojaba cuántos $c$ hay en el espacio muestral en función de cómo la evaluáramos. Por ende, $X$ puede tomar los valores 0, 1 y 2, solamente. En efecto, la principal virtud de las variables aleatorias es que nos permiten describir eventos de forma sencilla. Tomando el caso anterior,</span>
<span id="cb37-1619"><a href="#cb37-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1620"><a href="#cb37-1620" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$<span class="sc">\{</span>X = 0<span class="sc">\}</span> \iff$ Todos los elementos en $S$ que no tienen caras  = $<span class="sc">\{</span>ss<span class="sc">\}</span>$. Por lo tanto,</span>
<span id="cb37-1621"><a href="#cb37-1621" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1622"><a href="#cb37-1622" aria-hidden="true" tabindex="-1"></a>    \Pr(X = 0) = \Pr(<span class="sc">\{</span>ss<span class="sc">\}</span>) = \frac{1}{4}.</span>
<span id="cb37-1623"><a href="#cb37-1623" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1624"><a href="#cb37-1624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1625"><a href="#cb37-1625" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$<span class="sc">\{</span>X = 1<span class="sc">\}</span> \iff$ Todos los elementos en $S$ que tienen una cara = $<span class="sc">\{</span>cs, sc<span class="sc">\}</span>$. Por lo tanto,</span>
<span id="cb37-1626"><a href="#cb37-1626" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1627"><a href="#cb37-1627" aria-hidden="true" tabindex="-1"></a>\Pr(X = 1) = \Pr(<span class="sc">\{</span>cs, sc<span class="sc">\}</span>) = \frac{1}{4} + \frac{1}{4} = \frac{1}{2}.</span>
<span id="cb37-1628"><a href="#cb37-1628" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1629"><a href="#cb37-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1630"><a href="#cb37-1630" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$<span class="sc">\{</span>X = 2<span class="sc">\}</span> \iff$ Todos los elementos en $S$ que tienen dos caras = $<span class="sc">\{</span>cc<span class="sc">\}</span>$. Por lo tanto,</span>
<span id="cb37-1631"><a href="#cb37-1631" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1632"><a href="#cb37-1632" aria-hidden="true" tabindex="-1"></a>\Pr(X = 2) = \Pr(<span class="sc">\{</span>cc<span class="sc">\}</span>) = \frac{1}{4}.</span>
<span id="cb37-1633"><a href="#cb37-1633" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1634"><a href="#cb37-1634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1635"><a href="#cb37-1635" aria-hidden="true" tabindex="-1"></a>Ahora bien, a partir de un espacio muestral podemos crear diversas variables aleatorias. En el ejemplo anterior creamos el número de caras, pero también podemos denotar por $Y$ la v.a. que cuenta el número de sellos.</span>
<span id="cb37-1636"><a href="#cb37-1636" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1637"><a href="#cb37-1637" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-1638"><a href="#cb37-1638" aria-hidden="true" tabindex="-1"></a>Y(cc) &amp;= 0 <span class="sc">\\</span></span>
<span id="cb37-1639"><a href="#cb37-1639" aria-hidden="true" tabindex="-1"></a>Y(cs) &amp;= 1 <span class="sc">\\</span></span>
<span id="cb37-1640"><a href="#cb37-1640" aria-hidden="true" tabindex="-1"></a>Y(sc) &amp;= 1 <span class="sc">\\</span></span>
<span id="cb37-1641"><a href="#cb37-1641" aria-hidden="true" tabindex="-1"></a>Y(ss) &amp;= 2</span>
<span id="cb37-1642"><a href="#cb37-1642" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-1643"><a href="#cb37-1643" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1644"><a href="#cb37-1644" aria-hidden="true" tabindex="-1"></a>A partir de un espacio muestral podemos crear diversas variables aleatorias. En el ejemplo anterior creamos el número de caras, pero también podemos denotar por $Y$ la v.a. que cuenta el número de sellos. Finalmente, notemos que por definición</span>
<span id="cb37-1645"><a href="#cb37-1645" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1646"><a href="#cb37-1646" aria-hidden="true" tabindex="-1"></a>X + Y = 2.</span>
<span id="cb37-1647"><a href="#cb37-1647" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1648"><a href="#cb37-1648" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Tipos de variables aleatorias y distribuciones de probabilidad asociada</span></span>
<span id="cb37-1649"><a href="#cb37-1649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1650"><a href="#cb37-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1651"><a href="#cb37-1651" aria-hidden="true" tabindex="-1"></a>Quizás como ya podrían intuir, hay dos grandes grupos de variables aleatorias: las discretas y las continuas. En este curso, no profundizaremos en esto, pero si mencionaremos brevemente algunas cuestiones importantes antes de llegar al estadística inferencial. </span>
<span id="cb37-1652"><a href="#cb37-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1653"><a href="#cb37-1653" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Variables aleatorias discretas</span></span>
<span id="cb37-1654"><a href="#cb37-1654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1655"><a href="#cb37-1655" aria-hidden="true" tabindex="-1"></a>Una variable aleatoria discreta es aquella que toma un número finito o numerable de valores. Por ejemplo, el el resultado de lanzar un dado. Formalmente, diremos que </span>
<span id="cb37-1656"><a href="#cb37-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1657"><a href="#cb37-1657" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb37-1658"><a href="#cb37-1658" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definición</span></span>
<span id="cb37-1659"><a href="#cb37-1659" aria-hidden="true" tabindex="-1"></a>Una v.a. $X$ es \textit{discreta} si existe un conjunto finito $A = <span class="sc">\{</span>a_1, a_2, ..., a_n<span class="sc">\}</span>$ tal que </span>
<span id="cb37-1660"><a href="#cb37-1660" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1661"><a href="#cb37-1661" aria-hidden="true" tabindex="-1"></a>\Pr(X \text{ toma valores en } A) = 1.</span>
<span id="cb37-1662"><a href="#cb37-1662" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1663"><a href="#cb37-1663" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-1664"><a href="#cb37-1664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1665"><a href="#cb37-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1666"><a href="#cb37-1666" aria-hidden="true" tabindex="-1"></a>Tenemos, entonces, que la variable aleatoria captura la información contenida en todo el espacio muestral del experimento en una cantidad numérica. Ahora bien, el valor del experimento, por definición, no se conoce, dada su naturaleza aleatoria. Lo que conocemos, en cambio, es $\mathbb{S}$. Es decir, que conocemos todos los resultados potenciales del experimento aleatorio. Del lanzamiento de un dado, no sabemos qué va salir exactamente, pero sí sabemos que solo puede salir entre 1 y 6. No puede salir 7, ni Spiderman, ni Conchalí. Porque esos son valores que no pertenecen a $\mathbb{S}$. Entonces, tenemos que volver ahora al concepto de función de probabilidad, incorporando este nuevo conocimiento. </span>
<span id="cb37-1667"><a href="#cb37-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1668"><a href="#cb37-1668" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb37-1669"><a href="#cb37-1669" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definición</span></span>
<span id="cb37-1670"><a href="#cb37-1670" aria-hidden="true" tabindex="-1"></a>Consideremos una v.a. discreta $X$ definida sobre un espacio muestral $\mathbb{S}$. Entonces la **función de probabilidad** (f.p.) de $X$ se define como: </span>
<span id="cb37-1671"><a href="#cb37-1671" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1672"><a href="#cb37-1672" aria-hidden="true" tabindex="-1"></a>f(x) = \Pr(X = x).</span>
<span id="cb37-1673"><a href="#cb37-1673" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-1674"><a href="#cb37-1674" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-1675"><a href="#cb37-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1676"><a href="#cb37-1676" aria-hidden="true" tabindex="-1"></a>La expresión $f(x) = \Pr(X = x)$ nos dice que la fdp de $X$ evaluada en un valor particular de $x$ se corresponde con la probabilidad de que la v.a. $X$ tome algún valor de $x$. Es decir, que $X$ corresponde a la v.a., mientras que $x$ corresponde algún valor particular de $X$. Además, se tiene que $f(x)&gt;0$, i.e., es estrictamente positivo para $x$ en el soporte de $X$ y $f(x)=0$, i.e., vale 0 cualquier otro caso, o sea,  en caso contrario. </span>
<span id="cb37-1677"><a href="#cb37-1677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1678"><a href="#cb37-1678" aria-hidden="true" tabindex="-1"></a>Por ejemplo, si se lanza una moneda honesta 2 veces. Entonces</span>
<span id="cb37-1679"><a href="#cb37-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1680"><a href="#cb37-1680" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variable aleatoria $X$: número de caras en los 2 lanzamientos.</span>
<span id="cb37-1681"><a href="#cb37-1681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1682"><a href="#cb37-1682" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variable aleatoria $Y$: número de sellos en los 2 lanzamientos.</span>
<span id="cb37-1683"><a href="#cb37-1683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1684"><a href="#cb37-1684" aria-hidden="true" tabindex="-1"></a>¿Cuál es la f.p. de $X$? Ya deberíamos saber que</span>
<span id="cb37-1685"><a href="#cb37-1685" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1686"><a href="#cb37-1686" aria-hidden="true" tabindex="-1"></a>f(0) = \frac{1}{4}, \quad f(1) = \frac{1}{2}, \quad f(2) = \frac{1}{4}, \quad f(x) = 0 \quad \text{para cualquier otro valor de } x.</span>
<span id="cb37-1687"><a href="#cb37-1687" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1688"><a href="#cb37-1688" aria-hidden="true" tabindex="-1"></a>pero ahora además le agregamos que $f(x)=0$ es cualquier otro valor. ¿Y cuál es la f.p. de $Y$? Por simetría, ya veíamos que era exactamente la misma probabilidad que la f.p. de $X$. Ahora bien, a pesar de que $X$ e $Y$ tienen la misma **función de probabilidad**, *no* son la misma v.a. Por ejemplo, cuando salen 2 caras, tenemos que $X(cc)=2$ e $Y(cc)=0$. Veamos ejemplos de variables aleatorias discretas y sus distribuciones de probabilidad. </span>
<span id="cb37-1689"><a href="#cb37-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1690"><a href="#cb37-1690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1691"><a href="#cb37-1691" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Distribución uniforme discreta</span></span>
<span id="cb37-1692"><a href="#cb37-1692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1693"><a href="#cb37-1693" aria-hidden="true" tabindex="-1"></a>Una distribución uniforme discreta (UD) corresponde a una función de probabilidad donde todos los eventos tienen la misma probabilidad, como el lanzamiento de un dado. Si se tiene que $m$ y $n$ son números enteros tales que $m \leq n$, que $X$ es una v.a. discreta, $X$ tendrá una distribución uniforme discreta entre los eventos $m$ y $n$, o $X\sim UD(m,n)$ si se cumple que</span>
<span id="cb37-1694"><a href="#cb37-1694" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1695"><a href="#cb37-1695" aria-hidden="true" tabindex="-1"></a>f(x) =</span>
<span id="cb37-1696"><a href="#cb37-1696" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb37-1697"><a href="#cb37-1697" aria-hidden="true" tabindex="-1"></a>\frac{1}{n-m+1} &amp; x=m, m+1, \ldots, n<span class="sc">\\</span></span>
<span id="cb37-1698"><a href="#cb37-1698" aria-hidden="true" tabindex="-1"></a>0 &amp; \text{en caso contrario}</span>
<span id="cb37-1699"><a href="#cb37-1699" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb37-1700"><a href="#cb37-1700" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1701"><a href="#cb37-1701" aria-hidden="true" tabindex="-1"></a>Notemos, además, que la distribución de probabilidad de una v.a. discreta suma 1.</span>
<span id="cb37-1702"><a href="#cb37-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1703"><a href="#cb37-1703" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Distribución de Bernoulli </span></span>
<span id="cb37-1704"><a href="#cb37-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1705"><a href="#cb37-1705" aria-hidden="true" tabindex="-1"></a>Una variable aleatoria $X$ sigue una **distribución de Bernoulli** si solo toma dos valores, específicamente $0$ o $1$. Es decir que $X$ sigue una distribución de Bernoulli de parámetro $p\in <span class="co">[</span><span class="ot">0,1</span><span class="co">]</span>$ si $X$ toma valores $0$ o $1$ y si $\Pr(X=1)=p$. Esto lo denotamos como $X\sim \mbox{Bern}(p)$</span>
<span id="cb37-1706"><a href="#cb37-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1707"><a href="#cb37-1707" aria-hidden="true" tabindex="-1"></a>Entonces, si $X \sim \mbox{Bern}(p)$ la función de probabilidad, denotada por $f(x)$ es</span>
<span id="cb37-1708"><a href="#cb37-1708" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1709"><a href="#cb37-1709" aria-hidden="true" tabindex="-1"></a>f(x) =</span>
<span id="cb37-1710"><a href="#cb37-1710" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb37-1711"><a href="#cb37-1711" aria-hidden="true" tabindex="-1"></a>    p &amp; \text{si } x = 1, <span class="sc">\\</span></span>
<span id="cb37-1712"><a href="#cb37-1712" aria-hidden="true" tabindex="-1"></a>    1 - p &amp; \text{si } x = 0, <span class="sc">\\</span></span>
<span id="cb37-1713"><a href="#cb37-1713" aria-hidden="true" tabindex="-1"></a>    0 &amp; \text{si } x \notin <span class="sc">\{</span>0, 1<span class="sc">\}</span></span>
<span id="cb37-1714"><a href="#cb37-1714" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb37-1715"><a href="#cb37-1715" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1716"><a href="#cb37-1716" aria-hidden="true" tabindex="-1"></a>Es habitual para experimentos con solo dos resultados posibles que se interpreten los dos resultados posibles como éxito y fracaso, i.e., $X=1$ es considerado como éxito y $X=0$ como fracaso. Por ejemplo, si al lanzar una moneda, definimos $X$ según: si sale cara, $X = 1$; y si sale sello, $X = 0$. Entonces, </span>
<span id="cb37-1717"><a href="#cb37-1717" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1718"><a href="#cb37-1718" aria-hidden="true" tabindex="-1"></a>p = \frac{1}{2}, \quad X \sim \text{Ber}(0,5). </span>
<span id="cb37-1719"><a href="#cb37-1719" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1720"><a href="#cb37-1720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1721"><a href="#cb37-1721" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Distribución Binomial: Ensayos de Bernoulli y coeficiente binomial</span></span>
<span id="cb37-1722"><a href="#cb37-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1723"><a href="#cb37-1723" aria-hidden="true" tabindex="-1"></a>Antes de ver distribución binomial, conviene ver un concepto previo, los famosos "**Ensayos de Bernoulli**". Una *secuencia de ensayos de Bernoulli* es una secuencia $X_1, X_2, \dots, X_n$ de variables aleatorias independientes con distribución común $\mbox{Bern}(p)$, donde $0 \leq p \leq 1$. Es decir, una secuencia de $n$ ensayos de Bernoulli es una secuencia de ensayos que cumple lo siguiente:</span>
<span id="cb37-1724"><a href="#cb37-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1725"><a href="#cb37-1725" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Solo dos resultados posibles en cada ensayo: 1 (éxito) y 0 (fracaso).</span>
<span id="cb37-1726"><a href="#cb37-1726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1727"><a href="#cb37-1727" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Ensayos *independientes*.</span>
<span id="cb37-1728"><a href="#cb37-1728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1729"><a href="#cb37-1729" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>La misma probabilidad de éxito en cada ensayo.</span>
<span id="cb37-1730"><a href="#cb37-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1731"><a href="#cb37-1731" aria-hidden="true" tabindex="-1"></a>De tal modo, formalizando, diremos que una **secuencia de ensayos de Bernoulli** es una seguidilla de variables aleatorias independientes, tal que</span>
<span id="cb37-1732"><a href="#cb37-1732" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1733"><a href="#cb37-1733" aria-hidden="true" tabindex="-1"></a>X_1 \sim \mbox{Bern}(p), X_2 \sim \mbox{Bern}(p), \ldots , X_n \sim \mbox{Bern}(p)</span>
<span id="cb37-1734"><a href="#cb37-1734" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1735"><a href="#cb37-1735" aria-hidden="true" tabindex="-1"></a>donde $0\leq p \leq 1$. En otras palabras, una secuencia de $n$ ensayos de Bernoulli cumple co que se realizan $n$ experimentos donde hay dos resultados posibles (éxito o fracaso, 1 o 0), que son independientes y donde la probabilidad de éxito es la misma para cada ensayo. Ahora bien, cuando hablemos de la *distribución* de una secuencia de $n$ ensayos de Bernoullli con parámetro $p$ o probabilidad de éxito $p$, estamos hablando de una **distribución binomial**. </span>
<span id="cb37-1736"><a href="#cb37-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1737"><a href="#cb37-1737" aria-hidden="true" tabindex="-1"></a>Una variable aleatoria $X$ sigue una **distribución binomial** con parámetros $n$ y $p$ si $X$ tiene una distribución discreta con función de probabilidad:</span>
<span id="cb37-1738"><a href="#cb37-1738" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1739"><a href="#cb37-1739" aria-hidden="true" tabindex="-1"></a>f(x) = </span>
<span id="cb37-1740"><a href="#cb37-1740" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb37-1741"><a href="#cb37-1741" aria-hidden="true" tabindex="-1"></a>\binom{n}{x} p^x (1-p)^{n-x} &amp; \text{para } x = 0, 1, 2, \dots, n, <span class="sc">\\</span></span>
<span id="cb37-1742"><a href="#cb37-1742" aria-hidden="true" tabindex="-1"></a>0 &amp; \text{si no.}</span>
<span id="cb37-1743"><a href="#cb37-1743" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb37-1744"><a href="#cb37-1744" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1745"><a href="#cb37-1745" aria-hidden="true" tabindex="-1"></a>El parámetro $n$ es un entero mayor o igual que uno, mientras que $p$ pertenece al intervalo $<span class="sc">\{</span>0,1<span class="sc">\}</span>$. Escribimos $X \sim \text{Bin}(n, p)$ y decimos "**$X$ sigue una Binomial con parámetros $n$ y $p$**".</span>
<span id="cb37-1746"><a href="#cb37-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1747"><a href="#cb37-1747" aria-hidden="true" tabindex="-1"></a>Algo que se suele ver en conteo y combinatoria, y que no incluyo en este apunte, es el **coeficiente binomial**. Este se escribe como</span>
<span id="cb37-1748"><a href="#cb37-1748" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1749"><a href="#cb37-1749" aria-hidden="true" tabindex="-1"></a>\binom{n}{x} = \frac{n!}{x!(n-x)!}</span>
<span id="cb37-1750"><a href="#cb37-1750" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1751"><a href="#cb37-1751" aria-hidden="true" tabindex="-1"></a>y en combinatoria representa el número de formas de escoger (sin importar el orden) un subconjunto de $x$ objetos extraídos de un conjunto de $n$ objetos distintos. Por ejemplo, si se tiene $n=5$ frutas distintas y queremos saber de cuántas maneras puede elegir $x=2$ de ellas, se hace lo siguiente: </span>
<span id="cb37-1752"><a href="#cb37-1752" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1753"><a href="#cb37-1753" aria-hidden="true" tabindex="-1"></a>\binom{n}{x} = \frac{n!}{x!(n-x)!} = \frac{5!}{2!3!} = \frac{120}{2 \cdot 6} = 10</span>
<span id="cb37-1754"><a href="#cb37-1754" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1755"><a href="#cb37-1755" aria-hidden="true" tabindex="-1"></a>Es decir, hay 10 pares distintos que se pueden formar. Esto tiene las siguiente propiedades clave (que usaremos para un teorema de sobre la distribución binomial y ensayos de Bernoulli, por eso lo coloco): </span>
<span id="cb37-1756"><a href="#cb37-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1757"><a href="#cb37-1757" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Simetría**  </span>
<span id="cb37-1758"><a href="#cb37-1758" aria-hidden="true" tabindex="-1"></a>  $$\binom{n}{x} = \binom{n}{n - x}$$  </span>
<span id="cb37-1759"><a href="#cb37-1759" aria-hidden="true" tabindex="-1"></a>  Elegir <span class="sc">\(</span>x<span class="sc">\)</span> de <span class="sc">\(</span>n<span class="sc">\)</span> es lo mismo que elegir los <span class="sc">\(</span>n - x<span class="sc">\)</span> que quedan fuera.</span>
<span id="cb37-1760"><a href="#cb37-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1761"><a href="#cb37-1761" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Valor en los extremos**  </span>
<span id="cb37-1762"><a href="#cb37-1762" aria-hidden="true" tabindex="-1"></a>  $$\binom{n}{0} = \binom{n}{n} = 1$$  </span>
<span id="cb37-1763"><a href="#cb37-1763" aria-hidden="true" tabindex="-1"></a>  Sólo hay una forma de no escoger nada o de escoger todo.</span>
<span id="cb37-1764"><a href="#cb37-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1765"><a href="#cb37-1765" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Relación recursiva (Triángulo de Pascal)**  </span>
<span id="cb37-1766"><a href="#cb37-1766" aria-hidden="true" tabindex="-1"></a>  $$\binom{n}{x} = \binom{n - 1}{x - 1} + \binom{n - 1}{x}$$</span>
<span id="cb37-1767"><a href="#cb37-1767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1768"><a href="#cb37-1768" aria-hidden="true" tabindex="-1"></a>Además, de las propieidades, una **Aplicación en el Teorema del Binomio** es la siguiente: en la expansión de $(a + b)^n$, los coeficientes vienen dados por:</span>
<span id="cb37-1769"><a href="#cb37-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1770"><a href="#cb37-1770" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1771"><a href="#cb37-1771" aria-hidden="true" tabindex="-1"></a>(a + b)^n = \sum_{x = 0}^{n} \binom{n}{x}\,a^x\,b^{\,n - x}.</span>
<span id="cb37-1772"><a href="#cb37-1772" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1773"><a href="#cb37-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1774"><a href="#cb37-1774" aria-hidden="true" tabindex="-1"></a>Respecto a la **interpretación probabilística** del coeficiente binomial, tenemos que fijarnos en lo siguiente. En un experimento de Bernoulli (éxito o fracaso) con probabilidad de éxito <span class="sc">\(</span>p<span class="sc">\)</span> en cada ensayo, la probabilidad de obtener exactamente <span class="sc">\(</span>x<span class="sc">\)</span> éxitos en <span class="sc">\(</span>n<span class="sc">\)</span> ensayos es:</span>
<span id="cb37-1775"><a href="#cb37-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1776"><a href="#cb37-1776" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1777"><a href="#cb37-1777" aria-hidden="true" tabindex="-1"></a>P(X = x) = \binom{n}{x}\,p^x\,(1 - p)^{\,n - x}.</span>
<span id="cb37-1778"><a href="#cb37-1778" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1779"><a href="#cb37-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1780"><a href="#cb37-1780" aria-hidden="true" tabindex="-1"></a>En resumen, $\displaystyle \binom{n}{x}$ cuenta de cuántas maneras puedes elegir $x$ elementos de un total de $n$, y aparece de forma natural en combinatoria, en el desarrollo de potencias binomiales y en distribuciones de probabilidad.</span>
<span id="cb37-1781"><a href="#cb37-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1782"><a href="#cb37-1782" aria-hidden="true" tabindex="-1"></a>Con todo esto, veremos un Teorema, que nos permite relacionar la distribución binomial con los ensayos de Bernoulli. Con ello, sabremos bien para qué nos sirve este tipo de distribución. </span>
<span id="cb37-1783"><a href="#cb37-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1784"><a href="#cb37-1784" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb37-1785"><a href="#cb37-1785" aria-hidden="true" tabindex="-1"></a><span class="fu">### Teorema: Distribución Binomial y ensayos de Bernoulli. </span></span>
<span id="cb37-1786"><a href="#cb37-1786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1787"><a href="#cb37-1787" aria-hidden="true" tabindex="-1"></a>Sea $X_1, X_2, \dots, X_n$ variables aleatorias independientes, con distribuciones Bernoulli de parámetro $p$. Diremos, por tanto, que se trata de $n$ ensayos de Bernoulli con probabilidad de éxito $p$, donde se sobreentiende que son independientes. Denotamos por $S$ el número de éxitos en los $n$ ensayos, es decir</span>
<span id="cb37-1788"><a href="#cb37-1788" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1789"><a href="#cb37-1789" aria-hidden="true" tabindex="-1"></a>S = X_1 + X_2 + \dots + X_n.</span>
<span id="cb37-1790"><a href="#cb37-1790" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1791"><a href="#cb37-1791" aria-hidden="true" tabindex="-1"></a>Entonces $S \sim \mbox{Bin}(n, p)$.</span>
<span id="cb37-1792"><a href="#cb37-1792" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-1793"><a href="#cb37-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1794"><a href="#cb37-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1795"><a href="#cb37-1795" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Distribución Geométrica</span></span>
<span id="cb37-1796"><a href="#cb37-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1797"><a href="#cb37-1797" aria-hidden="true" tabindex="-1"></a>Una variable aleatoria $X$ sigue una distribución geométrica de parámetro $p$, $0 &lt; p &lt; 1$, si $X$ tiene una distribución discreta con función de probabilidad:</span>
<span id="cb37-1798"><a href="#cb37-1798" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1799"><a href="#cb37-1799" aria-hidden="true" tabindex="-1"></a>f(x) =</span>
<span id="cb37-1800"><a href="#cb37-1800" aria-hidden="true" tabindex="-1"></a>    \begin{cases} </span>
<span id="cb37-1801"><a href="#cb37-1801" aria-hidden="true" tabindex="-1"></a>    pq^x &amp; \text{para } x = 0, 1, 2, \dots <span class="sc">\\</span></span>
<span id="cb37-1802"><a href="#cb37-1802" aria-hidden="true" tabindex="-1"></a>    0 &amp; \text{si no.}</span>
<span id="cb37-1803"><a href="#cb37-1803" aria-hidden="true" tabindex="-1"></a>    \end{cases}</span>
<span id="cb37-1804"><a href="#cb37-1804" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1805"><a href="#cb37-1805" aria-hidden="true" tabindex="-1"></a>donde $q = 1 - p$. En este caso, escribimos $X \sim \mbox{Geo}(p)$</span>
<span id="cb37-1806"><a href="#cb37-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1807"><a href="#cb37-1807" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb37-1808"><a href="#cb37-1808" aria-hidden="true" tabindex="-1"></a><span class="fu">### Teorema: Distribución Geómetrica y ensayos de Bernoulli. </span></span>
<span id="cb37-1809"><a href="#cb37-1809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1810"><a href="#cb37-1810" aria-hidden="true" tabindex="-1"></a>Consideremos $X_1,X_2,X_3, \ldots$ v.a. $\mbox{Ber}(p)$ independientes. Denotemos, pues, $Y$ por el número de fracasos antes del primer éxito de la secuencia anterior. Entonces, $X$ sigue una distribución geométrica de parámetro $p$.</span>
<span id="cb37-1811"><a href="#cb37-1811" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-1812"><a href="#cb37-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1813"><a href="#cb37-1813" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Relación Bernoulli, Binomial y Geométrica</span></span>
<span id="cb37-1814"><a href="#cb37-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1815"><a href="#cb37-1815" aria-hidden="true" tabindex="-1"></a>Como ya se podría intuir, este tres tipos de distribuciones de variables aleatorias discretas, están relacionadas. Y lo están de la siguiente manera: </span>
<span id="cb37-1816"><a href="#cb37-1816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1817"><a href="#cb37-1817" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Cuando realizamos un experimento que tiene **solo dos resultados posibles**, estamos ante un ensayo Bernoulli</span>
<span id="cb37-1818"><a href="#cb37-1818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1819"><a href="#cb37-1819" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si tenemos una secuencia $X_1, X_2, \dots, X_n$ de variables aleatorias independientes con distribución común $\mbox{Bern}(p)$, la suma de ``éxitoa'' tendrá una distribución $\mbox{Bin}(n,p)$. Es básicamente, la suma una secuencia de experimentos con distribución $\mbox{Bern}(p)$</span>
<span id="cb37-1820"><a href="#cb37-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1821"><a href="#cb37-1821" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Si en esta misma secuencia denotamos como $Y$ el número de ``fracasos'' antes del primer "éxito", $Y$ tendrá una distribución $\mbox{Geo}(p)$</span>
<span id="cb37-1822"><a href="#cb37-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1823"><a href="#cb37-1823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1824"><a href="#cb37-1824" aria-hidden="true" tabindex="-1"></a>Por ejemplo, si lanzamos una moneda en la que definimos $X=1$ si sale cara y $X=0$ si sale sello. Supongamos que el resultado fue el siguiente en 8 lanzamientos:</span>
<span id="cb37-1825"><a href="#cb37-1825" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1826"><a href="#cb37-1826" aria-hidden="true" tabindex="-1"></a>S = <span class="sc">\{</span>\text{s, s, c, s, c, c, s, s}<span class="sc">\}</span></span>
<span id="cb37-1827"><a href="#cb37-1827" aria-hidden="true" tabindex="-1"></a>$$ </span>
<span id="cb37-1828"><a href="#cb37-1828" aria-hidden="true" tabindex="-1"></a>Tenemos, pues que </span>
<span id="cb37-1829"><a href="#cb37-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1830"><a href="#cb37-1830" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>El lanzamiento particular de cada moneda tiene $\mbox{Ber}(0,5)$. </span>
<span id="cb37-1831"><a href="#cb37-1831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1832"><a href="#cb37-1832" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Si definimos $Y$ como el número de caras si lanzamos la moneda 8 veces, tenemos que el número de caras fue $c=3$. La distribución de los lanzamientos, así, es de $\mbox{Bin}(n=8, p=0,5$).</span>
<span id="cb37-1833"><a href="#cb37-1833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1834"><a href="#cb37-1834" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Si definimos $Z$ como el número de fracasos antes del primer éxito, dado que hubo dos sellos $X=0$ antes de cara $X=1$, entonces, tenemos, dado que la v.a., sigue una distribución tal qeu $\mbox{Geo}(0,5)$, entonces, que va tener un $\Pr(Y)=q^2p$</span>
<span id="cb37-1835"><a href="#cb37-1835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1836"><a href="#cb37-1836" aria-hidden="true" tabindex="-1"></a>Gráficamente puede ser aún más claro. Veamos este ejemplo en R. </span>
<span id="cb37-1837"><a href="#cb37-1837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1840"><a href="#cb37-1840" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-1841"><a href="#cb37-1841" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: relacion-distribuciones</span></span>
<span id="cb37-1842"><a href="#cb37-1842" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-1843"><a href="#cb37-1843" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, scales, purrr, tidyr)</span>
<span id="cb37-1844"><a href="#cb37-1844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1845"><a href="#cb37-1845" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2025</span>)</span>
<span id="cb37-1846"><a href="#cb37-1846" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb37-1847"><a href="#cb37-1847" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb37-1848"><a href="#cb37-1848" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb37-1849"><a href="#cb37-1849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1850"><a href="#cb37-1850" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Simulaciones</span></span>
<span id="cb37-1851"><a href="#cb37-1851" aria-hidden="true" tabindex="-1"></a>sim_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb37-1852"><a href="#cb37-1852" aria-hidden="true" tabindex="-1"></a>  <span class="at">Ber =</span> <span class="fu">rbinom</span>(N, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> p),</span>
<span id="cb37-1853"><a href="#cb37-1853" aria-hidden="true" tabindex="-1"></a>  <span class="at">Bin =</span> <span class="fu">rbinom</span>(N, <span class="at">size =</span> n, <span class="at">prob =</span> p),</span>
<span id="cb37-1854"><a href="#cb37-1854" aria-hidden="true" tabindex="-1"></a>  <span class="at">Geo =</span> <span class="fu">rgeom</span>(N, <span class="at">prob =</span> p)</span>
<span id="cb37-1855"><a href="#cb37-1855" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb37-1856"><a href="#cb37-1856" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="st">"Distrib"</span>, <span class="at">values_to =</span> <span class="st">"x"</span>)</span>
<span id="cb37-1857"><a href="#cb37-1857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1858"><a href="#cb37-1858" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) PMF empírica</span></span>
<span id="cb37-1859"><a href="#cb37-1859" aria-hidden="true" tabindex="-1"></a>df_pmf <span class="ot">&lt;-</span> sim_data <span class="sc">|&gt;</span> </span>
<span id="cb37-1860"><a href="#cb37-1860" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Distrib, x) <span class="sc">|&gt;</span> </span>
<span id="cb37-1861"><a href="#cb37-1861" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Distrib) <span class="sc">|&gt;</span> </span>
<span id="cb37-1862"><a href="#cb37-1862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prob =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span> </span>
<span id="cb37-1863"><a href="#cb37-1863" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb37-1864"><a href="#cb37-1864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1865"><a href="#cb37-1865" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Graficar</span></span>
<span id="cb37-1866"><a href="#cb37-1866" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_pmf, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(x), <span class="at">y =</span> prob, <span class="at">fill =</span> Distrib)) <span class="sc">+</span></span>
<span id="cb37-1867"><a href="#cb37-1867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="fl">0.7</span>, <span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.8</span>)) <span class="sc">+</span></span>
<span id="cb37-1868"><a href="#cb37-1868" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Distrib, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">strip.position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb37-1869"><a href="#cb37-1869" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">percent_format</span>(<span class="at">accuracy =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb37-1870"><a href="#cb37-1870" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Ber"</span> <span class="ot">=</span> <span class="st">"#4E79A7"</span>, <span class="st">"Bin"</span> <span class="ot">=</span> <span class="st">"#2CA02C"</span>, <span class="st">"Geo"</span> <span class="ot">=</span> <span class="st">"#E15759"</span>)) <span class="sc">+</span></span>
<span id="cb37-1871"><a href="#cb37-1871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-1872"><a href="#cb37-1872" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"Valor de la variable aleatoria"</span>,</span>
<span id="cb37-1873"><a href="#cb37-1873" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="st">"Probabilidad empírica"</span>,</span>
<span id="cb37-1874"><a href="#cb37-1874" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Relación entre Bernoulli, Binomial y Geométrica (p = 0.5, n = 8)"</span></span>
<span id="cb37-1875"><a href="#cb37-1875" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-1876"><a href="#cb37-1876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-1877"><a href="#cb37-1877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-1878"><a href="#cb37-1878" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title    =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-1879"><a href="#cb37-1879" aria-hidden="true" tabindex="-1"></a>    <span class="at">strip.text    =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb37-1880"><a href="#cb37-1880" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text     =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb37-1881"><a href="#cb37-1881" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb37-1882"><a href="#cb37-1882" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-1883"><a href="#cb37-1883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1884"><a href="#cb37-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1885"><a href="#cb37-1885" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-1886"><a href="#cb37-1886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1887"><a href="#cb37-1887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1888"><a href="#cb37-1888" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Distribución de Poisson </span></span>
<span id="cb37-1889"><a href="#cb37-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1890"><a href="#cb37-1890" aria-hidden="true" tabindex="-1"></a>La distribución de Poisson es algo que podríamos colocar más adelante. Pero al ser también una distribución propia de variables aleatorias discretas decido dejarla aquí. La distribución de Poisson permite modelar el número de éxistos en un determinado intervalo de *tiempo*. Por ejemplo, si en 1 hora vendo 20 chocolates promedio, puedo modelar esto con Poisson con parámetro 20. Formalmente tenemos lo siguiente.</span>
<span id="cb37-1891"><a href="#cb37-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1892"><a href="#cb37-1892" aria-hidden="true" tabindex="-1"></a>Sea $\lambda&gt;0$. La v.a. $X$ tiene una distribución de Poisson de parámetro $\lambda$, lo cual denotamos como $X\sim \mbox{Poi}(\lambda)$, si su función de probabilidad satiface</span>
<span id="cb37-1893"><a href="#cb37-1893" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1894"><a href="#cb37-1894" aria-hidden="true" tabindex="-1"></a>f(x) = \frac{e^{-\lambda}\lambda^x}{x!}, \qquad x= 0, 1, 2, \ldots </span>
<span id="cb37-1895"><a href="#cb37-1895" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1896"><a href="#cb37-1896" aria-hidden="true" tabindex="-1"></a>Aquí es donde conviene haber visto algunas cosas antes, particularmente los términos Esperanza y Varianza en este contexto. Pero da igual porque lo pondré en el apartado siguiente. Solo quería seguir la lógica de colocar las distribuciones juntas. Una vez visto esta distribución, esperanza y varianza (siguiente sección), pasaremos a las variables aleatorias continuas y sus distribuciones. Lo que tenemos que ver ahora, respecto a la distribución de Poisson, son sus propiedades. </span>
<span id="cb37-1897"><a href="#cb37-1897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1898"><a href="#cb37-1898" aria-hidden="true" tabindex="-1"></a>**Propiedades de la Distribución de Poisson**</span>
<span id="cb37-1899"><a href="#cb37-1899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1900"><a href="#cb37-1900" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Si $X\sim \mbox{Poi}(\lambda)$ entonces</span>
<span id="cb37-1901"><a href="#cb37-1901" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1902"><a href="#cb37-1902" aria-hidden="true" tabindex="-1"></a>\mbox{E}(X) = \lambda, \qquad \mbox{Var}(X)=\lambda</span>
<span id="cb37-1903"><a href="#cb37-1903" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1904"><a href="#cb37-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1905"><a href="#cb37-1905" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Si $X\sim \mbox{Poi}(\lambda_1)$, $Y\sim \mbox{Poi}(\lambda_2)$, y $X$ e $Y$ son independientes, entonces se tiene que</span>
<span id="cb37-1906"><a href="#cb37-1906" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1907"><a href="#cb37-1907" aria-hidden="true" tabindex="-1"></a>X+Y \sim \mbox{Poi}(\lambda_1 +\lambda_2).</span>
<span id="cb37-1908"><a href="#cb37-1908" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1909"><a href="#cb37-1909" aria-hidden="true" tabindex="-1"></a>Es decir, la suma de las v.a. independientes Poisson es Poisson, y el parámetro de las sumas es la suma de los parámetros de las variables individuales. </span>
<span id="cb37-1910"><a href="#cb37-1910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1911"><a href="#cb37-1911" aria-hidden="true" tabindex="-1"></a>Como ya mencionamos, la distribución de Poisson es principalmente utilizada para contar el número de éxitos en un determinado intervalo de tiempo o región del espacio, pues una Poisson es una **muy buena _aproximación_ para una binomial** con un $n$ que tiende a infinito y un parámetro $p$ muy pequeño. En efecto, si se tiene qeu $X_n \sim \mbox{Bin}(n,p)$ y $n$ tiende a infinito, entonces $X_n$ *converge* a Poisson de parámetro $\lambda = np$, i.e., </span>
<span id="cb37-1912"><a href="#cb37-1912" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1913"><a href="#cb37-1913" aria-hidden="true" tabindex="-1"></a>\lim_{n\to \infty} (\Pr(X_n=x)) = \frac{e^{-\lambda}\lambda^x}{x!}</span>
<span id="cb37-1914"><a href="#cb37-1914" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1915"><a href="#cb37-1915" aria-hidden="true" tabindex="-1"></a>Por lo tanto, es recomentable usar este tipo de distribución en el caso que nos enfrentemos a una distribución binomial con un número de ensayos $n$ bastante grande y una probabilidad de éxito $p$ pequeña. </span>
<span id="cb37-1916"><a href="#cb37-1916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1917"><a href="#cb37-1917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1918"><a href="#cb37-1918" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Distribuciones de variables aleatorias continuas</span></span>
<span id="cb37-1919"><a href="#cb37-1919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1920"><a href="#cb37-1920" aria-hidden="true" tabindex="-1"></a> diferencia de las v.a. discretas, las v.a. continuas son aquellas que pueden tomar **cualquier valor** de un intervalo de una recta real. Es decir, cualquier número real. Un ejemplo puede ser el tiempo, los ingresos, distancias, etc. De tal modo, las v.a. continuas describen el resultado de situaciones de probabilidades en donde lso valores de la v.a. forman un *continuum* de valores y, por tanto, no es posible *listar* valores. De tal modo, conviene aprehenderlos mediante intervalos. Formalmente, tenemos lo siguiente: </span>
<span id="cb37-1921"><a href="#cb37-1921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1922"><a href="#cb37-1922" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb37-1923"><a href="#cb37-1923" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definición </span></span>
<span id="cb37-1924"><a href="#cb37-1924" aria-hidden="true" tabindex="-1"></a>La v.a. $X$ tiene una **distribución continua** si existe una función $f$ definida sobre la recta real, que toma valores mayores o iguales que 0, tal que cualquier para intervalo la probabilidad de que $X$ tome valores en el intervalo que va de $a$ a $b$ es igual a la integral de $f$ sobre el intervalo. Matemáticamente,</span>
<span id="cb37-1925"><a href="#cb37-1925" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1926"><a href="#cb37-1926" aria-hidden="true" tabindex="-1"></a>\Pr(a&lt;X&lt;b) = \int^b_a f(x)dx</span>
<span id="cb37-1927"><a href="#cb37-1927" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1928"><a href="#cb37-1928" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-1929"><a href="#cb37-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1930"><a href="#cb37-1930" aria-hidden="true" tabindex="-1"></a>Ciertamente los intervalos dependerán de lo que queramos modelar. Si $a\leq b$, entonces,</span>
<span id="cb37-1931"><a href="#cb37-1931" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1932"><a href="#cb37-1932" aria-hidden="true" tabindex="-1"></a>\Pr(a\leq X\leq b) = \int^b_a f(x)dx</span>
<span id="cb37-1933"><a href="#cb37-1933" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1934"><a href="#cb37-1934" aria-hidden="true" tabindex="-1"></a>Si, e.g., $b=+\infty$, entonces</span>
<span id="cb37-1935"><a href="#cb37-1935" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1936"><a href="#cb37-1936" aria-hidden="true" tabindex="-1"></a>\Pr(a\geq X) = \int^\infty_a f(x)dx</span>
<span id="cb37-1937"><a href="#cb37-1937" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1938"><a href="#cb37-1938" aria-hidden="true" tabindex="-1"></a>O, si $a=-\infty$, entonces,</span>
<span id="cb37-1939"><a href="#cb37-1939" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1940"><a href="#cb37-1940" aria-hidden="true" tabindex="-1"></a>\Pr(X\leq b) = \int^b_{-\infty} f(x)dx</span>
<span id="cb37-1941"><a href="#cb37-1941" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1942"><a href="#cb37-1942" aria-hidden="true" tabindex="-1"></a>Diremos, ademñas, que $f(x)$ es la **función de _densidad_ de probabilidad** (o f.d.p.), y ya no solo la f.p., de la v.a. $X$. El conjunto de valores de $x$ donde $f(x)&gt;0$, se conoce como el **soporte** de $X$. Un ejemplo de esto, lo podríamos observar con lo siguiente. Sea la v.a. continua $X$, cuya f.d.p. está dad por</span>
<span id="cb37-1943"><a href="#cb37-1943" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1944"><a href="#cb37-1944" aria-hidden="true" tabindex="-1"></a>f(x)=</span>
<span id="cb37-1945"><a href="#cb37-1945" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb37-1946"><a href="#cb37-1946" aria-hidden="true" tabindex="-1"></a>  \frac{x}{2} &amp; \text{si } \quad 0 \leq x \leq 2,<span class="sc">\\</span></span>
<span id="cb37-1947"><a href="#cb37-1947" aria-hidden="true" tabindex="-1"></a>  0 &amp; \text{si no}</span>
<span id="cb37-1948"><a href="#cb37-1948" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb37-1949"><a href="#cb37-1949" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1950"><a href="#cb37-1950" aria-hidden="true" tabindex="-1"></a>Deberíamos calcular, entonces, $\Pr(1\leq X \leq 1,5)$. Y siguiendo la definición, tendríamos que</span>
<span id="cb37-1951"><a href="#cb37-1951" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1952"><a href="#cb37-1952" aria-hidden="true" tabindex="-1"></a>\Pr(1\leq X \leq 1,5) = \int^{1,5}_1 \frac{x}{2} dx</span>
<span id="cb37-1953"><a href="#cb37-1953" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1954"><a href="#cb37-1954" aria-hidden="true" tabindex="-1"></a>Si resolvemos la integral:</span>
<span id="cb37-1955"><a href="#cb37-1955" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1956"><a href="#cb37-1956" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-1957"><a href="#cb37-1957" aria-hidden="true" tabindex="-1"></a>  \int^{1,5}_1 \frac{x}{2} dx &amp;= \frac{1}{2}\int^{1,5}_1 xdx \quad || \text{ regla de la potencia}<span class="sc">\\</span></span>
<span id="cb37-1958"><a href="#cb37-1958" aria-hidden="true" tabindex="-1"></a>  &amp;= \frac{1}{2}\frac{x^2}{2} \quad || \text{ simplificamos}<span class="sc">\\</span></span>
<span id="cb37-1959"><a href="#cb37-1959" aria-hidden="true" tabindex="-1"></a>  &amp;= 0,5<span class="co">[</span><span class="ot">0,5x^2</span><span class="co">]</span>^{1,5}_1 \quad || F(b)- F(a)<span class="sc">\\</span></span>
<span id="cb37-1960"><a href="#cb37-1960" aria-hidden="true" tabindex="-1"></a>  &amp;| \lim _{x\to \:1+}\left(0.5x^2\right)=0,5 <span class="sc">\\</span></span>
<span id="cb37-1961"><a href="#cb37-1961" aria-hidden="true" tabindex="-1"></a>  &amp;| \lim _{x\to \:1,5-}\left(0.5x^2\right)=1,125 <span class="sc">\\</span></span>
<span id="cb37-1962"><a href="#cb37-1962" aria-hidden="true" tabindex="-1"></a>  &amp;= 1,125-0,5<span class="sc">\\</span></span>
<span id="cb37-1963"><a href="#cb37-1963" aria-hidden="true" tabindex="-1"></a>  &amp;= 0,625</span>
<span id="cb37-1964"><a href="#cb37-1964" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-1965"><a href="#cb37-1965" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1966"><a href="#cb37-1966" aria-hidden="true" tabindex="-1"></a>**Propiedades de una v.a. continua**. Para garantizar que se cumple con los **axiomas de probabilidad**, la f.d.p. $f(x)$ de la v.a. continua $X$ debe cumplir con:</span>
<span id="cb37-1967"><a href="#cb37-1967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1968"><a href="#cb37-1968" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Ser positiva:</span>
<span id="cb37-1969"><a href="#cb37-1969" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1970"><a href="#cb37-1970" aria-hidden="true" tabindex="-1"></a>f(x) \geq 0 \text{ para todo } - \infty \leq x \leq \infty</span>
<span id="cb37-1971"><a href="#cb37-1971" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1972"><a href="#cb37-1972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1973"><a href="#cb37-1973" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>La probabilidad del soporte de $X$ igual a uno</span>
<span id="cb37-1974"><a href="#cb37-1974" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1975"><a href="#cb37-1975" aria-hidden="true" tabindex="-1"></a>\int^\infty_{-\infty} f(x)dx =1</span>
<span id="cb37-1976"><a href="#cb37-1976" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1977"><a href="#cb37-1977" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Función de distribución cumulativa</span></span>
<span id="cb37-1978"><a href="#cb37-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1979"><a href="#cb37-1979" aria-hidden="true" tabindex="-1"></a>Otro concepto relevante que surge una vez conocemos las v.a. continuas, es el de función de distribución cumulativa. Ahora bien, también tenemos cumulativa para v.a. discretas. Veremos ambas y las propiedades de todas las funciondes cumulativas, además de especialmente fijarnos en el caso de v.a. continuas. </span>
<span id="cb37-1980"><a href="#cb37-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1981"><a href="#cb37-1981" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb37-1982"><a href="#cb37-1982" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definición</span></span>
<span id="cb37-1983"><a href="#cb37-1983" aria-hidden="true" tabindex="-1"></a>La **función de distribución cumulativa (f.d.c.) de una v.a. $X$ es la función</span>
<span id="cb37-1984"><a href="#cb37-1984" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1985"><a href="#cb37-1985" aria-hidden="true" tabindex="-1"></a>F(x) = \Pr(X \leq x)</span>
<span id="cb37-1986"><a href="#cb37-1986" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-1987"><a href="#cb37-1987" aria-hidden="true" tabindex="-1"></a>Abreviaremos la f.d.c. como función de distribución, como función cumulativa o cumulativa. La cumulativa está definida para toda v.a. (discreta o continua), y la denotamos con mayúscula $F(\cdot)$ para distinguirla de la f.d.p y f.p. </span>
<span id="cb37-1988"><a href="#cb37-1988" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-1989"><a href="#cb37-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1990"><a href="#cb37-1990" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Distribución uniforme para el caso de v.a. continuas</span></span>
<span id="cb37-1991"><a href="#cb37-1991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1992"><a href="#cb37-1992" aria-hidden="true" tabindex="-1"></a>Partimos con una distribución que ya vimos, pero ahora para el caso de las v.a. continuas. Arrancamos por su definición </span>
<span id="cb37-1993"><a href="#cb37-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1994"><a href="#cb37-1994" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb37-1995"><a href="#cb37-1995" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definición</span></span>
<span id="cb37-1996"><a href="#cb37-1996" aria-hidden="true" tabindex="-1"></a>Decimos que la v.a. $X$ sigue una distribución uniforme en el intervalo $<span class="co">[</span><span class="ot">a,b</span><span class="co">]</span>$, donde $a$ y $b$ son números reales con $a&lt;b$, si $X$ toma valores entre $a$ y $b$, y la probabilidad de que $X$ tome valores en cualquier subintervalo de $<span class="co">[</span><span class="ot">a,b</span><span class="co">]</span>$ es proporcional al largo del subintervalo. Si esto es así, escribimos $X\sim \mbox{U}(a,b)$. </span>
<span id="cb37-1997"><a href="#cb37-1997" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-1998"><a href="#cb37-1998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-1999"><a href="#cb37-1999" aria-hidden="true" tabindex="-1"></a>Pondré solo un ejemplo. **Cumulativa de una v.a. discreta**: supongamos que $X\sim \mbox{Bin}(4, 1/2)$, de modo que su f.p. está dadar por </span>
<span id="cb37-2000"><a href="#cb37-2000" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2001"><a href="#cb37-2001" aria-hidden="true" tabindex="-1"></a>f(x)= </span>
<span id="cb37-2002"><a href="#cb37-2002" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb37-2003"><a href="#cb37-2003" aria-hidden="true" tabindex="-1"></a>\frac{4}{x}(1/2)^4, &amp; \quad x=0, 1, 2, 3, 4,<span class="sc">\\</span></span>
<span id="cb37-2004"><a href="#cb37-2004" aria-hidden="true" tabindex="-1"></a>0, &amp; \quad \text{en caso contrario}</span>
<span id="cb37-2005"><a href="#cb37-2005" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb37-2006"><a href="#cb37-2006" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2007"><a href="#cb37-2007" aria-hidden="true" tabindex="-1"></a>Y queremos calcular $F(2)$. Esto es, </span>
<span id="cb37-2008"><a href="#cb37-2008" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2009"><a href="#cb37-2009" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb37-2010"><a href="#cb37-2010" aria-hidden="true" tabindex="-1"></a>  F(2) &amp;= \Pr(X\leq 2)<span class="sc">\\</span></span>
<span id="cb37-2011"><a href="#cb37-2011" aria-hidden="true" tabindex="-1"></a>  &amp;=\Pr(X=0) + \Pr(X=1)+\Pr(X=2)<span class="sc">\\</span></span>
<span id="cb37-2012"><a href="#cb37-2012" aria-hidden="true" tabindex="-1"></a>  &amp;=0,5^4+4\cdot 0,5^4+6\cdot 0,5^4<span class="sc">\\</span></span>
<span id="cb37-2013"><a href="#cb37-2013" aria-hidden="true" tabindex="-1"></a>  &amp;= \frac{11}{16}</span>
<span id="cb37-2014"><a href="#cb37-2014" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb37-2015"><a href="#cb37-2015" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2016"><a href="#cb37-2016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2017"><a href="#cb37-2017" aria-hidden="true" tabindex="-1"></a>Si hicieramos esto con todos los valores que toma $x$, y no solo $2$, se puede construir la función cumulativa completa. En R, en el paquete <span class="in">`stats`</span> hay funciones específicas para distribuciones binomiales que usamos antes. Pero vale la pena especificar que <span class="in">`dbinom()`</span>, proporciona la densidad, <span class="in">`pbinom()`</span> proporciona la función de distribución, <span class="in">`qbinom()`</span> proporciona la función cuantílica y <span class="in">`rbinom()`</span> genera desviaciones aleatorias. Gráficamente es más facil verlo, así que lo hacemos en R podemos graficarlo así: </span>
<span id="cb37-2018"><a href="#cb37-2018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2021"><a href="#cb37-2021" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-2022"><a href="#cb37-2022" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: eg-fdc-discreta</span></span>
<span id="cb37-2023"><a href="#cb37-2023" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-2024"><a href="#cb37-2024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2025"><a href="#cb37-2025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2026"><a href="#cb37-2026" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, </span>
<span id="cb37-2027"><a href="#cb37-2027" aria-hidden="true" tabindex="-1"></a>               patchwork) <span class="co"># Para combinar gráficos.</span></span>
<span id="cb37-2028"><a href="#cb37-2028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2029"><a href="#cb37-2029" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar datos para Binomial(4, 0.5)</span></span>
<span id="cb37-2030"><a href="#cb37-2030" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb37-2031"><a href="#cb37-2031" aria-hidden="true" tabindex="-1"></a>  <span class="at">x        =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb37-2032"><a href="#cb37-2032" aria-hidden="true" tabindex="-1"></a>  <span class="at">pmf      =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">prob =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-2033"><a href="#cb37-2033" aria-hidden="true" tabindex="-1"></a>  <span class="at">cdf      =</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb37-2034"><a href="#cb37-2034" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb37-2035"><a href="#cb37-2035" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prev_cdf =</span> <span class="fu">lag</span>(cdf, <span class="at">default =</span> <span class="dv">0</span>))</span>
<span id="cb37-2036"><a href="#cb37-2036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2037"><a href="#cb37-2037" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico PMF</span></span>
<span id="cb37-2038"><a href="#cb37-2038" aria-hidden="true" tabindex="-1"></a>p_pmf <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> pmf)) <span class="sc">+</span></span>
<span id="cb37-2039"><a href="#cb37-2039" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend =</span> x, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> pmf)) <span class="sc">+</span></span>
<span id="cb37-2040"><a href="#cb37-2040" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb37-2041"><a href="#cb37-2041" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-2042"><a href="#cb37-2042" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(df<span class="sc">$</span>pmf) <span class="sc">*</span> <span class="fl">1.1</span>)) <span class="sc">+</span></span>
<span id="cb37-2043"><a href="#cb37-2043" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"f(x)"</span>, <span class="at">title =</span> <span class="st">"PMF de Binomial(4, 0.5)"</span>) <span class="sc">+</span></span>
<span id="cb37-2044"><a href="#cb37-2044" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"sans"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-2045"><a href="#cb37-2045" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb37-2046"><a href="#cb37-2046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2047"><a href="#cb37-2047" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráfico CDF</span></span>
<span id="cb37-2048"><a href="#cb37-2048" aria-hidden="true" tabindex="-1"></a>p_cdf <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb37-2049"><a href="#cb37-2049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="fu">aes</span>(<span class="at">y =</span> cdf), <span class="at">direction =</span> <span class="st">"hv"</span>) <span class="sc">+</span></span>
<span id="cb37-2050"><a href="#cb37-2050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> cdf), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb37-2051"><a href="#cb37-2051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> prev_cdf), <span class="at">shape =</span> <span class="dv">21</span>, <span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb37-2052"><a href="#cb37-2052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-2053"><a href="#cb37-2053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb37-2054"><a href="#cb37-2054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"x"</span>, <span class="at">y =</span> <span class="st">"F(x)"</span>, <span class="at">title =</span> <span class="st">"CDF de Binomial(4, 0.5)"</span>) <span class="sc">+</span></span>
<span id="cb37-2055"><a href="#cb37-2055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"sans"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-2056"><a href="#cb37-2056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb37-2057"><a href="#cb37-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2058"><a href="#cb37-2058" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar ambos juntos</span></span>
<span id="cb37-2059"><a href="#cb37-2059" aria-hidden="true" tabindex="-1"></a>p_pmf <span class="sc">+</span> p_cdf</span>
<span id="cb37-2060"><a href="#cb37-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2061"><a href="#cb37-2061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2062"><a href="#cb37-2062" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-2063"><a href="#cb37-2063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2064"><a href="#cb37-2064" aria-hidden="true" tabindex="-1"></a>Puse un ejemplo por lo siguiente: en la primera figura se muestra la función de probabilidad de $X$, donde se centra en 2. En la siguiente figura, se muestra la función cumulativa de $X$. Como se ve, hay saltos y tiene forma de escalera. Esto ocurre porque, en la medida que nos movemos hacia la derecha, $0,1, \ldots, 4$, cada valor del soporte de $X$ añade a su propia probabilidad de ocurrencia a la probabilidad que la función ya venía acumulando. Por esto mismo, **el "tamaño" del salto para un valor particualr de $X$ es igual a la probabilidad de que $X$ tome dicho valor**. Por ejemplo, $\Pr(X=2)$ se expresa la linea vertical (el "salto") del punto blanco al negro en el valor $2$ de las abscisas. </span>
<span id="cb37-2065"><a href="#cb37-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2066"><a href="#cb37-2066" aria-hidden="true" tabindex="-1"></a>**Cumulativa de una v.a. continua**: Para definir esto, partamos con una **propiedad** de toda cumulativa de una v.a. continua. Sea $X$ una v.a. continua con cumativa $F$ y f.d.p. $f$. Entonces,</span>
<span id="cb37-2067"><a href="#cb37-2067" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2068"><a href="#cb37-2068" aria-hidden="true" tabindex="-1"></a>F(x)= \int^x_{-\infty}f(u)du</span>
<span id="cb37-2069"><a href="#cb37-2069" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2070"><a href="#cb37-2070" aria-hidden="true" tabindex="-1"></a>Aquí la demostración es directa, pues</span>
<span id="cb37-2071"><a href="#cb37-2071" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2072"><a href="#cb37-2072" aria-hidden="true" tabindex="-1"></a>F(x)= \Pr (X \leq x) = \int^x_{-\infty}f(u)du</span>
<span id="cb37-2073"><a href="#cb37-2073" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2074"><a href="#cb37-2074" aria-hidden="true" tabindex="-1"></a>lo único que cambia respecto a lo que ya sabíamos es que la variable de integración *no puede ser* $x$ dado que $x$ es el límite superior de la integral. Por eso se usa $u$, como variable auxiliar.</span>
<span id="cb37-2075"><a href="#cb37-2075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2076"><a href="#cb37-2076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2077"><a href="#cb37-2077" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Distribución exponencial</span></span>
<span id="cb37-2078"><a href="#cb37-2078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2079"><a href="#cb37-2079" aria-hidden="true" tabindex="-1"></a>Con la distribución exponencial, explicaremos lo mismo que explicamos antes con la uniforme, i.e., f.d.p., la cumulativa, sus propiedades, esperanza y varianza. La distribución exponencial es útil para modelar el **tiempo de espera** hasta el primer éxito en un determinado experimento, donde se sabe que los éxitos llegan a una tasa de $\lambda$ éxitos *en promedio* por unidad de tiempo^<span class="co">[</span><span class="ot">Se podría denominar esta distribució como la contraparte continua de una v.a. geométrica, pues se utiliza frecuentemente para representar tiempo de espera antes del éxito. En rigor, la distribución exponencial es un caso particular de la distribución gamma.</span><span class="co">]</span>. </span>
<span id="cb37-2080"><a href="#cb37-2080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2081"><a href="#cb37-2081" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb37-2082"><a href="#cb37-2082" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definición</span></span>
<span id="cb37-2083"><a href="#cb37-2083" aria-hidden="true" tabindex="-1"></a>Una v.a. continua $X$ tiene una **distribución exponencial** con parámetro $\lambda&gt;0$ si su densidad de probabilidad es de la forma</span>
<span id="cb37-2084"><a href="#cb37-2084" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2085"><a href="#cb37-2085" aria-hidden="true" tabindex="-1"></a>f(x)=</span>
<span id="cb37-2086"><a href="#cb37-2086" aria-hidden="true" tabindex="-1"></a>\begin{cases}</span>
<span id="cb37-2087"><a href="#cb37-2087" aria-hidden="true" tabindex="-1"></a>  \lambda e^{-\lambda x}, &amp; \text{ si } x \geq 0,<span class="sc">\\</span></span>
<span id="cb37-2088"><a href="#cb37-2088" aria-hidden="true" tabindex="-1"></a>  0 &amp; \text{ en caso contrario.}</span>
<span id="cb37-2089"><a href="#cb37-2089" aria-hidden="true" tabindex="-1"></a>\end{cases}</span>
<span id="cb37-2090"><a href="#cb37-2090" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2091"><a href="#cb37-2091" aria-hidden="true" tabindex="-1"></a>En tal caso, escribimos $X\sim \mbox{Exp}(\lambda)$</span>
<span id="cb37-2092"><a href="#cb37-2092" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-2093"><a href="#cb37-2093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2094"><a href="#cb37-2094" aria-hidden="true" tabindex="-1"></a>Gráficamente, podemos visualizar esto (para distintos parámetros de $\lambda$) de la siguiente manera: </span>
<span id="cb37-2095"><a href="#cb37-2095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2098"><a href="#cb37-2098" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-2099"><a href="#cb37-2099" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dist-exponencial-fdp</span></span>
<span id="cb37-2100"><a href="#cb37-2100" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-2101"><a href="#cb37-2101" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb37-2102"><a href="#cb37-2102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2103"><a href="#cb37-2103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2104"><a href="#cb37-2104" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, scales)</span>
<span id="cb37-2105"><a href="#cb37-2105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2106"><a href="#cb37-2106" aria-hidden="true" tabindex="-1"></a>lambdas <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.0</span>, <span class="fl">1.5</span>)</span>
<span id="cb37-2107"><a href="#cb37-2107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2108"><a href="#cb37-2108" aria-hidden="true" tabindex="-1"></a>df_expo <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb37-2109"><a href="#cb37-2109" aria-hidden="true" tabindex="-1"></a>  <span class="at">x      =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length.out =</span> <span class="dv">1000</span>),</span>
<span id="cb37-2110"><a href="#cb37-2110" aria-hidden="true" tabindex="-1"></a>  <span class="at">lambda =</span> lambdas</span>
<span id="cb37-2111"><a href="#cb37-2111" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb37-2112"><a href="#cb37-2112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb37-2113"><a href="#cb37-2113" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb37-2114"><a href="#cb37-2114" aria-hidden="true" tabindex="-1"></a>    <span class="at">f     =</span> lambda <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda <span class="sc">*</span> x),</span>
<span id="cb37-2115"><a href="#cb37-2115" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">"λ = %.1f"</span>, lambda)</span>
<span id="cb37-2116"><a href="#cb37-2116" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-2117"><a href="#cb37-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2118"><a href="#cb37-2118" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_expo, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> f, <span class="at">color =</span> label)) <span class="sc">+</span></span>
<span id="cb37-2119"><a href="#cb37-2119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-2120"><a href="#cb37-2120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-2121"><a href="#cb37-2121" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> comma) <span class="sc">+</span></span>
<span id="cb37-2122"><a href="#cb37-2122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb37-2123"><a href="#cb37-2123" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"λ = 0.5"</span>, <span class="st">"λ = 1.0"</span>, <span class="st">"λ = 1.5"</span>),</span>
<span id="cb37-2124"><a href="#cb37-2124" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb37-2125"><a href="#cb37-2125" aria-hidden="true" tabindex="-1"></a>      <span class="st">"λ = 0.5"</span> <span class="ot">=</span> <span class="st">"#1F77B4"</span>,</span>
<span id="cb37-2126"><a href="#cb37-2126" aria-hidden="true" tabindex="-1"></a>      <span class="st">"λ = 1.0"</span> <span class="ot">=</span> <span class="st">"#7F7F7F"</span>,</span>
<span id="cb37-2127"><a href="#cb37-2127" aria-hidden="true" tabindex="-1"></a>      <span class="st">"λ = 1.5"</span> <span class="ot">=</span> <span class="st">"#2CA02C"</span></span>
<span id="cb37-2128"><a href="#cb37-2128" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb37-2129"><a href="#cb37-2129" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-2130"><a href="#cb37-2130" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-2131"><a href="#cb37-2131" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"x"</span>,</span>
<span id="cb37-2132"><a href="#cb37-2132" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="fu">expression</span>(f[X](x)),</span>
<span id="cb37-2133"><a href="#cb37-2133" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"F.d.p. de la distribución Exponencial para distintos λ"</span>,</span>
<span id="cb37-2134"><a href="#cb37-2134" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Parámetro λ"</span></span>
<span id="cb37-2135"><a href="#cb37-2135" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-2136"><a href="#cb37-2136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-2137"><a href="#cb37-2137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-2138"><a href="#cb37-2138" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title   =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-2139"><a href="#cb37-2139" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb37-2140"><a href="#cb37-2140" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb37-2141"><a href="#cb37-2141" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text    =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-2142"><a href="#cb37-2142" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-2143"><a href="#cb37-2143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2144"><a href="#cb37-2144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-2145"><a href="#cb37-2145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2146"><a href="#cb37-2146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2147"><a href="#cb37-2147" aria-hidden="true" tabindex="-1"></a><span class="fu">### Distribución normal estándar</span></span>
<span id="cb37-2148"><a href="#cb37-2148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2149"><a href="#cb37-2149" aria-hidden="true" tabindex="-1"></a>Sobre esta distribución, nos detendremos un poco más. Veremos, no solo su función de densidad y cumulativa, sino que también los percentiles de una normal estándar y propiedes importantes. Esta será nuestro vinculo directo con el otro aspecto que habíamos mencionado como relevante para la inferencia estadística y causal además de la Ley de los Grandes Números: el Teorema del Límite Central. </span>
<span id="cb37-2150"><a href="#cb37-2150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2151"><a href="#cb37-2151" aria-hidden="true" tabindex="-1"></a>Además, la distribución normal estándar es bastante importante para las ciencias sociales y naturales. Esta distribución provee buen ajuste de los datos para muchos fenómenos naturales, económicos y sociales. Por ejemplo, los datos de altura suelen distribuirse de manera normal estándar, o al menos aproximarse como tal. Por otro lado, podríamos pensar que, e.g., la altura es la suma de multiples factores: edad, genética, sexo, alimentación, etc. Justamente el TLC muestra que el **promedio** de un número lo *suficientemente grande* de v.a. independientes sigue una distribución *muy cecana* a una normal. Así,  cuando una v.a. resulta de sumar **muchas v.a. aleatorias independientes**, la distribución normal es una *buena aproximación* de la v.a. que resulta. En ello reside el vínculo de esta distribución con el TLC y, lo que posteriormente veremos en inferencia estadística y modelamiento de fenómenos de interés.</span>
<span id="cb37-2152"><a href="#cb37-2152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2153"><a href="#cb37-2153" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb37-2154"><a href="#cb37-2154" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definición</span></span>
<span id="cb37-2155"><a href="#cb37-2155" aria-hidden="true" tabindex="-1"></a>Una variable aleatoria continua sigue una distribución normal estándar si la función de densidad viene dada por</span>
<span id="cb37-2156"><a href="#cb37-2156" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2157"><a href="#cb37-2157" aria-hidden="true" tabindex="-1"></a>\phi(x) = \frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}x^2}, \qquad -\infty &lt; x &lt; + \infty </span>
<span id="cb37-2158"><a href="#cb37-2158" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2159"><a href="#cb37-2159" aria-hidden="true" tabindex="-1"></a>Notemos, además, que el soporte de la distribución normal estándar son todos los $\mathbb{R}$, i.e., $-\infty &lt; x &lt; + \infty$.</span>
<span id="cb37-2160"><a href="#cb37-2160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2161"><a href="#cb37-2161" aria-hidden="true" tabindex="-1"></a>Por otro lado, se puede probar que $\int^{+\infty}_{-\infty} \phi (X) dx =1$, lo cual está unido al hehco de que $\phi(x)&gt;0$ para todo $x$ establece que $\phi(x)$ efectivamente define una densidad de probabilidad</span>
<span id="cb37-2162"><a href="#cb37-2162" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-2163"><a href="#cb37-2163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2164"><a href="#cb37-2164" aria-hidden="true" tabindex="-1"></a>Gráficamente, la densidad de una distribución normal estándar se ve así:</span>
<span id="cb37-2165"><a href="#cb37-2165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2168"><a href="#cb37-2168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb37-2169"><a href="#cb37-2169" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fdp-normal-estandar</span></span>
<span id="cb37-2170"><a href="#cb37-2170" aria-hidden="true" tabindex="-1"></a><span class="co">#| collapse: true</span></span>
<span id="cb37-2171"><a href="#cb37-2171" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb37-2172"><a href="#cb37-2172" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dplyr, ggplot2, grid)</span>
<span id="cb37-2173"><a href="#cb37-2173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2174"><a href="#cb37-2174" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear datos para la densidad de la normal estándar</span></span>
<span id="cb37-2175"><a href="#cb37-2175" aria-hidden="true" tabindex="-1"></a>df_norm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)) <span class="sc">|&gt;</span></span>
<span id="cb37-2176"><a href="#cb37-2176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">phi =</span> <span class="fu">dnorm</span>(x))</span>
<span id="cb37-2177"><a href="#cb37-2177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2178"><a href="#cb37-2178" aria-hidden="true" tabindex="-1"></a><span class="co"># Graficar densidad y marcar intervalos de 68% y 95%</span></span>
<span id="cb37-2179"><a href="#cb37-2179" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_norm, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> phi)) <span class="sc">+</span></span>
<span id="cb37-2180"><a href="#cb37-2180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">"#104E8B"</span>) <span class="sc">+</span></span>
<span id="cb37-2181"><a href="#cb37-2181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#24693D"</span>) <span class="sc">+</span></span>
<span id="cb37-2182"><a href="#cb37-2182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"#8B1A1A"</span>) <span class="sc">+</span></span>
<span id="cb37-2183"><a href="#cb37-2183" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Flecha para 68%</span></span>
<span id="cb37-2184"><a href="#cb37-2184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">y =</span> <span class="fl">0.25</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="fl">0.25</span>),</span>
<span id="cb37-2185"><a href="#cb37-2185" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>)),</span>
<span id="cb37-2186"><a href="#cb37-2186" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"#24693D"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-2187"><a href="#cb37-2187" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.27</span>, <span class="at">label =</span> <span class="st">"68%"</span>, <span class="at">color =</span> <span class="st">"#24693D"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-2188"><a href="#cb37-2188" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Flecha para 95%</span></span>
<span id="cb37-2189"><a href="#cb37-2189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">y =</span> <span class="fl">0.06</span>, <span class="at">xend =</span> <span class="dv">2</span>, <span class="at">yend =</span> <span class="fl">0.06</span>),</span>
<span id="cb37-2190"><a href="#cb37-2190" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">ends =</span> <span class="st">"both"</span>, <span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">"cm"</span>)),</span>
<span id="cb37-2191"><a href="#cb37-2191" aria-hidden="true" tabindex="-1"></a>               <span class="at">color =</span> <span class="st">"#8B1A1A"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb37-2192"><a href="#cb37-2192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fl">0.08</span>, <span class="at">label =</span> <span class="st">"95%"</span>, <span class="at">color =</span> <span class="st">"#8B1A1A"</span>, <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb37-2193"><a href="#cb37-2193" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb37-2194"><a href="#cb37-2194" aria-hidden="true" tabindex="-1"></a>    <span class="at">x     =</span> <span class="st">"x"</span>,</span>
<span id="cb37-2195"><a href="#cb37-2195" aria-hidden="true" tabindex="-1"></a>    <span class="at">y     =</span> <span class="fu">expression</span>(<span class="fu">phi</span>(x)),</span>
<span id="cb37-2196"><a href="#cb37-2196" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Densidad de la normal estándar"</span></span>
<span id="cb37-2197"><a href="#cb37-2197" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb37-2198"><a href="#cb37-2198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_family =</span> <span class="st">"serif"</span>, <span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb37-2199"><a href="#cb37-2199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb37-2200"><a href="#cb37-2200" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">16</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb37-2201"><a href="#cb37-2201" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb37-2202"><a href="#cb37-2202" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb37-2203"><a href="#cb37-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2204"><a href="#cb37-2204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2205"><a href="#cb37-2205" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb37-2206"><a href="#cb37-2206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2207"><a href="#cb37-2207" aria-hidden="true" tabindex="-1"></a>Como se puede observar, la distribución aquí está centrada en una media de $0$. La *probabilidad* de que nuestra variable aleatoria tome valores entre $[-1, 1]$ es del 68%. A su vez, que la v.a. tome valores $[-2, 2]$ es del 95%. Por otro lado, la *forma* de la densidad de la distribución es similar a una campana. Por ello, cuando una distribución toma dicha *forma*, se le suele decir que toma forma de **campana de Gauss**. </span>
<span id="cb37-2208"><a href="#cb37-2208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2209"><a href="#cb37-2209" aria-hidden="true" tabindex="-1"></a>Como en todas las otras distribuciones, a partir de la f.d.p. podemos definir su f.d.c., que denotaremos por $\Phi$. Definamosla: </span>
<span id="cb37-2210"><a href="#cb37-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2211"><a href="#cb37-2211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2212"><a href="#cb37-2212" aria-hidden="true" tabindex="-1"></a>:::{.callout-note}</span>
<span id="cb37-2213"><a href="#cb37-2213" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definición</span></span>
<span id="cb37-2214"><a href="#cb37-2214" aria-hidden="true" tabindex="-1"></a>La función cumulativa correspondiente a $\phi(x)$, que se denota por $\Phi(x)$, está dada por</span>
<span id="cb37-2215"><a href="#cb37-2215" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2216"><a href="#cb37-2216" aria-hidden="true" tabindex="-1"></a>\Phi(x) = \int^x_{-\infty} \phi(x)du</span>
<span id="cb37-2217"><a href="#cb37-2217" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2218"><a href="#cb37-2218" aria-hidden="true" tabindex="-1"></a>Un punto importante, es que la función cumulativa de una normal estándar no tiene una expresión cerrada, por lo cual se usan tablas (con Excel o similares) para calcular sus valores. </span>
<span id="cb37-2219"><a href="#cb37-2219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2220"><a href="#cb37-2220" aria-hidden="true" tabindex="-1"></a>Por otro lado, una consecuencia directa de la **simetría** antes mencionada (y graficada) para $\phi(x)$ es que su cumulativa $\Phi(\cdot)$ evaluada en $-x$ es </span>
<span id="cb37-2221"><a href="#cb37-2221" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2222"><a href="#cb37-2222" aria-hidden="true" tabindex="-1"></a>\Phi(-x) = 1 - \Phi(x)</span>
<span id="cb37-2223"><a href="#cb37-2223" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb37-2224"><a href="#cb37-2224" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-2225"><a href="#cb37-2225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2226"><a href="#cb37-2226" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Propiedades de la Distribución Normal Estándar</span></span>
<span id="cb37-2227"><a href="#cb37-2227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2228"><a href="#cb37-2228" aria-hidden="true" tabindex="-1"></a>Por último, dejamos expresadas las propiedades de una distribución normal estándar. No las demostraré, luego que es más útil ver algunas cuestiones antes, particularmente al ver familia de distribuciones normales.  </span>
<span id="cb37-2229"><a href="#cb37-2229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2230"><a href="#cb37-2230" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb37-2231"><a href="#cb37-2231" aria-hidden="true" tabindex="-1"></a><span class="fu">### Propiedades de la Distribución Normal Estándar</span></span>
<span id="cb37-2232"><a href="#cb37-2232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2233"><a href="#cb37-2233" aria-hidden="true" tabindex="-1"></a>Supongamos que la v.a. $Z$ sigue una distribución normal estándar, que denotamos como $Z \sim \mathcal{N}(0,1)$. Entonces, </span>
<span id="cb37-2234"><a href="#cb37-2234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2235"><a href="#cb37-2235" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Se tiene que $\mbox{E}(Z)=0,$</span>
<span id="cb37-2236"><a href="#cb37-2236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2237"><a href="#cb37-2237" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Se tiene que $\mbox{Var}(Z)=1,$</span>
<span id="cb37-2238"><a href="#cb37-2238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2239"><a href="#cb37-2239" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Se tiene que $\mbox{E}(Z^3)=0,$</span>
<span id="cb37-2240"><a href="#cb37-2240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2241"><a href="#cb37-2241" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Se tiene que $\mbox{Var}(Z^4)=3$</span>
<span id="cb37-2242"><a href="#cb37-2242" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb37-2243"><a href="#cb37-2243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2244"><a href="#cb37-2244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2245"><a href="#cb37-2245" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Inferencia estadística: idea general e introducción a los test de hipótesis</span></span>
<span id="cb37-2246"><a href="#cb37-2246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2247"><a href="#cb37-2247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2248"><a href="#cb37-2248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2249"><a href="#cb37-2249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2250"><a href="#cb37-2250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2251"><a href="#cb37-2251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2252"><a href="#cb37-2252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2253"><a href="#cb37-2253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2254"><a href="#cb37-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2255"><a href="#cb37-2255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2256"><a href="#cb37-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2257"><a href="#cb37-2257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2258"><a href="#cb37-2258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2259"><a href="#cb37-2259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2260"><a href="#cb37-2260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2261"><a href="#cb37-2261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2262"><a href="#cb37-2262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2263"><a href="#cb37-2263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2264"><a href="#cb37-2264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2265"><a href="#cb37-2265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2266"><a href="#cb37-2266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2267"><a href="#cb37-2267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2268"><a href="#cb37-2268" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>